(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     86640,       1932]
NotebookOptionsPosition[     85300,       1902]
NotebookOutlinePosition[     85697,       1918]
CellTagsIndexPosition[     85654,       1915]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Initialization Cells. (scroll down to run simulation)", "Item",
 CellChangeTimes->{{3.8862642737052383`*^9, 3.886264331036066*^9}},
 FontSize->36,ExpressionUUID->"3d534153-7ecd-45e7-b627-6e865fe32bc6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\</../\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "SimulationRewardDriven4`"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"displays", " ", "results", " ", "of", " ", "simulation"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PlotBelief1", "[", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "plot", ",", "plotforrange1", ",", "plotforrange2", ",", "data", ",", 
       "size"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Mean", "/@", 
          RowBox[{"BELIEF", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"BELIEF", "//", "Length"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"size", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Length", "/@", "data"}], ")"}], "//", "Max"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"size", "=", "nquestionsUSER"}], ";", "\[IndentingNewLine]", 
      RowBox[{"plot", "=", 
       RowBox[{"data", "//", 
        RowBox[{
         RowBox[{"ListLinePlot", "[", 
          RowBox[{"#", ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<j\>\"", ",", "Large"}], "]"}], ",", 
              RowBox[{"Style", "[", 
               RowBox[{"\"\<d\>\"", ",", "Large"}], "]"}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
           RowBox[{"PlotLegends", "\[Rule]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"\"\<a= \>\"", "<>", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"AffinityValues", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}], "<>", 
                 "\"\<, b=\>\"", "<>", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"BiasValues", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", "Large"}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"AffinityValues", "//", "Length"}]}], "}"}]}], 
             "]"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
           RowBox[{"TicksStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"\"\<Label\>\"", ",", " ", "20"}], "]"}]}]}], "]"}], 
         "&"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plotforrange1", "=", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "dMAX"}], "-", "0.5"}], ",", 
              RowBox[{"size", "-", "1"}]}], "]"}], ",", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              RowBox[{"dMAX", "+", "0.5"}], ",", "1"}], "]"}]}], "]"}], "}"}],
          ",", 
         RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
         RowBox[{"TicksStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"\"\<Label\>\"", ",", " ", "20"}], "]"}]}], ",", 
         RowBox[{"PlotStyle", "->", "None"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<size=\>\"", ",", "size"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{"plotforrange1", ",", "plot"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"markerphase", "[", 
   RowBox[{
    RowBox[{"in_", ":", 
     RowBox[{"GrayLevel", "[", "0", "]"}]}], ",", 
    RowBox[{"out_", ":", 
     RowBox[{"GrayLevel", "[", "0", "]"}]}], ",", 
    RowBox[{"size_", ":", "7"}]}], "]"}], ":=", 
  RowBox[{"Graphics", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"in", ",", 
      RowBox[{"EdgeForm", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"AbsoluteThickness", "[", "1", "]"}], ",", "out"}], "}"}], 
       "]"}], ",", 
      RowBox[{"Disk", "[", "]"}]}], "}"}], ",", 
    RowBox[{"PlotRangePadding", "\[Rule]", "0"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "size"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"marker", "[", "d_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DMAX", "=", "dMAX"}], ",", 
       RowBox[{"DMIN", "=", 
        RowBox[{"-", "dMAX"}]}], ",", 
       RowBox[{"opacity", "=", "0.08"}]}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"d", "//", 
      RowBox[{
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "\[Equal]", "DMAX"}], ",", 
         RowBox[{"markerphase", "[", 
          RowBox[{
           RowBox[{"Opacity", "[", 
            RowBox[{"opacity", ",", 
             RowBox[{"ColorData", "[", 
              RowBox[{"\"\<VisibleSpectrum\>\"", ",", "470"}], "]"}]}], "]"}],
            ",", 
           RowBox[{"ColorData", "[", 
            RowBox[{"\"\<VisibleSpectrum\>\"", ",", "470"}], "]"}], ",", 
           RowBox[{"15", "*", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"Abs", "[", "#", "]"}], "]"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"#", "\[Equal]", "DMIN"}], ",", 
         RowBox[{"markerphase", "[", 
          RowBox[{
           RowBox[{"Opacity", "[", 
            RowBox[{"opacity", ",", 
             RowBox[{"ColorData", "[", 
              RowBox[{"\"\<VisibleSpectrum\>\"", ",", "630"}], "]"}]}], "]"}],
            ",", 
           RowBox[{"ColorData", "[", 
            RowBox[{"\"\<VisibleSpectrum\>\"", ",", "630"}], "]"}], ",", 
           RowBox[{"15", "*", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"Abs", "[", "#", "]"}], "]"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"DMAX", ">", "#", ">", "0"}], ",", 
         RowBox[{"markerphase", "[", 
          RowBox[{"Transparent", ",", 
           RowBox[{"ColorData", "[", 
            RowBox[{"\"\<VisibleSpectrum\>\"", ",", "470"}], "]"}], ",", 
           RowBox[{"15", "*", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"Abs", "[", "#", "]"}], "]"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"DMIN", "<", "#", "<", "0"}], ",", 
         RowBox[{"markerphase", "[", 
          RowBox[{"Transparent", ",", 
           RowBox[{"ColorData", "[", 
            RowBox[{"\"\<VisibleSpectrum\>\"", ",", "630"}], "]"}], ",", 
           RowBox[{"15", "*", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"Abs", "[", "#", "]"}], "]"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"#", "==", "0"}], ",", 
         RowBox[{"markerphase", "[", 
          RowBox[{
           RowBox[{"Opacity", "[", 
            RowBox[{"opacity", ",", "Black"}], "]"}], ",", "Black", ",", 
           "10"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"#", "===", "666"}], ",", "\[InvisibleSpace]", 
         "\"\<\[InvisibleSpace]\>\"", ",", "\[IndentingNewLine]", "True", ",", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<\[CheckedBox]\>\"", ",", 
           InterpretationBox[
            ButtonBox[
             TooltipBox[
              GraphicsBox[{
                {GrayLevel[0], RectangleBox[{0, 0}]}, 
                {GrayLevel[0], RectangleBox[{1, -1}]}, 
                {RGBColor[1, 0, 1], RectangleBox[{0, -1}, {2, 1}]}},
               AspectRatio->1,
               DefaultBaseStyle->"ColorSwatchGraphics",
               Frame->True,
               
               FrameStyle->RGBColor[
                0.6666666666666666, 0., 0.6666666666666666],
               FrameTicks->None,
               
               ImageSize->
                Dynamic[{
                 Automatic, 
                  1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}],
               PlotRangePadding->None],
              StyleBox[
               RowBox[{"RGBColor", "[", 
                 RowBox[{"1", ",", "0", ",", "1"}], "]"}], NumberMarks -> 
               False]],
             Appearance->None,
             BaseStyle->{},
             BaselinePosition->Baseline,
             ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
               If[
                Not[
                 AbsoluteCurrentValue["Deployed"]], 
                SelectionMove[Typeset`box$, All, Expression]; 
                FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                FrontEnd`Private`$ColorSelectorInitialColor = 
                 RGBColor[1, 0, 1]; 
                FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                MathLink`CallFrontEnd[
                  FrontEnd`AttachCell[Typeset`box$, 
                   FrontEndResource["RGBColorValueSelector"], {
                   0, {Left, Bottom}}, {Left, Top}, 
                   "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]],
             DefaultBaseStyle->{},
             Evaluator->Automatic,
             Method->"Preemptive"],
            RGBColor[1, 0, 1],
            Editable->False,
            Selectable->False], ",", "Large"}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], "&"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"marker2", "[", 
    RowBox[{"{", 
     RowBox[{"d_", ",", "reachedstopcond_"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"DMAX", "=", "dMAX"}], ",", 
       RowBox[{"DMIN", "=", 
        RowBox[{"-", "dMAX"}]}], ",", 
       RowBox[{"opacity", "=", "0.1"}], ",", 
       RowBox[{"opacityline", "=", "0.3"}], ",", "\[IndentingNewLine]", 
       RowBox[{"sizemin", "=", "4"}], ",", 
       RowBox[{"sizeinc", "=", "8"}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"red", "=", "640"}], ";", "\[IndentingNewLine]", 
      RowBox[{"purple", "=", "450"}], ";", "\[IndentingNewLine]", 
      RowBox[{"darkblue", "=", "475"}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "//", 
       RowBox[{
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{"reachedstopcond", ",", "\[IndentingNewLine]", 
          RowBox[{"#", "//", 
           RowBox[{
            RowBox[{"Which", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"DMAX", "\[GreaterEqual]", " ", "#", ">", "0"}], ",", 
              RowBox[{"markerphase", "[", 
               RowBox[{
                RowBox[{"Opacity", "[", 
                 RowBox[{"opacity", ",", 
                  RowBox[{"ColorData", "[", 
                   RowBox[{"\"\<VisibleSpectrum\>\"", ",", "darkblue"}], 
                   "]"}]}], "]"}], ",", 
                RowBox[{"(*", 
                 RowBox[{"ColorData", "[", 
                  RowBox[{"\"\<VisibleSpectrum\>\"", ",", "480"}], "]"}], 
                 "*)"}], "Transparent", ",", 
                RowBox[{"sizemin", "+", 
                 RowBox[{"sizeinc", " ", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"Abs", "[", "#", "]"}], "]"}]}]}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"DMIN", "\[LessEqual]", " ", "#", "<", "0"}], ",", 
              RowBox[{"markerphase", "[", 
               RowBox[{
                RowBox[{"Opacity", "[", 
                 RowBox[{"opacity", ",", 
                  RowBox[{"ColorData", "[", 
                   RowBox[{"\"\<VisibleSpectrum\>\"", ",", "red"}], "]"}]}], 
                 "]"}], ",", 
                RowBox[{"(*", 
                 RowBox[{"ColorData", "[", 
                  RowBox[{"\"\<VisibleSpectrum\>\"", ",", "625"}], "]"}], 
                 "*)"}], "Transparent", ",", 
                RowBox[{"sizemin", "+", 
                 RowBox[{"sizeinc", " ", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"Abs", "[", "#", "]"}], "]"}]}]}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"#", "\[Equal]", "0"}], ",", 
              RowBox[{"markerphase", "[", 
               RowBox[{
                RowBox[{"Opacity", "[", 
                 RowBox[{"opacity", ",", "Transparent"}], "]"}], ",", "Black",
                 ",", 
                RowBox[{"2", " ", "sizemin"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"#", "===", "666"}], ",", "\[InvisibleSpace]", 
              "\"\<\[InvisibleSpace]\>\"", ",", "\[IndentingNewLine]", "True",
               ",", 
              RowBox[{"Style", "[", 
               RowBox[{"\"\<\[CheckedBox]\>\"", ",", 
                InterpretationBox[
                 ButtonBox[
                  TooltipBox[
                   GraphicsBox[{
                    {GrayLevel[0], RectangleBox[{0, 0}]}, 
                    {GrayLevel[0], RectangleBox[{1, -1}]}, 
                    {RGBColor[1, 0, 1], RectangleBox[{0, -1}, {2, 1}]}},
                    AspectRatio->1,
                    DefaultBaseStyle->"ColorSwatchGraphics",
                    Frame->True,
                    
                    FrameStyle->RGBColor[
                    0.6666666666666666, 0., 0.6666666666666666],
                    FrameTicks->None,
                    
                    ImageSize->
                    Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}],
                    PlotRangePadding->None],
                   StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"1", ",", "0", ",", "1"}], "]"}], NumberMarks -> 
                    False]],
                  Appearance->None,
                  BaseStyle->{},
                  BaselinePosition->Baseline,
                  ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[1, 0, 1]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]],
                  DefaultBaseStyle->{},
                  Evaluator->Automatic,
                  Method->"Preemptive"],
                 RGBColor[1, 0, 1],
                 Editable->False,
                 Selectable->False], ",", "Large"}], "]"}]}], 
             "\[IndentingNewLine]", "]"}], "&"}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "True", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"#", "//", 
           RowBox[{
            RowBox[{"Which", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"DMAX", "\[GreaterEqual]", " ", "#", ">", "0"}], ",", 
              RowBox[{"markerphase", "[", 
               RowBox[{"Transparent", ",", 
                RowBox[{"Opacity", "[", 
                 RowBox[{"opacityline", ",", 
                  RowBox[{"ColorData", "[", 
                   RowBox[{"\"\<VisibleSpectrum\>\"", ",", "darkblue"}], 
                   "]"}]}], "]"}], ",", 
                RowBox[{"sizemin", "+", 
                 RowBox[{"sizeinc", " ", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"Abs", "[", "#", "]"}], "]"}]}]}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"DMIN", "\[LessEqual]", " ", "#", "<", "0"}], ",", 
              RowBox[{"markerphase", "[", 
               RowBox[{"Transparent", ",", 
                RowBox[{"Opacity", "[", 
                 RowBox[{"opacityline", ",", 
                  RowBox[{"ColorData", "[", 
                   RowBox[{"\"\<VisibleSpectrum\>\"", ",", "red"}], "]"}]}], 
                 "]"}], ",", 
                RowBox[{"sizemin", "+", " ", 
                 RowBox[{"sizeinc", " ", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"Abs", "[", "#", "]"}], "]"}]}]}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"#", "\[Equal]", "0"}], ",", 
              RowBox[{"markerphase", "[", 
               RowBox[{"Transparent", ",", 
                RowBox[{"Opacity", "[", 
                 RowBox[{"1.0", ",", "Black"}], "]"}], ",", 
                RowBox[{"2", " ", "sizemin"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"#", "===", "666"}], ",", "\[InvisibleSpace]", 
              "\"\<\[InvisibleSpace]\>\"", ",", "\[IndentingNewLine]", "True",
               ",", 
              RowBox[{"Style", "[", 
               RowBox[{"\"\<\[CheckedBox]\>\"", ",", 
                InterpretationBox[
                 ButtonBox[
                  TooltipBox[
                   GraphicsBox[{
                    {GrayLevel[0], RectangleBox[{0, 0}]}, 
                    {GrayLevel[0], RectangleBox[{1, -1}]}, 
                    {RGBColor[1, 0, 1], RectangleBox[{0, -1}, {2, 1}]}},
                    AspectRatio->1,
                    DefaultBaseStyle->"ColorSwatchGraphics",
                    Frame->True,
                    
                    FrameStyle->RGBColor[
                    0.6666666666666666, 0., 0.6666666666666666],
                    FrameTicks->None,
                    
                    ImageSize->
                    Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}],
                    PlotRangePadding->None],
                   StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"1", ",", "0", ",", "1"}], "]"}], NumberMarks -> 
                    False]],
                  Appearance->None,
                  BaseStyle->{},
                  BaselinePosition->Baseline,
                  ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[1, 0, 1]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]],
                  DefaultBaseStyle->{},
                  Evaluator->Automatic,
                  Method->"Preemptive"],
                 RGBColor[1, 0, 1],
                 Editable->False,
                 Selectable->False], ",", "Large"}], "]"}]}], 
             "\[IndentingNewLine]", "]"}], "&"}]}]}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "]"}], "&"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PhasePlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"biasaffpair_", ",", "BeliefFinal_"}], "}"}], ",", "label_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "meanconclusion", ",", "markertable", ",", "invisible", ",", "range", 
       ",", "biasaffpairPADDED", ",", "meanconclusionPADDED"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"meanconclusion", "=", 
       RowBox[{"Mean", "/@", "BeliefFinal"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"meanconclusionPADDED", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"666", ",", "666"}], "}"}], ",", "meanconclusion"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"markertable", "=", 
       RowBox[{"marker", "/@", 
        RowBox[{"(", "meanconclusionPADDED", ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"invisible", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"bMIN", ",", "aMIN"}], "}"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"bMAX", ",", "aMAX"}], "}"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"range", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"aMIN", ",", "aMAX"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"bMIN", ",", "bMAX"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"biasaffpairPADDED", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"invisible", ",", 
         RowBox[{"List", "/@", "biasaffpair"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<plot range: \>\"", ",", "invisible"}], "]"}], ";"}], 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Reverse", "[", 
           RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", "biasaffpairPADDED"}],
         ")"}], "//", 
       RowBox[{
        RowBox[{"ListPlot", "[", 
         RowBox[{"#", ",", 
          RowBox[{"PlotMarkers", "\[Rule]", "markertable"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "range"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Bold", ",", " ", "16"}], "]"}]}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<a\>\"", ",", "Bold", ",", "Large"}], "]"}], ",", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<b\>\"", ",", "Bold", ",", "Large"}], "]"}]}], 
            "}"}]}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", "label"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", "Thick"}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", "0.9"}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", 
          RowBox[{"ImageMargins", "\[Rule]", "25"}]}], "]"}], "&"}]}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PhasePlot2", "[", 
    RowBox[{"BELIEF_List", ",", "PHASE_List", ",", "label_", ",", 
     RowBox[{"message_", ":", "True"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "reachedstopcond", ",", "meanconclusion", ",", "meanconclusionstop", 
       ",", "markertable", ",", "invisible", ",", "range", ",", "range2", ",", 
       RowBox[{"biasaffpair", "=", 
        RowBox[{"PHASE", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", "biasaffpairPADDED", ",", 
       "meanconclusionstopPADDED", ",", "plot1", ",", "plot2", ",", "amin", 
       ",", "amax", ",", "bmin", ",", "bmax", ",", "fontsize", ",", 
       "fontcolor"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"message", "//", "TrueQ"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
           "\"\<WARNING: \>\"", ",", "Bold", ",", "Orange", ",", "Medium"}], 
           "]"}], ",", "\"\< Using nquestions=\>\"", ",", "nquestions", ",", 
          "\"\< to verify stop condition.\>\""}], "]"}], ",", 
        "\[IndentingNewLine]", "Nothing"}], "\[IndentingNewLine]", "]"}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"reachedstopcond", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "<", "nquestions"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"Length", "/@", "BELIEF"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"meanconclusion", "=", 
       RowBox[{"Mean", "/@", 
        RowBox[{"BELIEF", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"meanconclusionstop", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"meanconclusion", ",", "reachedstopcond"}], "}"}], "//", 
        "Transpose"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"meanconclusionstopPADDED", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"666", ",", "True"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"666", ",", "True"}], "}"}]}], "}"}], ",", 
         "meanconclusionstop"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"markertable", "=", 
       RowBox[{"marker2", "/@", 
        RowBox[{"(", "meanconclusionstopPADDED", ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "markertable", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"amin", "=", 
       RowBox[{
        RowBox[{"PHASE", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "All", ",", "2"}], "]"}], "]"}], "//", "Min"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"amax", "=", 
       RowBox[{
        RowBox[{"PHASE", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "All", ",", "2"}], "]"}], "]"}], "//", "Max"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"bmin", "=", 
       RowBox[{
        RowBox[{"PHASE", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "All", ",", "1"}], "]"}], "]"}], "//", "Min"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"bmax", "=", 
       RowBox[{
        RowBox[{"PHASE", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "All", ",", "1"}], "]"}], "]"}], "//", "Max"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"extend", " ", "ranges", " ", "a", " ", "bit"}], ",", " ", 
        RowBox[{"for", " ", "visibility"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"amin", "=", 
       RowBox[{"amin", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"amax", "-", "amin"}], ")"}], "0.05"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"amax", "=", 
       RowBox[{"amax", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"amax", "-", "amin"}], ")"}], "0.05"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bmin", "=", 
       RowBox[{"bmin", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"bmax", "-", "bmin"}], ")"}], "0.05"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bmax", "=", 
       RowBox[{"bmax", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"bmax", "-", "bmin"}], ")"}], "0.05"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"invisible", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"bmin", ",", "amin"}], "}"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"bmax", ",", "amax"}], "}"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"range", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"bmin", ",", "bmax"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"amin", ",", "amax"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"range2", "=", 
       RowBox[{"range", "//", "Reverse"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"biasaffpairPADDED", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"invisible", ",", 
         RowBox[{"List", "/@", "biasaffpair"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"plot1", "=", 
         RowBox[{
          RowBox[{"(", "biasaffpairPADDED", ")"}], "//", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{"#", ",", 
             RowBox[{"PlotMarkers", "\[Rule]", "markertable"}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "range"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
             RowBox[{"LabelStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{"Bold", ",", " ", "16"}], "]"}]}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<b\>\"", ",", "Bold", ",", "Large"}], "]"}], ",", 
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<a\>\"", ",", "Bold", ",", "Large"}], "]"}]}], 
               "}"}]}], ",", 
             RowBox[{"PlotLabel", "\[Rule]", "label"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", "Thick"}], ",", 
             RowBox[{"AspectRatio", "\[Rule]", "0.9"}], ",", 
             RowBox[{"Frame", "\[Rule]", "True"}], ",", 
             RowBox[{"ImageMargins", "\[Rule]", "25"}]}], "]"}], "&"}]}]}], 
        ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"fontsize", "=", "28"}], ";", "\[IndentingNewLine]", 
      RowBox[{"fontcolor", "=", "Black"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"plot2", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Reverse", "[", 
            RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", 
          "biasaffpairPADDED"}], ")"}], "//", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{"#", ",", 
           RowBox[{"PlotMarkers", "\[Rule]", "markertable"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "range2"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "650"}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"Directive", "[", " ", 
             RowBox[{"fontcolor", ",", "fontsize"}], "]"}]}], ",", 
           RowBox[{"TicksStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"fontcolor", ",", "fontsize"}], "]"}]}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
               "\"\<\!\(\*SubscriptBox[\(a\), \(0\)]\)\>\"", ",", "fontcolor",
                 ",", "fontsize"}], "]"}], ",", 
              RowBox[{"Style", "[", 
               RowBox[{"\"\<b\>\"", ",", "fontcolor", ",", "fontsize"}], 
               "]"}]}], "}"}]}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", 
            RowBox[{"Style", "[", 
             RowBox[{"label", ",", "fontsize"}], "]"}]}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", "Thick"}], ",", 
           RowBox[{"AspectRatio", "\[Rule]", "0.9"}], ",", 
           RowBox[{"Frame", "\[Rule]", "True"}], ",", 
           RowBox[{"ImageMargins", "\[Rule]", "25"}]}], "]"}], "&"}]}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", "plot2"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetPHASEq", "[", "qmax_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"snapshot", " ", "at", " ", "qmax"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"length", ",", "maxlength", ",", "lengtheff", ",", "PHASEq"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"length", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"BELIEF", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "//", "Length"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"BELIEF", "//", "Length"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"maxlength", "=", 
       RowBox[{"Max", "[", "length", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lengtheff", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"#", "<", "qmax"}], ",", "#", ",", "True", ",", "qmax"}], 
          "]"}], "&"}], "/@", "length"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"maxlength", "\[LessEqual]", "qmax"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
            "\"\<\\nWarning: \>\"", ",", "Orange", ",", "16", ",", "Bold"}], 
            "]"}], ",", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"\"\<requested qmax =\>\"", " ", "<>", 
              RowBox[{"ToString", "[", "qmax", "]"}], "<>", 
              "\"\< is larger or equal to the largest nquestions asked = \
\>\"", "<>", 
              RowBox[{"ToString", "[", "maxlength", "]"}], "<>", 
              "\"\< in simulation. No cut has been done.\>\""}], ",", "16", 
             ",", "Bold"}], "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"PHASEq", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PHASE", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"BELIEF", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", 
              RowBox[{"lengtheff", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"BELIEF", "//", "Length"}]}], "}"}]}], "]"}]}], 
        "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"indexGetBELIEFq", "[", 
     RowBox[{"qnumber_", ",", "l_"}], "]"}], ":=", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{"qnumber", "\[LessEqual]", "l"}], ",", "qnumber", ",", "True", 
      ",", 
      RowBox[{"-", "1"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetBELIEFq", "[", "qmax_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "length", ",", "\[IndentingNewLine]", "stopcondition", ",", 
       "\[IndentingNewLine]", "BELIEFq", ",", "\[IndentingNewLine]", 
       "maxlength"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"length", "=", 
       RowBox[{"(", 
        RowBox[{"Length", "/@", "BELIEF"}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"maxlength", "=", 
       RowBox[{"Max", "[", "length", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"stopcondition", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "<", "qmax"}], "&"}], "/@", "length"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"maxlength", "\[LessEqual]", "qmax"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
            "\"\<\\nWarning: \>\"", ",", "Orange", ",", "16", ",", "Bold"}], 
            "]"}], ",", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"\"\<requested qmax =\>\"", " ", "<>", 
              RowBox[{"ToString", "[", "qmax", "]"}], "<>", 
              "\"\< is larger or equal to the largest nquestions asked = \
\>\"", "<>", 
              RowBox[{"ToString", "[", "maxlength", "]"}], "<>", 
              "\"\< in simulation. No cut has been done.\>\""}], ",", "16", 
             ",", "Bold"}], "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"BELIEFq", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"BELIEF", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", 
            RowBox[{"1", ";;", 
             RowBox[{"indexGetBELIEFq", "[", 
              RowBox[{"qmax", ",", 
               RowBox[{"length", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], "]"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"BELIEF", "//", "Length"}]}], "}"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PhasePlotq", "[", 
    RowBox[{"qmax_", ",", "label_", ",", 
     RowBox[{"fname_", ":", "False"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nquestionsold", "=", "nquestions"}], ",", "PHASEq", ",", 
       "BELIEFq", ",", "plot"}], "}"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nquestions", "=", "qmax"}], ";", "\[IndentingNewLine]", 
      RowBox[{"PHASEq", "=", 
       RowBox[{"GetPHASEq", "[", "qmax", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"BELIEFq", "=", 
       RowBox[{"GetBELIEFq", "[", "qmax", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plot", "=", 
       RowBox[{"PhasePlot2", "[", 
        RowBox[{"BELIEFq", ",", "PHASEq", ",", "label"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nquestions", "=", "nquestionsold"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"TrueQ", "[", 
         RowBox[{"!", "fname"}], "]"}], ",", "\[IndentingNewLine]", "Nothing",
         ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Export", "[", 
          RowBox[{"fname", ",", "plot"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"plot", "=", 
          RowBox[{
           RowBox[{"Import", "[", "fname", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "plot"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"INFO", "[", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"info", "=", "\"\<\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"info", "=", 
       RowBox[{"info", "<>", "\"\<dinit = \>\"", "<>", 
        RowBox[{"ToString", "[", "d", "]"}], "<>", "\"\<\\n\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"info", "=", 
       RowBox[{"info", "<>", "\"\<hinit = \>\"", "<>", 
        RowBox[{"ToString", "[", "h", "]"}], "<>", "\"\<\\n\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"info", "=", 
       RowBox[{"info", "<>", "\"\<nquestions = \>\"", "<>", 
        RowBox[{"ToString", "[", "nquestions", "]"}], "<>", "\"\<\\n\>\""}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"info", "=", 
       RowBox[{"info", "<>", "\"\<nexperiments = \>\"", "<>", 
        RowBox[{"ToString", "[", "nexperimentsUSER", "]"}], "<>", 
        "\"\<\\n\>\""}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"info", "=", 
       RowBox[{"info", "<>", "\"\<npredictors = \>\"", "<>", 
        RowBox[{"ToString", "[", "npredictors", "]"}], "<>", 
        "\"\<\\n\>\""}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"info", "=", 
       RowBox[{"info", "<>", "\"\<RTHRESHOLD = \>\"", "<>", 
        RowBox[{"ToString", "[", "RTHRESHOLD", "]"}], "<>", "\"\<\\n\>\""}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"info", "=", 
       RowBox[{"info", "<>", "\"\<R0 = \>\"", "<>", 
        RowBox[{"ToString", "[", "R0", "]"}], "<>", "\"\<\\n\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"info", "=", 
       RowBox[{"info", "<>", "\"\<B0 = \>\"", "<>", 
        RowBox[{"ToString", "[", "B0", "]"}], "<>", "\"\<\\n\>\""}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"info", "=", 
       RowBox[{"info", "<>", "INFOPREDICTIVEPOWER"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "info"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SaveSimulation", "[", "id_String", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dir", "=", "id"}], ",", 
      RowBox[{"names", "=", "\"\<\>\""}], ",", "out", ",", 
      RowBox[{"info", "=", "\"\<\>\""}]}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"(*", 
     RowBox[{"saves", " ", "superarrays"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"names", "=", 
       RowBox[{"SUPERARRAYNAME", "//", 
        RowBox[{"DeleteCases", "[", "\"\<PLOTS\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"out", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Export", "[", 
           RowBox[{
            RowBox[{"dir", "<>", "\"\</\>\"", "<>", "#"}], ",", 
            RowBox[{"#", "//", "ToExpression"}], ",", "\"\<String\>\""}], 
           "]"}], "&"}], ")"}], "/@", "names"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "/@", "out"}], ";"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"saves", " ", "phase", " ", "space", " ", "data"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"dir", "<>", "\"\</\>\"", "<>", "\"\<PHASE\>\""}], ",", 
       "PHASE", ",", "\"\<String\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"saves", " ", "BELIEF", "  ", "data"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"dir", "<>", "\"\</\>\"", "<>", "\"\<BELIEF\>\""}], ",", 
       "BELIEF", ",", "\"\<String\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"saves", " ", "initital", " ", "d"}], ",", " ", 
       RowBox[{"h", " ", "arrays", " ", "and", " ", "ranges", " ", "aMIN"}], 
       ",", 
       RowBox[{"aMAX", " ", "and", " ", "bMIN"}], ",", "bMAX", ",", " ", 
       RowBox[{
       "and", " ", "other", " ", "values", " ", "for", " ", "the", " ", 
        RowBox[{"simulation", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"dir", "<>", "\"\</\>\"", "<>", "\"\<info\>\""}], ",", 
       RowBox[{"INFO", "[", "]"}], ",", "\"\<String\>\""}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LoadSimulation", "[", 
    RowBox[{"id_String", ",", 
     RowBox[{"printplot_", ":", "True"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dir", "=", "id"}], ",", 
       RowBox[{"names", "=", "\"\<\>\""}], ",", "out", ",", "pts1", ",", 
       "pts2", ",", "label"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"loads", " ", "superarrays"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"names", "=", 
        RowBox[{
         RowBox[{"SUPERARRAYNAME", "//", 
          RowBox[{"DeleteCases", "[", "\"\<PLOTS\>\"", "]"}]}], "//", 
         RowBox[{"DeleteCases", "[", "\"\<EXPERIMENT\>\"", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"names", "=", 
        RowBox[{"{", "\"\<CREWARD\>\"", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Unprotect", "/@", "names"}], ";", "\[IndentingNewLine]", 
       RowBox[{"out", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "#", "<>", "\"\<=Import[\\\"\>\"", "<>", "dir", "<>", "\"\</\>\"",
              "<>", "#", "<>", "\"\<\\\"]//ToExpression\>\""}], "//", 
            "ToExpression"}], ")"}], "&"}], "/@", "names"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"loads", " ", "phase", " ", "space", " ", "data"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PHASE", "=", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{"dir", "<>", "\"\</PHASE\>\""}], "]"}], "//", 
        "ToExpression"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"loads", " ", "BELIEF", " ", "data"}], ",", " ", 
        RowBox[{"WARNING", ":", " ", 
         RowBox[{
         "overrides", " ", "current", " ", "value", " ", "of", " ", 
          "BELIEF"}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"BELIEF", "//", "Unprotect"}], ";", "\[IndentingNewLine]", 
      RowBox[{"BELIEF", "=", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{"dir", "<>", "\"\</BELIEF\>\""}], "]"}], "//", 
        "ToExpression"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"BELIEF", "//", "Protect"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "prints", " ", "contents", " ", "of", " ", "info", " ", "file"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"InfoCurrent", "=", 
       RowBox[{"Import", "[", 
        RowBox[{"dir", "<>", "\"\</info\>\""}], "]"}]}], ";", 
      RowBox[{"Print", "[", "InfoCurrent", "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"(*", 
       RowBox[{"plot", " ", "phase", " ", "diagram"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"pts1", "=", 
       RowBox[{
        RowBox[{"PHASE", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "//", "Length"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pts2", "=", 
       RowBox[{"BELIEF", "//", "Length"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"printplot", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"label", "=", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"pts1", "\[Equal]", "pts2"}], ",", 
            RowBox[{"id", "<>", "\"\<: pts = \>\"", "<>", 
             RowBox[{"ToString", "[", "pts1", "]"}]}], ",", "True", ",", 
            RowBox[{"id", "<>", "\"\<: pts1 = \>\"", "<>", 
             RowBox[{"ToString", "[", "pts1", "]"}], "<>", 
             "\"\<,  pts2 = \>\"", "<>", 
             RowBox[{"ToString", "[", "pts2", "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"PhasePlot2", "[", 
          RowBox[{"BELIEF", ",", "PHASE", ",", "label"}], "]"}]}], ",", 
        "\[IndentingNewLine]", "Nothing"}], "\[IndentingNewLine]", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LoadSimulationAll", "[", "pattern_String", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"phasefull", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"belieffull", "=", 
        RowBox[{"{", "}"}]}], ",", "simulationids", ",", "it"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"simulationids", "=", 
       RowBox[{"FileNames", "[", "pattern", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"it", "=", "1"}], ",", 
        RowBox[{"it", "\[LessEqual]", 
         RowBox[{"(", 
          RowBox[{"simulationids", "//", "Length"}], ")"}]}], ",", 
        RowBox[{"it", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"\"\<Loading '\>\"", "<>", 
             RowBox[{"simulationids", "[", 
              RowBox[{"[", "it", "]"}], "]"}], "<>", "\"\<'. \>\""}], ",", 
            "Bold", ",", "Blue", ",", "Medium"}], "]"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"LoadSimulation", "[", 
          RowBox[{
           RowBox[{"simulationids", "[", 
            RowBox[{"[", "it", "]"}], "]"}], ",", "False"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"phasefull", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"phasefull", ",", 
            RowBox[{"PHASE", "//", "Transpose"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"belieffull", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"belieffull", ",", "BELIEF"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"\"\<phasefull size = \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"phasefull", "//", "Length"}], "]"}]}], ",", "Bold", 
            ",", "Blue", ",", "Medium"}], "]"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Unprotect", "[", "BELIEF", "]"}], ";", 
      RowBox[{"BELIEF", "=", "belieffull"}], ";", 
      RowBox[{"Protect", "[", "BELIEF", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"PHASE", "=", 
       RowBox[{"phasefull", "//", "Transpose"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\n", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimulationExists", "[", "id_String", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "exists", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"exists", "=", 
       RowBox[{"DirectoryQ", "[", "id", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"exists", "//", "TrueQ"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"warning", ":", " ", 
     RowBox[{
     "deletes", " ", "current", " ", "values", " ", "of", " ", "BELIEF"}]}], 
    ",", " ", "PHASE", ",", " ", 
    RowBox[{"BiasAffPair", " ", "and"}]}], "  ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RunSimulation", "[", 
    RowBox[{"id_String", ",", "NSIMULATIONS_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "tempplot", ",", "templine", ",", "templine0", ",", "phase", ",", "id2",
        ",", "fullid", ",", "IT", ",", "itregions", ",", "it", ",", "amin", 
       ",", "amax", ",", "bmin", ",", "bmax", ",", "\[IndentingNewLine]", 
       RowBox[{"check1", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"BiasAffPair", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"BeliefFinal", "=", 
        RowBox[{"{", "}"}]}], ",", "a", ",", "b", ",", 
       RowBox[{"AffinityValues", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"BiasValues", "=", 
        RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"IT", "=", "1"}], ",", 
        RowBox[{"IT", "\[LessEqual]", "NSIMULATIONS"}], ",", 
        RowBox[{"IT", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SeedRandom", "[", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"id2", "=", 
          RowBox[{"ToString", "[", "IT", "]"}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"fullid", "=", 
          RowBox[{"id", "<>", "\"\<_\>\"", "<>", "id2"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempplot", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"BELIEF", "//", "Unprotect"}], ";", "\[IndentingNewLine]", 
         RowBox[{"BELIEF", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"BELIEF", "//", "Protect"}], ";", "\[IndentingNewLine]", 
         RowBox[{"PHASE", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"BiasAffPair", "=", 
          RowBox[{"{", "}"}]}], ";", 
         RowBox[{"BeliefFinal", "=", 
          RowBox[{"{", "}"}]}], ";", 
         RowBox[{"AffinityValues", "=", 
          RowBox[{"{", "}"}]}], ";", 
         RowBox[{"BiasValues", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"SimulationExists", "[", "fullid", "]"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Simulation '\>\"", "<>", "fullid", "<>", 
             "\"\<' exists. Aborting.\>\""}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SaveSimulation", "[", "fullid", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"itregions", "=", "1"}], ",", 
              RowBox[{"itregions", "\[LessEqual]", 
               RowBox[{"(", "nregions", ")"}]}], ",", 
              RowBox[{"itregions", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "sets", " ", "range", " ", "of", " ", "a", " ", "and", " ", 
                "b", " ", "for", " ", "current", " ", "region"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"amin", ",", "amax"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"bmin", ",", "bmax"}], "}"}]}], "}"}], "=", 
                RowBox[{"REGION", "[", 
                 RowBox[{"[", "itregions", "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"NotebookDelete", "[", "templine0", "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"NotebookDelete", "[", "tempplot", "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"templine0", "=", 
                RowBox[{"PrintTemporary", "[", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{"\"\<region=\>\"", ",", "Large", ",", "Bold"}], 
                   "]"}], ",", 
                  RowBox[{"Style", "[", 
                   RowBox[{"itregions", ",", "Large", ",", "Bold"}], "]"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"\"\< (out of \>\"", "<>", 
                    RowBox[{"ToString", "[", "nregions", "]"}], "<>", 
                    "\"\<)\>\""}], ",", "Large", ",", "Bold"}], "]"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"tempplot", "=", 
                RowBox[{"PrintTemporary", "[", "phase", "]"}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"For", "[", 
                RowBox[{
                 RowBox[{"it", "=", "1"}], ",", 
                 RowBox[{"it", "\[LessEqual]", "ptsREGION"}], ",", 
                 RowBox[{"it", "++"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{"to", " ", "show", " ", "progress"}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"NotebookDelete", "[", "templine", "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"templine", "=", 
                   RowBox[{"PrintTemporary", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\<it=\>\"", ",", "Large", ",", "Bold"}], "]"}],
                     ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"it", ",", "Large", ",", "Bold"}], "]"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{
                    "sets", " ", "and", " ", "stores", " ", "values", " ", 
                    "of", " ", "a"}], ",", 
                    RowBox[{
                    "b", " ", "for", " ", "all", " ", "iterations"}]}], 
                   "*)"}], "\[IndentingNewLine]", 
                  RowBox[{"a", "=", 
                   RowBox[{"ConstantArray", "[", 
                    RowBox[{
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{"amin", ",", "amax"}], "}"}], "]"}], ",", 
                    "npredictors"}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"b", "=", 
                   RowBox[{"ConstantArray", "[", 
                    RowBox[{
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{"bmin", ",", "bmax"}], "}"}], "]"}], ",", 
                    "npredictors"}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"AffinityValues", ",", 
                    RowBox[{"a", "//", "Mean"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"BiasValues", ",", 
                    RowBox[{"b", "//", "Mean"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{"initialize", " ", "experiment"}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{"InitExperimentRewardDriven", "[", 
                   RowBox[{"d", ",", "a", ",", "b", ",", "h"}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{"run", " ", "experiment"}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{"RunExperimentStop", "[", "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                   "saves", " ", "data", " ", "on", " ", "degree", " ", "of", 
                    " ", "belief", " ", "during", " ", "the", " ", 
                    "simulation"}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{"StoreBeliefCurrent", "[", "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                   "store", " ", "values", " ", "for", " ", "phase", " ", 
                    "plot"}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{"BiasAffPair", "=", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"BiasValues", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"AffinityValues", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"AffinityValues", "//", "Length"}]}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"BeliefFinal", "=", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"BELIEF", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"BELIEF", "//", "Length"}]}], "}"}]}], "]"}]}], 
                  ";", "\[IndentingNewLine]", 
                  RowBox[{"PHASE", "=", 
                   RowBox[{"{", 
                    RowBox[{"BiasAffPair", ",", "BeliefFinal"}], "}"}]}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"phase", "=", 
                   RowBox[{"PhasePlot2", "[", 
                    RowBox[{"BELIEF", ",", "PHASE", ",", 
                    RowBox[{"\"\<j=\>\"", "<>", 
                    RowBox[{"ToString", "[", "it", "]"}]}], ",", "False"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"it", ",", "10"}], "]"}], "\[Equal]", "0"}], "||", 
                    RowBox[{"it", "\[Equal]", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{"NotebookDelete", "[", "tempplot", "]"}], ";", 
                    RowBox[{"tempplot", "=", 
                    RowBox[{"PrintTemporary", "[", "phase", "]"}]}]}]}], 
                   "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"it", ",", "30"}], "]"}], "\[Equal]", "0"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SaveSimulation", "[", "fullid", "]"}], ",", 
                    "\[IndentingNewLine]", "Nothing", ",", "Nothing"}], 
                   "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"SaveSimulation", "[", "fullid", "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", "check1", "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"EXPERIMENT", "//", "Flatten"}], "//", 
                RowBox[{"Cases", "[", 
                 RowBox[{"x_", "\[RuleDelayed]", 
                  RowBox[{"x", "/;", 
                   RowBox[{"!", 
                    RowBox[{"NumericQ", "[", "x", "]"}]}]}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", "\[IndentingNewLine]", 
                RowBox[{"check1", ",", "\[IndentingNewLine]", 
                 RowBox[{"List", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{
                    "\"\<This should print a value of 0: value =  \>\"", ",", 
                    "Large", ",", "Bold", ",", "Black"}], "]"}], ",", 
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"%", "//", "Length"}], "//", "ToString"}], ",", 
                    "Bold", ",", "Large", ",", "Blue"}], "]"}]}], "]"}]}], 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"Init", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"SaveSimulation", "[", "fullid", "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"check1", "//", "DeleteDuplicates"}], "//", "MatrixForm"}],
           "//", "Print"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"BELIEF", "//", "Unprotect"}], ";", "\[IndentingNewLine]", 
      RowBox[{"BELIEF", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"BELIEF", "//", "Protect"}], ";", "\[IndentingNewLine]", 
      RowBox[{"PHASE", "=", 
       RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nquestionsUSER", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nexperimentsUSER", "=", "600"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"npredictorsUSER", "=", "20"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"affinity", " ", "related", " ", "settings"}], ",", " ", 
    RowBox[{"keep", " ", "fixed"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RTHRESHOLD", "=", "4.04"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NSTABLE", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R0", "=", "50"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"bias", " ", "related", " ", "settings"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"B0", "=", "0.7"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"set", " ", 
      RowBox[{"forecast", ":", " ", "dmax"}]}], "=", "4"}], ",", 
    RowBox[{"nsteps", "=", "8"}], ",", " ", 
    RowBox[{
     RowBox[{"max", " ", "power"}], "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"21", " ", "\[DoubleLongRightArrow]", " ", "max"}], 
       RowBox[{"{", 
        SubscriptBox["p", "avg"], "}"}]}], " ", "=", " ", "0.9545"}]}], " ", 
    ",", " ", 
    RowBox[{"keep", " ", "fixed"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BuildPredictivePowerFunction", "[", 
    RowBox[{"4", ",", "8"}], "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "unused", " ", "but", " ", "needed", " ", "for", " ", "function", " ", 
    RowBox[{"below", " ", "'"}], 
    RowBox[{"InitSimulationRewardDriven", "'"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a", "=", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", "npredictorsUSER"}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "a", " ", "here", " ", "means", " ", "a0", " ", "in", " ", "draft"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b", "=", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", "npredictorsUSER"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "initial", " ", "degree", " ", "of", " ", "belief", " ", "and", " ", 
    "random", " ", "walk", " ", "parameter", " ", "h"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"{", 
    RowBox[{"4", ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0.99", ",", "npredictorsUSER"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 Deletable->False,
 InitializationCell->True,
 CellChangeTimes->{{3.877849809406891*^9, 3.8778498503954067`*^9}, {
   3.8778499309893208`*^9, 3.877849946275546*^9}, {3.8778500049634857`*^9, 
   3.8778501014436083`*^9}, {3.877850249967497*^9, 3.87785025568773*^9}, {
   3.8778502992225227`*^9, 3.877850299386874*^9}, {3.8778530126933937`*^9, 
   3.877853057296454*^9}, {3.877853288457003*^9, 3.877853292054446*^9}, {
   3.8778535412510242`*^9, 3.87785355622231*^9}, {3.877853790115253*^9, 
   3.877853795462759*^9}, {3.8796626040504417`*^9, 3.879662604113306*^9}, {
   3.879662649328985*^9, 3.879662649438696*^9}, {3.8796626810475273`*^9, 
   3.879662681072003*^9}, {3.8796628002387733`*^9, 3.879662800376938*^9}, {
   3.879662877675668*^9, 3.879662877726756*^9}, {3.879665010696828*^9, 
   3.879665010839024*^9}, {3.8796668942293262`*^9, 3.879666894387042*^9}, {
   3.879669761827092*^9, 3.879669761879118*^9}, {3.8796704473795147`*^9, 
   3.879670452825761*^9}, {3.8796704995180283`*^9, 3.879670526584752*^9}, {
   3.879670605986412*^9, 3.879670611863183*^9}, {3.879670659131469*^9, 
   3.879670667975255*^9}, {3.8796707177916193`*^9, 3.879670812096628*^9}, {
   3.8796708791115007`*^9, 3.879670887637148*^9}, {3.8796709237027893`*^9, 
   3.879670970575465*^9}, {3.879671010454867*^9, 3.879671205298746*^9}, {
   3.8798265126625347`*^9, 3.879826512713071*^9}, {3.879832728559978*^9, 
   3.8798327446968803`*^9}, {3.879955576215283*^9, 3.879955577051032*^9}, {
   3.882621112458112*^9, 3.882621112486958*^9}, {3.8826211648175097`*^9, 
   3.8826211649002666`*^9}, {3.882689133863813*^9, 3.88268913457994*^9}, {
   3.882690470948847*^9, 3.8826904719771433`*^9}, {3.8832142751311703`*^9, 
   3.883214279494855*^9}, {3.8832144991296988`*^9, 3.8832145076940413`*^9}, {
   3.883389731796817*^9, 3.883389740559721*^9}, {3.884418990329795*^9, 
   3.884418999067463*^9}, {3.8844190576500187`*^9, 3.884419064162418*^9}, {
   3.884419103328785*^9, 3.884419140506413*^9}, {3.884677253436153*^9, 
   3.884677381587961*^9}, {3.884677435514928*^9, 3.884677572802795*^9}, {
   3.884677625365436*^9, 3.8846776498734913`*^9}, {3.884677945266152*^9, 
   3.884677968764805*^9}, {3.884678005516192*^9, 3.884678034914715*^9}, {
   3.884678856141408*^9, 3.884678977718465*^9}, 3.884679023994988*^9, {
   3.8846790623318863`*^9, 3.884679079931573*^9}, {3.884679184377639*^9, 
   3.884679437006184*^9}, {3.884679477507196*^9, 3.884679770787614*^9}, {
   3.8846802292373857`*^9, 3.884680231134799*^9}, {3.8846945030993233`*^9, 
   3.884694515424842*^9}, {3.884694575811884*^9, 3.884694578864745*^9}, {
   3.8846946142270117`*^9, 3.884694648454653*^9}, {3.8846946868574123`*^9, 
   3.884694728494034*^9}, {3.8846947676683617`*^9, 3.884694823434636*^9}, {
   3.884694859656878*^9, 3.884694899971212*^9}, 3.88476846558851*^9, {
   3.884768545427965*^9, 3.884768546714665*^9}, {3.884768638986491*^9, 
   3.884768651806999*^9}, {3.884769243802144*^9, 3.884769324431933*^9}, {
   3.884774641369945*^9, 3.884774681221307*^9}, {3.8847747418828163`*^9, 
   3.884774979330229*^9}, 3.884775020037456*^9, 3.88477514052313*^9, {
   3.884776060869227*^9, 3.8847764561253366`*^9}, {3.8847772222176*^9, 
   3.884777232571394*^9}, {3.884777724812434*^9, 3.884777853520123*^9}, {
   3.8847780760147533`*^9, 3.884778109467876*^9}, {3.8847783114636383`*^9, 
   3.884778316370758*^9}, {3.884778572231614*^9, 3.884778572600271*^9}, {
   3.88557152800954*^9, 3.8855715282002068`*^9}, {3.885708185619235*^9, 
   3.885708186130542*^9}, {3.885712954602956*^9, 3.88571297816148*^9}, {
   3.8857131189366903`*^9, 3.885713234404542*^9}, {3.885713390347199*^9, 
   3.8857134124652147`*^9}, {3.885713466438541*^9, 3.885713490115161*^9}, {
   3.885713572281404*^9, 3.8857136043994427`*^9}, {3.8857136667296352`*^9, 
   3.8857137010955343`*^9}, {3.885713768478669*^9, 3.885713834497675*^9}, {
   3.885793360249324*^9, 3.8857934409345207`*^9}, {3.885793526750433*^9, 
   3.8857935327163067`*^9}, {3.8857937105169497`*^9, 3.885793735132649*^9}, {
   3.885793848810072*^9, 3.885793853772994*^9}, {3.885820894119595*^9, 
   3.8858208958717527`*^9}, {3.885820945769196*^9, 3.8858209621856213`*^9}, {
   3.885821046066183*^9, 3.885821060285223*^9}, {3.88582109853998*^9, 
   3.885821099082343*^9}, {3.885821188138033*^9, 3.885821190206499*^9}, {
   3.88582126363758*^9, 3.885821302346596*^9}, {3.8860066265248737`*^9, 
   3.8860066265566473`*^9}, {3.886006903829464*^9, 3.886006911196258*^9}, {
   3.886007236236125*^9, 3.886007236289321*^9}, {3.886009701194683*^9, 
   3.886009701228545*^9}, 3.886010918953415*^9, {3.886062144831788*^9, 
   3.886062146225657*^9}, 3.8860732215888433`*^9, {3.8860757677113647`*^9, 
   3.886075814316033*^9}, {3.8860759387131033`*^9, 3.886075939026173*^9}, {
   3.886076524853757*^9, 3.886076524890005*^9}, {3.886076667126721*^9, 
   3.886076723895009*^9}, 3.886243226498722*^9, {3.886243274601191*^9, 
   3.8862432773377132`*^9}, {3.8862433676064777`*^9, 3.886243408105152*^9}, {
   3.886243463521744*^9, 3.886243463870337*^9}, {3.886243603006287*^9, 
   3.886243611276466*^9}, {3.886246761370719*^9, 3.886246767433709*^9}, {
   3.88624852864109*^9, 3.886248529042244*^9}, {3.886248633780814*^9, 
   3.886248647983281*^9}, {3.886248696468925*^9, 3.886248738551869*^9}, {
   3.886248771051456*^9, 3.88624878346176*^9}, {3.886248970814307*^9, 
   3.886248975020073*^9}, {3.886249041672723*^9, 3.886249044119471*^9}, {
   3.8862500851577177`*^9, 3.8862501655536823`*^9}, {3.886250338371626*^9, 
   3.8862503434307013`*^9}, {3.886250508543475*^9, 3.886250532154101*^9}, {
   3.886250689539542*^9, 3.88625073677451*^9}, {3.886250901686037*^9, 
   3.886250902453918*^9}, {3.886251130546434*^9, 3.886251146898573*^9}, {
   3.886251276394189*^9, 3.886251279539764*^9}, {3.8862513945074387`*^9, 
   3.886251399546205*^9}, {3.886251456718154*^9, 3.886251459884605*^9}, {
   3.8862603586288137`*^9, 3.8862603623210278`*^9}, {3.886260952569422*^9, 
   3.886260980286232*^9}, {3.886262099202794*^9, 3.8862620998388767`*^9}, {
   3.886262206916974*^9, 3.8862622075336657`*^9}, {3.886262637433856*^9, 
   3.886262658458515*^9}, {3.886262803636985*^9, 3.886262809221586*^9}, {
   3.886262868064013*^9, 3.886262925949361*^9}, {3.8862630094615793`*^9, 
   3.886263012179512*^9}, {3.8862630568902397`*^9, 3.886263072962137*^9}, {
   3.8862633727921886`*^9, 3.88626338642146*^9}, {3.8862636461294203`*^9, 
   3.8862636508224993`*^9}, {3.886263729895006*^9, 3.886263794427347*^9}, {
   3.886263856746778*^9, 3.88626385681835*^9}, {3.886263931304377*^9, 
   3.8862639343141623`*^9}, {3.886264151359898*^9, 3.886264152083995*^9}, {
   3.886264692950379*^9, 3.886264698590315*^9}, {3.886275912571342*^9, 
   3.886275917577435*^9}, 3.886276059941379*^9, {3.8862761212920322`*^9, 
   3.886276123281177*^9}, {3.886313515528842*^9, 3.8863135274662867`*^9}, {
   3.886313570016099*^9, 3.88631359350664*^9}, {3.886605142824596*^9, 
   3.8866051577837343`*^9}, {3.886605822173861*^9, 3.886606022693726*^9}, {
   3.8866061131657867`*^9, 3.886606117822729*^9}, {3.8866064087667437`*^9, 
   3.886606441682873*^9}, {3.886606683480557*^9, 3.886606746204083*^9}, {
   3.886606800710887*^9, 3.886606801207759*^9}, {3.886606860861372*^9, 
   3.886606865817459*^9}, {3.8866084910823393`*^9, 3.886608505623683*^9}, {
   3.886608570216043*^9, 3.8866086263597183`*^9}, {3.886608798661849*^9, 
   3.886608805136629*^9}, {3.8866089036647453`*^9, 3.886608943319392*^9}, {
   3.8866091117871523`*^9, 3.886609124552534*^9}, {3.886609752958007*^9, 
   3.886609786600758*^9}, {3.886611047760401*^9, 3.886611054108733*^9}, {
   3.88661112431135*^9, 3.886611139983358*^9}, {3.886611570958374*^9, 
   3.8866116086878366`*^9}, {3.8866138908373938`*^9, 
   3.8866138927966843`*^9}, {3.886613928253778*^9, 3.88661393932897*^9}, {
   3.886614198350484*^9, 3.886614201321162*^9}, {3.8866143424919777`*^9, 
   3.886614352258354*^9}, {3.88661503903272*^9, 3.886615039409953*^9}, {
   3.886930008539117*^9, 3.886930015230753*^9}, {3.886930054722825*^9, 
   3.8869300552798347`*^9}, {3.886933748539297*^9, 3.8869337486629343`*^9}, {
   3.8869339932106667`*^9, 3.886934024067276*^9}, {3.886934066017871*^9, 
   3.886934120005575*^9}, {3.886934490121025*^9, 3.886934509738543*^9}, {
   3.886934617238595*^9, 3.88693464793148*^9}, {3.886935220046517*^9, 
   3.88693522102335*^9}, {3.886935349813929*^9, 3.886935390175812*^9}},
 CellLabel->
  "In[1564]:=",ExpressionUUID->"c87f32fc-de2d-4417-9182-56c21142e143"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.886611711151042*^9, 3.886611775104686*^9}, {
   3.88661190658193*^9, 3.886611938336607*^9}, {3.8866119928709927`*^9, 
   3.886611995992341*^9}, {3.886612100136713*^9, 3.886612100359376*^9}, {
   3.886612165981688*^9, 3.886612166176373*^9}, {3.8866122214959908`*^9, 
   3.886612221664514*^9}, {3.8866122818794413`*^9, 3.8866122846073847`*^9}, {
   3.886612405337597*^9, 3.886612405686945*^9}, {3.886612449984305*^9, 
   3.8866124501191597`*^9}, {3.886612500557535*^9, 3.88661250200294*^9}, {
   3.886612561521092*^9, 3.886612561787121*^9}, {3.8866126099837723`*^9, 
   3.8866126102125273`*^9}, {3.8866126911651173`*^9, 3.88661269156398*^9}, {
   3.886612916925815*^9, 3.886612917227428*^9}, {3.886612969058737*^9, 
   3.8866130588199778`*^9}, {3.886613097392364*^9, 3.886613105701027*^9}, {
   3.8866131393459473`*^9, 3.886613152281432*^9}, {3.8866132057729483`*^9, 
   3.88661322110494*^9}, {3.8866145369816933`*^9, 3.8866145835240498`*^9}, {
   3.886614616343232*^9, 3.886614649142166*^9}, {3.886614725487155*^9, 
   3.886614807294486*^9}, 
   3.887211925597768*^9},ExpressionUUID->"939b6cc7-df53-4200-a599-\
42d4e1ace7ff"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.886613130989005*^9, 3.8866131319582567`*^9}, {
  3.8866131668490133`*^9, 3.886613167097032*^9}, {3.886613293132559*^9, 
  3.886613296854596*^9}, {3.886614824706572*^9, 3.886614832578866*^9}, {
  3.8866150571915703`*^9, 3.8866151232104473`*^9}, {3.886615169584076*^9, 
  3.886615204692809*^9}, {3.886615238894095*^9, 
  3.886615308708441*^9}},ExpressionUUID->"2ae4144a-53ce-4988-8493-\
59861a25032f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Load Simulation.\[LineSeparator]The argument of \
\[OpenCurlyQuote]LoadSimulationAll\[CloseCurlyQuote] is a string pattern. \
Results of all simulations inside directories corresponding to the pattern \
are combined. \[LineSeparator]ex1:  \
LoadSimulationAll[\[OpenCurlyDoubleQuote]case_I_1_1\[CloseCurlyDoubleQuote]] \
loads only results in directory \[OpenCurlyDoubleQuote]case_I_1_1\
\[CloseCurlyDoubleQuote]\[LineSeparator]ex2:  LoadSimulationAll[\
\[OpenCurlyDoubleQuote]case_I_1_*\[CloseCurlyDoubleQuote]] loads all results \
in directories which names start with \[OpenCurlyDoubleQuote]case_I_1\
\[CloseCurlyDoubleQuote]\[LineSeparator]\
\>", "Item",
 CellChangeTimes->{{3.8862642737052383`*^9, 3.8862643521348963`*^9}, {
  3.8866159970010357`*^9, 3.886616003949585*^9}, {3.887212069190403*^9, 
  3.8872121071680317`*^9}, {3.887212143318614*^9, 3.887212184727728*^9}, {
  3.8872127991982403`*^9, 3.887212939667701*^9}},
 FontSize->18,ExpressionUUID->"70c7eb1f-f1bf-4b2c-8c63-94286b70d059"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"phaseI", "=", "PHASE"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beliefI", "=", "BELIEF"}], ";"}]}], "Input",
 CellChangeTimes->{{3.887384600360928*^9, 3.887384616284485*^9}, {
  3.887384662388691*^9, 3.887384664038924*^9}, {3.887384863615568*^9, 
  3.8873848651817293`*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"6e4ef527-3398-41ca-aca6-89071fd1c89e"],

Cell[BoxData[
 RowBox[{"LoadSimulationAll", "[", "\"\<case_II2_h-2_*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.8866160305295143`*^9, 3.8866160718596992`*^9}, 
   3.886929836220607*^9, 3.886936180175288*^9, 3.887212110193695*^9, {
   3.887212338378879*^9, 3.8872123385624437`*^9}, {3.8873846212365503`*^9, 
   3.887384621319558*^9}, {3.8873848548366947`*^9, 3.8873848586331577`*^9}, {
   3.8873850162146893`*^9, 3.88738501632613*^9}, {3.887385879769552*^9, 
   3.887385879866702*^9}, {3.887386463690692*^9, 3.887386463858149*^9}, {
   3.888477924603716*^9, 3.88847792788303*^9}, {3.888505092114785*^9, 
   3.8885050922079678`*^9}, {3.888512994524517*^9, 3.8885129946424427`*^9}, {
   3.888652096772997*^9, 3.8886521285746098`*^9}, {3.8886526114525213`*^9, 
   3.888652611534163*^9}, {3.88865469862055*^9, 3.8886547078818274`*^9}, {
   3.8897849037090797`*^9, 3.889784907569944*^9}},
 CellLabel->
  "In[1595]:=",ExpressionUUID->"c20e146b-7516-4bc6-be5d-b6da55f1fb09"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Plot results.\[LineSeparator]after loading, two variables  contain all \
results stored:\[LineSeparator]1)\[OpenCurlyQuote]PHASE\[CloseCurlyQuote]\
\[LineSeparator]2) \
\[OpenCurlyQuote]BELIEF\[CloseCurlyQuote]\[LineSeparator]which are used for \
the plots. To plot run :\[LineSeparator]\[LineSeparator]i) \
PhasePlotq[j,label]: j is the question number for which the \
\[OpenCurlyDoubleQuote]snapshot\[CloseCurlyDoubleQuote] is taken (at most \
j=nmax=1000)\[LineSeparator]                                              \
label is a string to show in the header of the plot\[LineSeparator]\
\[LineSeparator]iI) ",
 StyleBox["PhasePlotq[j,label,fname]:",
  FontSize->24,
  FontWeight->"Bold"],
 " j and label as before, this version stores the result in a file called \
\[OpenCurlyQuote]fname\[CloseCurlyQuote] \[LineSeparator]                     \
                                        (fname must have pdf extension)\
\[LineSeparator]Warnings are printed by default in all cases, to indicate the \
value of j used. "
}], "Item",
 CellChangeTimes->{{3.8862642737052383`*^9, 3.8862643521348963`*^9}, {
  3.8866159970010357`*^9, 3.886616003949585*^9}, {3.887212069190403*^9, 
  3.8872121071680317`*^9}, {3.887212143318614*^9, 3.887212309460425*^9}, {
  3.8872124595895452`*^9, 3.8872126798896503`*^9}, {3.887213002457809*^9, 
  3.887213034549631*^9}},
 FontSize->18,ExpressionUUID->"e86bf0de-2f21-4934-a535-dbb16ac23676"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"PhasePlotq", "[", 
    RowBox[{
    "1", ",", "\"\<j=1\>\"", ",", "\"\<plot_case_II2_h-2_j-1.pdf\>\""}], 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{"PhasePlotq", "[", 
    RowBox[{
    "50", ",", "\"\<j=50\>\"", ",", "\"\<plot_case_II2_h-2_j-50.pdf\>\""}], 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{"PhasePlotq", "[", 
    RowBox[{
    "100", ",", "\"\<j=100\>\"", ",", "\"\<plot_case_II2_h-2_j-100.pdf\>\""}],
     "]"}], "\[IndentingNewLine]", 
   RowBox[{"PhasePlotq", "[", 
    RowBox[{
    "1000", ",", "\"\<j=\!\(\*SubscriptBox[\(n\), \(max\)]\)=1000\>\"", ",", 
     "\"\<plot_case_II2_h-2_j-1000.pdf\>\""}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.887212368046834*^9, 3.88721238820577*^9}, {
   3.8872124269278717`*^9, 3.887212450408854*^9}, {3.887212718186184*^9, 
   3.8872127427676773`*^9}, {3.887277796369285*^9, 3.887277801543539*^9}, {
   3.887277981211594*^9, 3.887277982310523*^9}, 3.887356891860355*^9, {
   3.887384635702376*^9, 3.887384637597815*^9}, {3.8873848917057858`*^9, 
   3.887384896266831*^9}, {3.887385059737227*^9, 3.887385069296484*^9}, {
   3.887385766218902*^9, 3.8873858115420933`*^9}, {3.8873858699262743`*^9, 
   3.887385874471786*^9}, {3.887386039751573*^9, 3.887386041330187*^9}, {
   3.887386087982342*^9, 3.887386089400613*^9}, {3.8873861271678963`*^9, 
   3.887386191125395*^9}, {3.887386443968774*^9, 3.8873864569122543`*^9}, {
   3.888478021638019*^9, 3.888478066792461*^9}, {3.888505104728414*^9, 
   3.888505111087635*^9}, {3.888505158472439*^9, 3.8885051914391003`*^9}, {
   3.888512956908669*^9, 3.888512982303059*^9}, {3.888513067292548*^9, 
   3.8885130713626537`*^9}, {3.8886521747718554`*^9, 3.888652221317966*^9}, {
   3.8897848346107693`*^9, 3.889784839095948*^9}, {3.8897848867400208`*^9, 
   3.889784890925783*^9}},
 CellLabel->
  "In[1596]:=",ExpressionUUID->"08d14aef-2054-4313-b346-d558bc3dcace"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8886526988775587`*^9, 3.888652702421701*^9}, {
   3.889784840883624*^9, 3.889784849859251*^9}, 
   3.8897852824004087`*^9},ExpressionUUID->"d4df27e8-2896-4a57-8b3a-\
d88f7b30dc68"]
}, Open  ]]
},
WindowSize->{1239, 664},
WindowMargins->{{19, Automatic}, {1, Automatic}},
FrontEndVersion->"12.2 for Mac OS X x86 (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"bb82231e-71ff-475a-b493-4f77ca302b0c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 207, 2, 59, "Item",ExpressionUUID->"3d534153-7ecd-45e7-b627-6e865fe32bc6"],
Cell[790, 26, 76777, 1724, 7672, "Input",ExpressionUUID->"c87f32fc-de2d-4417-9182-56c21142e143",
 InitializationCell->True],
Cell[77570, 1752, 1173, 17, 30, "Input",ExpressionUUID->"939b6cc7-df53-4200-a599-42d4e1ace7ff"],
Cell[78746, 1771, 448, 7, 30, "Input",ExpressionUUID->"2ae4144a-53ce-4988-8493-59861a25032f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79231, 1783, 1006, 16, 131, "Item",ExpressionUUID->"70c7eb1f-f1bf-4b2c-8c63-94286b70d059"],
Cell[80240, 1801, 402, 8, 52, "Input",ExpressionUUID->"6e4ef527-3398-41ca-aca6-89071fd1c89e"],
Cell[80645, 1811, 968, 14, 30, "Input",ExpressionUUID->"c20e146b-7516-4bc6-be5d-b6da55f1fb09"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81650, 1830, 1440, 25, 307, "Item",ExpressionUUID->"e86bf0de-2f21-4934-a535-dbb16ac23676"],
Cell[83093, 1857, 1959, 36, 136, "Input",ExpressionUUID->"08d14aef-2054-4313-b346-d558bc3dcace"],
Cell[85055, 1895, 229, 4, 30, "Input",ExpressionUUID->"d4df27e8-2896-4a57-8b3a-d88f7b30dc68"]
}, Open  ]]
}
]
*)

