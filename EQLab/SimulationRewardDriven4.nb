(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    162736,       2984]
NotebookOptionsPosition[    159533,       2923]
NotebookOutlinePosition[    159962,       2940]
CellTagsIndexPosition[    159919,       2937]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", "npredictors", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "EQLab2`"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.87024601336097*^9, 3.8702460269838047`*^9}, 
   3.870247562398513*^9, {3.870247901290688*^9, 3.870247913545789*^9}, {
   3.870248171112443*^9, 3.8702481805348454`*^9}, {3.870248393626191*^9, 
   3.8702484198548927`*^9}, {3.870249617559556*^9, 3.870249619120874*^9}, {
   3.870249891315257*^9, 3.8702499010453577`*^9}, {3.87024993698578*^9, 
   3.870249939191617*^9}, {3.8702506005986147`*^9, 3.8702507616549807`*^9}, {
   3.870250798743535*^9, 3.8702508045200787`*^9}, {3.870250891437058*^9, 
   3.870251027231915*^9}, {3.87025108250043*^9, 3.8702512212537107`*^9}, {
   3.8702513015979652`*^9, 3.870251336611343*^9}, {3.8702513693895407`*^9, 
   3.8702513869135017`*^9}, {3.8702515131913853`*^9, 
   3.8702515134078693`*^9}, {3.870251648614447*^9, 3.8702516874558353`*^9}, {
   3.870251720617352*^9, 3.8702517311062937`*^9}, {3.870251770035828*^9, 
   3.870251814306525*^9}, {3.870251850451576*^9, 3.870251861056651*^9}, {
   3.8702518930491457`*^9, 3.8702518991355*^9}, {3.870251946430917*^9, 
   3.870252018531983*^9}, {3.870252084932032*^9, 3.870252094300758*^9}, {
   3.870252555472765*^9, 3.8702525779917316`*^9}, {3.870252707123612*^9, 
   3.8702527379141912`*^9}, 3.870255799997542*^9, {3.87154036875607*^9, 
   3.871540416023946*^9}, {3.871540517014429*^9, 3.87154063506811*^9}, {
   3.87154071257174*^9, 3.8715407963416643`*^9}, {3.871540862834383*^9, 
   3.8715409126358547`*^9}, {3.8715410114674377`*^9, 3.871541020238207*^9}, 
   3.871541063284964*^9, {3.8715413046748962`*^9, 3.871541308832623*^9}, {
   3.871541543171513*^9, 3.87154154458173*^9}, {3.871541612962653*^9, 
   3.871541675846324*^9}, {3.871542679093449*^9, 3.8715427133999643`*^9}, {
   3.8715427800836763`*^9, 3.8715428192208242`*^9}, {3.871542850834771*^9, 
   3.871542870510728*^9}, {3.871544067233506*^9, 3.871544105809017*^9}, {
   3.8715441387924128`*^9, 3.871544224865347*^9}, {3.8715442624598007`*^9, 
   3.8715442635591497`*^9}, {3.871544321834899*^9, 3.871544324848575*^9}, 
   3.871544403438064*^9, {3.8715444677263412`*^9, 3.871544481004189*^9}, {
   3.871544527891453*^9, 3.871544580101633*^9}, {3.871544628012183*^9, 
   3.8715446483241177`*^9}, 3.8715517316934023`*^9, {3.8715522886629047`*^9, 
   3.871552288872658*^9}, {3.871552334403838*^9, 3.8715523346289062`*^9}, {
   3.8715528021646833`*^9, 3.87155280228822*^9}, {3.871552978852976*^9, 
   3.871552978913268*^9}, {3.871553016671008*^9, 3.871553018817437*^9}, 
   3.871553095793416*^9, {3.87155344044904*^9, 3.8715534935511303`*^9}, {
   3.87155352658245*^9, 3.8715535329892282`*^9}, {3.871553579343412*^9, 
   3.871553581313673*^9}, {3.871553958458755*^9, 3.8715539601506977`*^9}, {
   3.871558828086731*^9, 3.871558833848982*^9}, {3.871558906187265*^9, 
   3.871558987682918*^9}, 3.871559316760728*^9, {3.871559699941874*^9, 
   3.87155972602384*^9}, {3.871559759032323*^9, 3.871559764897707*^9}, {
   3.871559936681774*^9, 3.8715599530424633`*^9}, {3.871565073485072*^9, 
   3.871565100636739*^9}, {3.871565130853056*^9, 3.871565145649899*^9}, {
   3.871565529030569*^9, 3.8715655292252417`*^9}, {3.871565773157311*^9, 
   3.871565795180543*^9}, {3.8715661046802597`*^9, 3.87156618194703*^9}, {
   3.871574703968054*^9, 3.871574708693071*^9}, {3.8715757688688374`*^9, 
   3.8715757791461077`*^9}, {3.87157711188148*^9, 3.871577118781273*^9}, {
   3.871578716803144*^9, 3.8715787176352158`*^9}, {3.871579499556983*^9, 
   3.871579510977072*^9}, {3.871579593597062*^9, 3.871579612561151*^9}, {
   3.8715796447265863`*^9, 3.871579663109097*^9}, {3.8715797400827703`*^9, 
   3.87157985138531*^9}, {3.871579978237791*^9, 3.871579984805667*^9}, {
   3.871580718939529*^9, 3.871580725219192*^9}, {3.871581815307456*^9, 
   3.871581821065613*^9}, {3.871581925139412*^9, 3.871581941963879*^9}, {
   3.871656418980259*^9, 3.871656419524384*^9}, 3.871656449666934*^9, {
   3.871656534210606*^9, 3.871656552996997*^9}, {3.871656628255406*^9, 
   3.871656637796645*^9}, {3.871656680266336*^9, 3.871656683113514*^9}, {
   3.8716567799153357`*^9, 3.871656779997355*^9}, {3.871656837809424*^9, 
   3.871656838048584*^9}, {3.871723252255631*^9, 3.87172330618465*^9}, {
   3.871723368744816*^9, 3.8717233708461018`*^9}, {3.871723403876904*^9, 
   3.871723418638175*^9}, {3.871723452050496*^9, 3.8717234794605923`*^9}, {
   3.8717235153647947`*^9, 3.8717235273024883`*^9}, {3.871723568627376*^9, 
   3.871723699624754*^9}, {3.87172381357052*^9, 3.87172381860956*^9}, {
   3.8717240831021137`*^9, 3.871724086306926*^9}, {3.871724195147251*^9, 
   3.871724208376506*^9}, {3.8717242407584047`*^9, 3.8717242408470697`*^9}, {
   3.874653608988855*^9, 3.8746536224236097`*^9}, {3.874653819006281*^9, 
   3.874653819356104*^9}, {3.874656223776025*^9, 3.874656223815488*^9}, {
   3.874656295715208*^9, 3.874656402608629*^9}, {3.874656440349104*^9, 
   3.874656572592791*^9}, {3.874656609818873*^9, 3.8746566425194397`*^9}, {
   3.874656694092784*^9, 3.874656715524778*^9}, {3.874656798288019*^9, 
   3.874656823937088*^9}, {3.87465744488347*^9, 3.874657647000815*^9}, {
   3.874657680949976*^9, 3.874657699336505*^9}, {3.874657753773608*^9, 
   3.87465776298275*^9}, {3.874657813208305*^9, 3.874657923795067*^9}, {
   3.874657964970948*^9, 3.874658264161584*^9}, {3.874658399472246*^9, 
   3.874658485464324*^9}, {3.874658586322054*^9, 3.874658588207885*^9}, {
   3.874658642058033*^9, 3.8746586458466167`*^9}, {3.874658977019911*^9, 
   3.87465902586021*^9}, {3.874659614617816*^9, 3.874659638108917*^9}, 
   3.874660100685183*^9, {3.874660136960651*^9, 3.874660156376313*^9}, {
   3.874660202046351*^9, 3.8746602060779448`*^9}, 3.874660244337487*^9, {
   3.8746602754633923`*^9, 3.8746602788038387`*^9}, {3.874660315009788*^9, 
   3.8746603384975033`*^9}, {3.8746603806623983`*^9, 3.874660382697329*^9}, {
   3.874660416512389*^9, 3.8746604174496593`*^9}, {3.874660556333646*^9, 
   3.8746605564050903`*^9}, 3.874660623379468*^9, {3.874660884075548*^9, 
   3.874660909588764*^9}, {3.874660988103013*^9, 3.874661000250812*^9}, {
   3.874661041981708*^9, 3.874661169784615*^9}, {3.8746612384757843`*^9, 
   3.874661252354594*^9}, {3.874662731533606*^9, 3.8746627401137333`*^9}, {
   3.874662806785102*^9, 3.874662887616138*^9}, 3.874663180131909*^9, {
   3.874665270157522*^9, 3.874665272029331*^9}, {3.874665403702319*^9, 
   3.874665408940789*^9}, 3.874665578924182*^9, {3.874666239096244*^9, 
   3.874666288557488*^9}, 3.874666368869742*^9, {3.874666594436098*^9, 
   3.874666620114587*^9}, 3.874666680040916*^9, {3.8746667332104053`*^9, 
   3.874666752817154*^9}, {3.874667041021675*^9, 3.874667077197432*^9}, {
   3.8746671141401997`*^9, 3.874667127565909*^9}, 3.874667167474328*^9, {
   3.87466747142339*^9, 3.874667485330379*^9}, {3.874667641858041*^9, 
   3.874667676770928*^9}, {3.874667717478533*^9, 3.874667724371612*^9}, {
   3.8746682714630013`*^9, 3.8746682750540037`*^9}, {3.874668372769786*^9, 
   3.8746685685595016`*^9}, {3.874668602144834*^9, 3.87466864005254*^9}, {
   3.874668693622449*^9, 3.874668706467822*^9}, {3.874668762492908*^9, 
   3.87466885218329*^9}, {3.874668981511828*^9, 3.874668981595723*^9}, {
   3.874669014306201*^9, 3.874669014439859*^9}, {3.874669112451709*^9, 
   3.874669112952528*^9}, {3.874669454523696*^9, 3.874669464163872*^9}, {
   3.874669657488752*^9, 3.874669746562257*^9}, {3.874669825166937*^9, 
   3.874669828163134*^9}, {3.874669904013851*^9, 3.874669939821473*^9}, {
   3.8746700296128283`*^9, 3.874670052359025*^9}, 3.8746701664569798`*^9, 
   3.874670636226892*^9, 3.8746707767442427`*^9, 3.874671956379221*^9, {
   3.874673288923458*^9, 3.874673296729814*^9}, {3.874673396165552*^9, 
   3.874673408501792*^9}, {3.8746734502657137`*^9, 3.874673462446018*^9}, {
   3.874673504866097*^9, 3.874673526260214*^9}, {3.874735753114903*^9, 
   3.874735782107926*^9}, {3.874735823668582*^9, 3.87473582616887*^9}, {
   3.874736459568882*^9, 3.8747365875873938`*^9}, {3.874737032472642*^9, 
   3.874737051369328*^9}, {3.8747371119433823`*^9, 3.874737213795184*^9}, {
   3.874737275702345*^9, 3.874737312174202*^9}, {3.874737359224092*^9, 
   3.8747373604727907`*^9}, {3.8747374710582523`*^9, 3.874737471063385*^9}, {
   3.8747376579251633`*^9, 3.874737663490814*^9}, {3.874737703554388*^9, 
   3.874737705938857*^9}, {3.874738089342677*^9, 3.874738091428052*^9}, {
   3.874738932112636*^9, 3.874739007544132*^9}, {3.874739075737096*^9, 
   3.8747390886377296`*^9}, {3.874739128633902*^9, 3.874739129784589*^9}, {
   3.874749847336335*^9, 3.874749854507165*^9}, {3.874750838157857*^9, 
   3.874750842486703*^9}, {3.874751847416658*^9, 3.874751847754833*^9}, {
   3.874751985153384*^9, 3.874752008612981*^9}, {3.874752182547913*^9, 
   3.874752243726248*^9}, {3.874752311673863*^9, 3.874752312757959*^9}, {
   3.8747529814931707`*^9, 3.8747530406973143`*^9}, 3.875341626542416*^9, {
   3.875341699591031*^9, 3.87534172168688*^9}, {3.8753417993137493`*^9, 
   3.875341865020362*^9}, {3.8753418975518436`*^9, 3.875342000614449*^9}, {
   3.8753420525683603`*^9, 3.8753420644998217`*^9}, {3.875342099874331*^9, 
   3.87534215910135*^9}, {3.8753431171506357`*^9, 3.875343217399624*^9}, {
   3.8753432475936623`*^9, 3.875343273155046*^9}, {3.875347712668627*^9, 
   3.875347740316169*^9}, 3.875349121972147*^9, {3.8759510099079533`*^9, 
   3.875951018202527*^9}, {3.875951069918803*^9, 3.8759513559348803`*^9}, {
   3.875951388151434*^9, 3.87595141234654*^9}, {3.875951742316605*^9, 
   3.875951767523027*^9}, {3.875951837275421*^9, 3.875951847520054*^9}, {
   3.875952337768826*^9, 3.875952362571204*^9}, {3.875952404048428*^9, 
   3.8759524355474243`*^9}, 3.8759525569815598`*^9, {3.875952634017743*^9, 
   3.875952638104514*^9}, {3.875953093193665*^9, 3.875953114958054*^9}, 
   3.875953211603435*^9, 3.875953401825643*^9, 3.87595361321632*^9, 
   3.877712927314435*^9, {3.877850267011085*^9, 3.877850281742221*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"fd22b8eb-6822-4767-a07f-beac3dc16957"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"SUPERARRAYNAME", "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"SUPERARRAYNAME", ",", 
         RowBox[{"{", "\"\<BELIEF\>\"", "}"}]}], "]"}], "//", 
       "DeleteDuplicates"}], ")"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ArraysNamesSimRewardDriven", "=", 
     RowBox[{"{", 
      RowBox[{"\"\<BiasAffPair\>\"", ",", "\"\<BeliefFinal\>\""}], "}"}]}], 
    ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ConstNamesSimRewardDriven", "=", 
     RowBox[{"{", "\"\<PredictivePower\>\"", "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"VarNamesSimRewardDriven", "=", 
      RowBox[{"{", 
       RowBox[{
       "\"\<beliefin\[Alpha]\>\"", ",", "\"\<affinity\>\"", ",", 
        "\"\<bias\>\"", ",", "\"\<randomwalkh\>\""}], "}"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.877707573486567*^9, 3.8777076476832027`*^9}, {
   3.877708077385975*^9, 3.8777081057959833`*^9}, {3.877709504342486*^9, 
   3.877709510404622*^9}, {3.87771021014487*^9, 3.877710215403961*^9}, {
   3.8777103449539127`*^9, 3.877710360593885*^9}, {3.877711617458892*^9, 
   3.877711618190077*^9}, {3.8777119719469213`*^9, 3.877711972048181*^9}, {
   3.8777128183621902`*^9, 3.877712819935842*^9}, 3.877713520166073*^9, 
   3.8777234357403517`*^9, 3.877726060554624*^9, {3.877727935526102*^9, 
   3.877727962511999*^9}, {3.884677785480937*^9, 3.884677842445716*^9}, {
   3.884677891478489*^9, 3.884677891710845*^9}, {3.884678097887521*^9, 
   3.884678118134693*^9}, {3.884678325103793*^9, 3.8846783314102507`*^9}, 
   3.8846786806155367`*^9, {3.8846787906844187`*^9, 3.88467881663066*^9}, 
   3.885737371859435*^9},ExpressionUUID->"d08e6131-19ed-4575-a884-\
98208b0349f4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "measurements", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"UserMeasure", "[", "]"}], ":=", 
    RowBox[{
     RowBox[{"RandomReal", "[", "]"}], "//", 
     RowBox[{
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"#", "<", "ProbabilityPlus"}], ",", "1", ",", "True", ",", 
        RowBox[{"-", "1"}]}], "]"}], "&"}]}]}], 
   RowBox[{"(*", 
    RowBox[{
    "simple", " ", "yes", " ", "or", " ", "no", " ", "answer", " ", "with", 
     " ", "equal", " ", "probability"}], "*)"}], "\n", 
   RowBox[{"(*", "forecasts", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"predictivepower2", "[", 
     RowBox[{"xrandom_", ",", "meas_"}], "]"}], ":=", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{"meas", "\[Equal]", "1"}], ",", 
      RowBox[{"1", "-", 
       RowBox[{"xrandom", "^", "6"}]}], ",", 
      RowBox[{"meas", "\[Equal]", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{"xrandom", "^", "6"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"predictivepower1", "[", 
     RowBox[{"xrandom_", ",", "meas_"}], "]"}], ":=", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{"meas", "\[Equal]", "1"}], ",", 
      RowBox[{"1", "-", 
       RowBox[{"xrandom", "^", "2"}]}], ",", 
      RowBox[{"meas", "\[Equal]", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{"xrandom", "^", "2"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"predictivepower0", "[", 
     RowBox[{"xrandom_", ",", "meas_"}], "]"}], ":=", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{"meas", "\[Equal]", "1"}], ",", 
      RowBox[{"1", "-", "xrandom"}], ",", 
      RowBox[{"meas", "\[Equal]", 
       RowBox[{"-", "1"}]}], ",", "xrandom"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"predictivepowerm1", "[", 
     RowBox[{"xrandom_", ",", "meas_"}], "]"}], ":=", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{"meas", "\[Equal]", "1"}], ",", 
      RowBox[{"xrandom", "^", 
       RowBox[{"(", "2", ")"}]}], " ", ",", 
      RowBox[{"meas", "\[Equal]", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{"1", "-", 
       RowBox[{"xrandom", "^", 
        RowBox[{"(", "2", ")"}]}]}]}], " ", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"predictivepowerm2", "[", 
     RowBox[{"xrandom_", ",", "meas_"}], "]"}], ":=", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{"meas", "\[Equal]", "1"}], ",", 
      RowBox[{"xrandom", "^", 
       RowBox[{"(", "6", ")"}]}], " ", ",", 
      RowBox[{"meas", "\[Equal]", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{"1", "-", 
       RowBox[{"xrandom", "^", 
        RowBox[{"(", "6", ")"}]}]}]}], " ", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"predictivepowerOLD", "[", 
     RowBox[{"xrandom_", ",", "meas_", ",", "g_"}], "]"}], ":=", 
    RowBox[{"Which", "[", 
     RowBox[{"(*", 
      RowBox[{"should", " ", "correspond", " ", "to", " ", "p", 
       RowBox[{"(", 
        RowBox[{"\[Nu]", ",", "di"}], ")"}], " ", "in", " ", "Eq", " ", 
       "17"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"g", "\[Equal]", "2"}], ",", 
      RowBox[{"predictivepower2", "[", 
       RowBox[{"xrandom", ",", "meas"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"g", "\[Equal]", "1"}], ",", 
      RowBox[{"predictivepower1", "[", 
       RowBox[{"xrandom", ",", "meas"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"g", "\[Equal]", "0"}], ",", 
      RowBox[{"predictivepower0", "[", 
       RowBox[{"xrandom", ",", "meas"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"g", "\[Equal]", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{"predictivepowerm1", "[", 
       RowBox[{"xrandom", ",", "meas"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"g", "\[Equal]", 
       RowBox[{"-", "2"}]}], ",", 
      RowBox[{"predictivepowerm2", "[", 
       RowBox[{"xrandom", ",", "meas"}], "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Unprotect", "[", "INFOPREDICTIVEPOWER", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"INFOPREDICTIVEPOWER", "=", "\"\<\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Protect", "[", "INFOPREDICTIVEPOWER", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BuildPredictivePowerFunction", "[", 
     RowBox[{
      RowBox[{"dmax_", ":", "4"}], ",", 
      RowBox[{"dsteps_", ":", "8"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "forecastavgMAX", ",", "forecastavgNeutral", ",", 
        "\[IndentingNewLine]", "dValues", ",", "\[Nu]Values", ",", 
        "\[IndentingNewLine]", "predictivepowerPositived", ",", 
        "\[IndentingNewLine]", "predictivepowerNegatived", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"info", "=", "\"\<\>\""}]}], "\[IndentingNewLine]", "}"}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "power", " ", "for", " ", "best", " ", "predictive", " ", "power", 
         " ", "1"}], "-", 
        RowBox[{"x", "^", "\[Nu]"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"forecastavgMAX", "=", 
        RowBox[{
         FractionBox["\[Nu]", 
          RowBox[{"1", "+", "\[Nu]"}]], "/.", 
         RowBox[{"\[Nu]", "\[Rule]", "21"}]}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"2", "\[Sigma]"}], "*)"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"forecastavgMAX", "=", 
          RowBox[{
           FractionBox["\[Nu]", 
            RowBox[{"1", "+", "\[Nu]"}]], "/.", 
           RowBox[{"\[Nu]", "\[Rule]", "6"}]}]}], ";"}], 
        RowBox[{"(*", "OLD", "*)"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "power", " ", "for", " ", "neutral", " ", "predictive", " ", "power",
           " ", "1"}], "-", 
         RowBox[{"x", "^", "\[Nu]"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"forecastavgNeutral", "=", 
        RowBox[{
         FractionBox["\[Nu]", 
          RowBox[{"1", "+", "\[Nu]"}]], "/.", 
         RowBox[{"\[Nu]", "\[Rule]", "1"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "value", " ", "of", " ", "d", " ", "assigned", " ", "to", " ", "best",
          " ", "predictive", " ", "power"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"dMAX", "=", "dmax"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"number", " ", "of", " ", "steps", " ", "for", " ", "d"}], 
         ",", " ", 
         RowBox[{
         "between", " ", "worst", " ", "and", " ", "best", " ", "predictive", 
          " ", "power"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"dSTEPS", "=", "dsteps"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "size", " ", "of", " ", "step", " ", "for", " ", "random", " ", 
         "walk", " ", "and", " ", "affinity", " ", "updating"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"dSTEPSIZE", "=", 
        RowBox[{"2", " ", 
         RowBox[{"dmax", "/", "dsteps"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Nu]Values", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          FractionBox["avg", 
           RowBox[{"1", "-", "avg"}]], ",", 
          RowBox[{"{", 
           RowBox[{"avg", ",", 
            RowBox[{"Range", "[", 
             RowBox[{"forecastavgNeutral", ",", "forecastavgMAX", ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"forecastavgMAX", "-", "forecastavgNeutral"}], ")"}], 
               "/", 
               RowBox[{"(", 
                RowBox[{"dsteps", "/", "2"}], ")"}]}]}], "]"}]}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<\[Nu] values = \>\"", ",", 
         RowBox[{"\[Nu]Values", "//", "N"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dValues", "=", 
        RowBox[{"Range", "[", 
         RowBox[{"0", ",", "dmax", ",", 
          RowBox[{"dmax", "/", 
           RowBox[{"(", 
            RowBox[{"dsteps", "/", "2"}], ")"}]}]}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "d", " ", "values", " ", "always", " ", "symmetric", " ", "d"}], "=", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"-", "a"}], ",", "...", ",", "0", ",", "...", ",", "a"}], 
          "]"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"dValues", "=", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"dValues", "[", 
             RowBox[{"[", 
              RowBox[{"2", ";;", 
               RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", "dValues"}], "]"}], 
         "//", "Sort"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       
       RowBox[{"predictivepowerPositived", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ToString", "[", 
            RowBox[{"dValues", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"dsteps", "/", "2"}], "+", "i"}], "]"}], "]"}], "]"}], 
           "<>", "\"\<->(1-#^(\>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{
             RowBox[{"\[Nu]Values", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "//", "N"}], "]"}], "<>", 
           "\"\<)&)\>\""}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"\[Nu]Values", "//", "Length"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"predictivepowerNegatived", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ToString", "[", 
            RowBox[{"dValues", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "<>", "\"\<->(#^(\>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Nu]Values", "//", 
                 RowBox[{
                  RowBox[{"Drop", "[", 
                   RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "//", "Reverse"}],
                ")"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "//", "N"}], "]"}], "<>", 
           "\"\<)&)\>\""}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"dsteps", "/", "2"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"predictivepowerd", "=", 
        RowBox[{"Association", "@@", 
         RowBox[{"ToExpression", "/@", 
          RowBox[{"Join", "[", 
           RowBox[{
           "predictivepowerNegatived", ",", "predictivepowerPositived"}], 
           "]"}]}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"for", " ", "info", " ", "files"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"info", "=", 
        RowBox[{
        "info", "<>", 
         "\"\<######## predictive power function genereted by calling: \>\"", 
         "<>", "\"\<'BuildPredictivePowerFunction[\>\"", "<>", 
         RowBox[{"ToString", "[", "dmax", "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"ToString", "[", "dsteps", "]"}], "<>", "\"\<]'\\n\>\""}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"info", "=", 
        RowBox[{"info", "<>", "\"\<dMAX = \>\"", "<>", 
         RowBox[{"ToString", "[", "dMAX", "]"}], "<>", "\"\<\\n\>\""}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"info", "=", 
        RowBox[{"info", "<>", "\"\<dSTEPS = \>\"", "<>", 
         RowBox[{"ToString", "[", "dSTEPS", "]"}], "<>", "\"\<\\n\>\""}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"info", "=", 
        RowBox[{"info", "<>", "\"\<dSTEPSIZE = \>\"", "<>", 
         RowBox[{"ToString", "[", "dSTEPSIZE", "]"}], "<>", "\"\<\\n\>\""}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"info", "=", 
        RowBox[{"info", "<>", "\"\<forecastavgMAX = \>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"forecastavgMAX", "//", "N"}], "]"}], "<>", 
         "\"\<\\n\>\""}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"info", "=", 
        RowBox[{"info", "<>", "\"\<PowerValues = \>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"\[Nu]Values", "//", "N"}], "]"}], "<>", "\"\<\\n\>\""}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"info", "=", 
        RowBox[{"info", "<>", "\"\<forecastavg = \>\"", "<>", 
         RowBox[{"ToString", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Join", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"Range", "[", 
                  RowBox[{"forecastavgNeutral", ",", "forecastavgMAX", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"forecastavgMAX", "-", "forecastavgNeutral"}], 
                    ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"dsteps", "/", "2"}], ")"}]}]}], "]"}]}], ")"}], "//",
                "Reverse"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Range", "[", 
               RowBox[{"forecastavgNeutral", ",", "forecastavgMAX", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"forecastavgMAX", "-", "forecastavgNeutral"}], 
                  ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{"dsteps", "/", "2"}], ")"}]}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}], "//", "DeleteDuplicates"}], "//", 
           "N"}], "\[IndentingNewLine]", "]"}], "<>", "\"\<\\n\>\""}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Unprotect", "[", "INFOPREDICTIVEPOWER", "]"}], ";", 
       RowBox[{"INFOPREDICTIVEPOWER", "=", "info"}], ";", 
       RowBox[{"Protect", "[", "INFOPREDICTIVEPOWER", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"predictivepower", "[", 
     RowBox[{"xrandom_", ",", "meas_", ",", "d_"}], "]"}], ":=", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{"meas", "\[Equal]", "1"}], ",", 
      RowBox[{
       RowBox[{"predictivepowerd", "[", "d", "]"}], "[", "xrandom", "]"}], 
      ",", 
      RowBox[{"meas", "\[Equal]", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"predictivepowerd", "[", "d", "]"}], "[", "xrandom", 
        "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"BuildPredictivePowerFunction", "[", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.87024601336097*^9, 3.8702460269838047`*^9}, 
   3.870247562398513*^9, {3.870247901290688*^9, 3.870247913545789*^9}, {
   3.870248171112443*^9, 3.8702481805348454`*^9}, {3.870248393626191*^9, 
   3.8702484198548927`*^9}, {3.870249617559556*^9, 3.870249619120874*^9}, {
   3.870249891315257*^9, 3.8702499010453577`*^9}, {3.87024993698578*^9, 
   3.870249939191617*^9}, {3.8702506005986147`*^9, 3.8702507616549807`*^9}, {
   3.870250798743535*^9, 3.8702508045200787`*^9}, {3.870250891437058*^9, 
   3.870251027231915*^9}, {3.87025108250043*^9, 3.8702512212537107`*^9}, {
   3.8702513015979652`*^9, 3.870251336611343*^9}, {3.8702513693895407`*^9, 
   3.8702513869135017`*^9}, {3.8702515131913853`*^9, 
   3.8702515134078693`*^9}, {3.870251648614447*^9, 3.8702516874558353`*^9}, {
   3.870251720617352*^9, 3.8702517311062937`*^9}, {3.870251770035828*^9, 
   3.870251814306525*^9}, {3.870251850451576*^9, 3.870251861056651*^9}, {
   3.8702518930491457`*^9, 3.8702518991355*^9}, {3.870251946430917*^9, 
   3.870252018531983*^9}, {3.870252084932032*^9, 3.870252094300758*^9}, {
   3.870252555472765*^9, 3.8702525779917316`*^9}, {3.870252707123612*^9, 
   3.8702527379141912`*^9}, 3.870255799997542*^9, {3.87154036875607*^9, 
   3.871540416023946*^9}, {3.871540517014429*^9, 3.87154063506811*^9}, {
   3.87154071257174*^9, 3.8715407963416643`*^9}, {3.871540862834383*^9, 
   3.8715409126358547`*^9}, {3.8715410114674377`*^9, 3.871541020238207*^9}, 
   3.871541063284964*^9, {3.8715413046748962`*^9, 3.871541308832623*^9}, {
   3.871541543171513*^9, 3.87154154458173*^9}, {3.871541612962653*^9, 
   3.871541675846324*^9}, {3.871542679093449*^9, 3.8715427133999643`*^9}, {
   3.8715427800836763`*^9, 3.8715428192208242`*^9}, {3.871542850834771*^9, 
   3.871542870510728*^9}, {3.871544067233506*^9, 3.871544105809017*^9}, {
   3.8715441387924128`*^9, 3.871544224865347*^9}, {3.8715442624598007`*^9, 
   3.8715442635591497`*^9}, {3.871544321834899*^9, 3.871544324848575*^9}, 
   3.871544403438064*^9, {3.8715444677263412`*^9, 3.871544481004189*^9}, {
   3.871544527891453*^9, 3.871544580101633*^9}, {3.871544628012183*^9, 
   3.8715446483241177`*^9}, 3.8715517316934023`*^9, {3.8715522886629047`*^9, 
   3.871552288872658*^9}, {3.871552334403838*^9, 3.8715523346289062`*^9}, {
   3.8715528021646833`*^9, 3.87155280228822*^9}, {3.871552978852976*^9, 
   3.871552978913268*^9}, {3.871553016671008*^9, 3.871553018817437*^9}, 
   3.871553095793416*^9, {3.87155344044904*^9, 3.8715534935511303`*^9}, {
   3.87155352658245*^9, 3.8715535329892282`*^9}, {3.871553579343412*^9, 
   3.871553581313673*^9}, {3.871553958458755*^9, 3.8715539601506977`*^9}, {
   3.871558828086731*^9, 3.871558833848982*^9}, {3.871558906187265*^9, 
   3.871558987682918*^9}, 3.871559316760728*^9, {3.871559699941874*^9, 
   3.87155972602384*^9}, {3.871559759032323*^9, 3.871559764897707*^9}, {
   3.871559936681774*^9, 3.8715599530424633`*^9}, {3.871565073485072*^9, 
   3.871565100636739*^9}, {3.871565130853056*^9, 3.871565145649899*^9}, {
   3.871565529030569*^9, 3.8715655292252417`*^9}, {3.871565773157311*^9, 
   3.871565795180543*^9}, {3.8715661046802597`*^9, 3.87156618194703*^9}, {
   3.871574703968054*^9, 3.871574708693071*^9}, {3.8715757688688374`*^9, 
   3.8715757791461077`*^9}, {3.87157711188148*^9, 3.871577118781273*^9}, {
   3.871578716803144*^9, 3.8715787176352158`*^9}, {3.871579499556983*^9, 
   3.871579510977072*^9}, {3.871579593597062*^9, 3.871579612561151*^9}, {
   3.8715796447265863`*^9, 3.871579663109097*^9}, {3.8715797400827703`*^9, 
   3.87157985138531*^9}, {3.871579978237791*^9, 3.871579984805667*^9}, {
   3.871580718939529*^9, 3.871580725219192*^9}, {3.871581815307456*^9, 
   3.871581821065613*^9}, {3.871581925139412*^9, 3.871581941963879*^9}, {
   3.871656418980259*^9, 3.871656419524384*^9}, 3.871656449666934*^9, {
   3.871656534210606*^9, 3.871656552996997*^9}, {3.871656628255406*^9, 
   3.871656637796645*^9}, {3.871656680266336*^9, 3.871656683113514*^9}, {
   3.8716567799153357`*^9, 3.871656779997355*^9}, {3.871656837809424*^9, 
   3.871656838048584*^9}, {3.871723252255631*^9, 3.87172330618465*^9}, {
   3.871723368744816*^9, 3.8717233708461018`*^9}, {3.871723403876904*^9, 
   3.871723418638175*^9}, {3.871723452050496*^9, 3.8717234794605923`*^9}, {
   3.8717235153647947`*^9, 3.8717235273024883`*^9}, {3.871723568627376*^9, 
   3.871723699624754*^9}, {3.87172381357052*^9, 3.87172381860956*^9}, {
   3.8717240831021137`*^9, 3.871724086306926*^9}, {3.871724195147251*^9, 
   3.871724208376506*^9}, {3.8717242407584047`*^9, 3.8717242408470697`*^9}, {
   3.874653608988855*^9, 3.8746536224236097`*^9}, {3.874653819006281*^9, 
   3.874653819356104*^9}, {3.874656223776025*^9, 3.874656223815488*^9}, {
   3.874656295715208*^9, 3.874656402608629*^9}, {3.874656440349104*^9, 
   3.874656572592791*^9}, {3.874656609818873*^9, 3.8746566425194397`*^9}, {
   3.874656694092784*^9, 3.874656715524778*^9}, {3.874656798288019*^9, 
   3.874656823937088*^9}, {3.87465744488347*^9, 3.874657647000815*^9}, {
   3.874657680949976*^9, 3.874657699336505*^9}, {3.874657753773608*^9, 
   3.87465776298275*^9}, {3.874657813208305*^9, 3.874657923795067*^9}, {
   3.874657964970948*^9, 3.874658264161584*^9}, {3.874658399472246*^9, 
   3.874658485464324*^9}, {3.874658586322054*^9, 3.874658588207885*^9}, {
   3.874658642058033*^9, 3.8746586458466167`*^9}, {3.874658977019911*^9, 
   3.87465902586021*^9}, {3.874659614617816*^9, 3.874659638108917*^9}, 
   3.874660100685183*^9, {3.874660136960651*^9, 3.874660156376313*^9}, {
   3.874660202046351*^9, 3.8746602060779448`*^9}, 3.874660244337487*^9, {
   3.8746602754633923`*^9, 3.8746602788038387`*^9}, {3.874660315009788*^9, 
   3.8746603384975033`*^9}, {3.8746603806623983`*^9, 3.874660382697329*^9}, {
   3.874660416512389*^9, 3.8746604174496593`*^9}, {3.874660556333646*^9, 
   3.8746605564050903`*^9}, 3.874660623379468*^9, {3.874660884075548*^9, 
   3.874660909588764*^9}, {3.874660988103013*^9, 3.874661000250812*^9}, {
   3.874661041981708*^9, 3.874661169784615*^9}, {3.8746612384757843`*^9, 
   3.874661252354594*^9}, {3.874662731533606*^9, 3.8746627401137333`*^9}, {
   3.874662806785102*^9, 3.874662887616138*^9}, 3.874663180131909*^9, {
   3.874665270157522*^9, 3.874665272029331*^9}, {3.874665403702319*^9, 
   3.874665408940789*^9}, 3.874665578924182*^9, {3.874666239096244*^9, 
   3.874666288557488*^9}, 3.874666368869742*^9, {3.874666594436098*^9, 
   3.874666620114587*^9}, 3.874666680040916*^9, {3.8746667332104053`*^9, 
   3.874666752817154*^9}, {3.874667041021675*^9, 3.874667077197432*^9}, {
   3.8746671141401997`*^9, 3.874667127565909*^9}, 3.874667167474328*^9, {
   3.87466747142339*^9, 3.874667485330379*^9}, {3.874667641858041*^9, 
   3.874667676770928*^9}, {3.874667717478533*^9, 3.874667724371612*^9}, {
   3.8746682714630013`*^9, 3.8746682750540037`*^9}, {3.874668372769786*^9, 
   3.8746685685595016`*^9}, {3.874668602144834*^9, 3.87466864005254*^9}, {
   3.874668693622449*^9, 3.874668706467822*^9}, {3.874668762492908*^9, 
   3.87466885218329*^9}, {3.874668981511828*^9, 3.874668981595723*^9}, {
   3.874669014306201*^9, 3.874669014439859*^9}, {3.874669112451709*^9, 
   3.874669112952528*^9}, {3.874669454523696*^9, 3.874669464163872*^9}, {
   3.874669657488752*^9, 3.874669746562257*^9}, {3.874669825166937*^9, 
   3.874669828163134*^9}, {3.874669904013851*^9, 3.874669939821473*^9}, {
   3.8746700296128283`*^9, 3.874670052359025*^9}, 3.8746701664569798`*^9, 
   3.874670636226892*^9, 3.8746707767442427`*^9, 3.874671956379221*^9, {
   3.874673288923458*^9, 3.874673296729814*^9}, {3.874673396165552*^9, 
   3.874673408501792*^9}, {3.8746734502657137`*^9, 3.874673462446018*^9}, {
   3.874673504866097*^9, 3.874673526260214*^9}, {3.874735753114903*^9, 
   3.874735782107926*^9}, {3.874735823668582*^9, 3.87473582616887*^9}, {
   3.874736459568882*^9, 3.8747365875873938`*^9}, {3.874737032472642*^9, 
   3.874737051369328*^9}, {3.8747371119433823`*^9, 3.874737213795184*^9}, {
   3.874737275702345*^9, 3.874737312174202*^9}, {3.874737359224092*^9, 
   3.8747373604727907`*^9}, {3.8747374710582523`*^9, 3.874737471063385*^9}, {
   3.8747376579251633`*^9, 3.874737663490814*^9}, {3.874737703554388*^9, 
   3.874737705938857*^9}, {3.874738089342677*^9, 3.874738091428052*^9}, {
   3.874738932112636*^9, 3.874739007544132*^9}, {3.874739075737096*^9, 
   3.8747390886377296`*^9}, {3.874739128633902*^9, 3.874739129784589*^9}, {
   3.874749847336335*^9, 3.874749854507165*^9}, {3.874750838157857*^9, 
   3.874750842486703*^9}, {3.874751847416658*^9, 3.874751847754833*^9}, {
   3.874751985153384*^9, 3.874752008612981*^9}, {3.874752182547913*^9, 
   3.874752243726248*^9}, {3.874752311673863*^9, 3.874752312757959*^9}, {
   3.8747529814931707`*^9, 3.8747530406973143`*^9}, 3.875341626542416*^9, {
   3.875341699591031*^9, 3.87534172168688*^9}, {3.8753417993137493`*^9, 
   3.875341865020362*^9}, {3.8753418975518436`*^9, 3.875342000614449*^9}, {
   3.8753420525683603`*^9, 3.8753420644998217`*^9}, {3.875342099874331*^9, 
   3.87534215910135*^9}, {3.8753431171506357`*^9, 3.875343217399624*^9}, {
   3.8753432475936623`*^9, 3.875343273155046*^9}, {3.875347712668627*^9, 
   3.875347740316169*^9}, 3.875349121972147*^9, {3.8759510099079533`*^9, 
   3.875951018202527*^9}, {3.875951069918803*^9, 3.8759513559348803`*^9}, {
   3.875951388151434*^9, 3.87595141234654*^9}, {3.875951742316605*^9, 
   3.875951767523027*^9}, {3.875951837275421*^9, 3.875951847520054*^9}, {
   3.875952337768826*^9, 3.875952362571204*^9}, {3.875952404048428*^9, 
   3.8759524355474243`*^9}, 3.8759525569815598`*^9, {3.875952634017743*^9, 
   3.875952638104514*^9}, {3.875953093193665*^9, 3.875953114958054*^9}, 
   3.875953211603435*^9, 3.875953401825643*^9, 3.87595361321632*^9, {
   3.875953689465814*^9, 3.875953696481566*^9}, {3.875954503504472*^9, 
   3.8759545039614563`*^9}, {3.876048992963522*^9, 3.8760490342983103`*^9}, {
   3.876049065388258*^9, 3.876049132224235*^9}, {3.8760494304352913`*^9, 
   3.876049431547501*^9}, 3.876049598992975*^9, {3.876049876353279*^9, 
   3.8760498981672087`*^9}, 3.876050684011739*^9, 3.8763214172930317`*^9, 
   3.877707173577853*^9, 3.8777133121370077`*^9, 3.877713482095889*^9, {
   3.879831224793275*^9, 3.879831231443626*^9}, {3.87983127305737*^9, 
   3.879831284367728*^9}, {3.8798313160257053`*^9, 3.879831443785882*^9}, {
   3.879831489486261*^9, 3.879831497879099*^9}, 3.87983160646229*^9, {
   3.879831674674492*^9, 3.8798316747958803`*^9}, {3.8798317087048063`*^9, 
   3.879831713218732*^9}, {3.8798317671852493`*^9, 3.879831780550013*^9}, {
   3.879831838357667*^9, 3.879831962793264*^9}, {3.879832508491744*^9, 
   3.8798326108335457`*^9}, {3.879833122001837*^9, 3.8798331411317453`*^9}, {
   3.8798331739146757`*^9, 3.879833174835918*^9}, {3.8798334103775673`*^9, 
   3.8798334144002934`*^9}, {3.879835553772462*^9, 3.87983555956219*^9}, {
   3.879836356272341*^9, 3.8798363566446877`*^9}, 3.882688180327549*^9, {
   3.882688243048278*^9, 3.882688257957095*^9}, {3.8826883920220413`*^9, 
   3.882688435370616*^9}, {3.883218200630148*^9, 3.8832182089415197`*^9}, {
   3.883218255205328*^9, 3.883218273853489*^9}, {3.884776507653648*^9, 
   3.88477656051115*^9}, {3.88477660351163*^9, 3.884776630997512*^9}, {
   3.8847766702491293`*^9, 3.884776714811665*^9}, {3.884776774210761*^9, 
   3.88477686796642*^9}, {3.884776935476158*^9, 3.884776971955702*^9}, {
   3.884777019588121*^9, 3.884777172245179*^9}, {3.884777360976521*^9, 
   3.884777378057954*^9}, {3.884777411053705*^9, 3.88477742501458*^9}, {
   3.884777496633535*^9, 3.8847775019345407`*^9}, {3.8847775651822863`*^9, 
   3.884777583498176*^9}},ExpressionUUID->"8821a4b3-16af-4fa8-a5c6-\
9aa295b2d444"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "2.`"}], "\[Rule]", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["#1", "6.`"], "&"}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1.`"}], "\[Rule]", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["#1", "2.11111`"], "&"}], ")"}]}], ",", 
   RowBox[{"0.`", "\[Rule]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"1", "-", 
       SuperscriptBox["#1", "1.`"]}], "&"}], ")"}]}], ",", 
   RowBox[{"1.`", "\[Rule]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"1", "-", 
       SuperscriptBox["#1", "2.11111`"]}], "&"}], ")"}]}], ",", 
   RowBox[{"2.`", "\[Rule]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"1", "-", 
       SuperscriptBox["#1", "6.`"]}], "&"}], ")"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.879833181568221*^9},
 CellLabel->
  "Out[120]=",ExpressionUUID->"aa65b087-f01c-48b2-b229-c5def1e4df8d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Random", " ", "walk", " ", "update", " ", "of", " ", "belief", " ", 
    "according", " ", "to", " ", "draft"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"RandomWalk", "[", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rewards", ",", "maxreward", ",", "avgrewards", ",", "leadingexpert", 
       ",", 
       RowBox[{"stepplus", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"stepminus", "=", 
        RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RandomSeed", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"stepplus", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Which", "[", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"if", " ", "\[Nu]1"}], "<", "h"}], ",", " ", 
            RowBox[{
            "proceed", " ", "with", " ", "random", " ", "walk", " ", 
             "upwards"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Random", "[", "]"}], "<=", 
            RowBox[{"randomwalkh", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", "dSTEPSIZE", ",", 
           "\[IndentingNewLine]", "True", ",", "0"}], "\[IndentingNewLine]", 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"beliefin\[Alpha]", "//", "Length"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"stepminus", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Which", "[", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"if", " ", "\[Nu]2"}], "<", "h"}], ",", " ", 
            RowBox[{
            "proceed", " ", "with", " ", "random", " ", "walk", " ", 
             "downwards"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Random", "[", "]"}], "<=", 
            RowBox[{"randomwalkh", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{"-", "dSTEPSIZE"}], ",", "\[IndentingNewLine]", "True", 
           ",", "0"}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"beliefin\[Alpha]", "//", "Length"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "update", " ", "d_i", " ", "according", " ", "to", " ", "random", " ", 
        "walk"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"beliefin\[Alpha]", "=", 
       RowBox[{"beliefin\[Alpha]", "+", "stepplus", "+", "stepminus"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"make", " ", "sure", " ", "that"}], "  ", "-", "2"}], " ", 
         "\[LessEqual]", " ", "d_i", " ", "\[LessEqual]", " ", "2"}], ",", 
        " ", 
        RowBox[{"if", " ", "not"}], ",", " ", 
        RowBox[{
         RowBox[{
         "force", " ", "out", " ", "of", " ", "bounds", " ", "values", " ", 
          "to", " ", "wither"}], " ", "+", 
         RowBox[{"1", " ", "or"}], " ", "-", "1"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"beliefin\[Alpha]", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"beliefin\[Alpha]", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "<", 
             RowBox[{"-", "dMAX"}]}], ")"}], ",", 
           RowBox[{"(*", "new", "*)"}], 
           RowBox[{
            RowBox[{"beliefin\[Alpha]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"-", "dMAX"}]}], 
           RowBox[{"(*", "new", "*)"}], 
           RowBox[{"(*", "OLD", "*)"}], 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"beliefin\[Alpha]", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "=", 
             RowBox[{
              RowBox[{"-", "dMAX"}], "+", "1"}]}], "*)"}], 
           RowBox[{"(*", "OLD", "*)"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"beliefin\[Alpha]", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ">", "  ", "dMAX"}], ")"}], ",",
            " ", 
           RowBox[{"(*", "new", "*)"}], 
           RowBox[{
            RowBox[{"beliefin\[Alpha]", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", "   ", "dMAX"}], 
           RowBox[{"(*", "new", "*)"}], 
           RowBox[{"(*", "OLD", "*)"}], 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"beliefin\[Alpha]", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "=", 
             RowBox[{"dMAX", "-", "1"}]}], "*)"}], " ", 
           RowBox[{"(*", "OLD", "*)"}], ",", "\[IndentingNewLine]", "True", 
           ",", 
           RowBox[{"beliefin\[Alpha]", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"beliefin\[Alpha]", "//", "Length"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.87024601336097*^9, 3.8702460269838047`*^9}, 
   3.870247562398513*^9, {3.870247901290688*^9, 3.870247913545789*^9}, {
   3.870248171112443*^9, 3.8702481805348454`*^9}, {3.870248393626191*^9, 
   3.8702484198548927`*^9}, {3.870249617559556*^9, 3.870249619120874*^9}, {
   3.870249891315257*^9, 3.8702499010453577`*^9}, {3.87024993698578*^9, 
   3.870249939191617*^9}, {3.8702506005986147`*^9, 3.8702507616549807`*^9}, {
   3.870250798743535*^9, 3.8702508045200787`*^9}, {3.870250891437058*^9, 
   3.870251027231915*^9}, {3.87025108250043*^9, 3.8702512212537107`*^9}, {
   3.8702513015979652`*^9, 3.870251336611343*^9}, {3.8702513693895407`*^9, 
   3.8702513869135017`*^9}, {3.8702515131913853`*^9, 
   3.8702515134078693`*^9}, {3.870251648614447*^9, 3.8702516874558353`*^9}, {
   3.870251720617352*^9, 3.8702517311062937`*^9}, {3.870251770035828*^9, 
   3.870251814306525*^9}, {3.870251850451576*^9, 3.870251861056651*^9}, {
   3.8702518930491457`*^9, 3.8702518991355*^9}, {3.870251946430917*^9, 
   3.870252018531983*^9}, {3.870252084932032*^9, 3.870252094300758*^9}, {
   3.870252555472765*^9, 3.8702525779917316`*^9}, {3.870252707123612*^9, 
   3.8702527379141912`*^9}, 3.870255799997542*^9, {3.87154036875607*^9, 
   3.871540416023946*^9}, {3.871540517014429*^9, 3.87154063506811*^9}, {
   3.87154071257174*^9, 3.8715407963416643`*^9}, {3.871540862834383*^9, 
   3.8715409126358547`*^9}, {3.8715410114674377`*^9, 3.871541020238207*^9}, 
   3.871541063284964*^9, {3.8715413046748962`*^9, 3.871541308832623*^9}, {
   3.871541543171513*^9, 3.87154154458173*^9}, {3.871541612962653*^9, 
   3.871541675846324*^9}, {3.871542679093449*^9, 3.8715427133999643`*^9}, {
   3.8715427800836763`*^9, 3.8715428192208242`*^9}, {3.871542850834771*^9, 
   3.871542870510728*^9}, {3.871544067233506*^9, 3.871544105809017*^9}, {
   3.8715441387924128`*^9, 3.871544224865347*^9}, {3.8715442624598007`*^9, 
   3.8715442635591497`*^9}, {3.871544321834899*^9, 3.871544324848575*^9}, 
   3.871544403438064*^9, {3.8715444677263412`*^9, 3.871544481004189*^9}, {
   3.871544527891453*^9, 3.871544580101633*^9}, {3.871544628012183*^9, 
   3.8715446483241177`*^9}, 3.8715517316934023`*^9, {3.8715522886629047`*^9, 
   3.871552288872658*^9}, {3.871552334403838*^9, 3.8715523346289062`*^9}, {
   3.8715528021646833`*^9, 3.87155280228822*^9}, {3.871552978852976*^9, 
   3.871552978913268*^9}, {3.871553016671008*^9, 3.871553018817437*^9}, 
   3.871553095793416*^9, {3.87155344044904*^9, 3.8715534935511303`*^9}, {
   3.87155352658245*^9, 3.8715535329892282`*^9}, {3.871553579343412*^9, 
   3.871553581313673*^9}, {3.871553958458755*^9, 3.8715539601506977`*^9}, {
   3.871558828086731*^9, 3.871558833848982*^9}, {3.871558906187265*^9, 
   3.871558987682918*^9}, 3.871559316760728*^9, {3.871559699941874*^9, 
   3.87155972602384*^9}, {3.871559759032323*^9, 3.871559764897707*^9}, {
   3.871559936681774*^9, 3.8715599530424633`*^9}, {3.871565073485072*^9, 
   3.871565100636739*^9}, {3.871565130853056*^9, 3.871565145649899*^9}, {
   3.871565529030569*^9, 3.8715655292252417`*^9}, {3.871565773157311*^9, 
   3.871565795180543*^9}, {3.8715661046802597`*^9, 3.87156618194703*^9}, {
   3.871574703968054*^9, 3.871574708693071*^9}, {3.8715757688688374`*^9, 
   3.8715757791461077`*^9}, {3.87157711188148*^9, 3.871577118781273*^9}, {
   3.871578716803144*^9, 3.8715787176352158`*^9}, {3.871579499556983*^9, 
   3.871579510977072*^9}, {3.871579593597062*^9, 3.871579612561151*^9}, {
   3.8715796447265863`*^9, 3.871579663109097*^9}, {3.8715797400827703`*^9, 
   3.87157985138531*^9}, {3.871579978237791*^9, 3.871579984805667*^9}, {
   3.871580718939529*^9, 3.871580725219192*^9}, {3.871581815307456*^9, 
   3.871581821065613*^9}, {3.871581925139412*^9, 3.871581941963879*^9}, {
   3.871656418980259*^9, 3.871656419524384*^9}, 3.871656449666934*^9, {
   3.871656534210606*^9, 3.871656552996997*^9}, {3.871656628255406*^9, 
   3.871656637796645*^9}, {3.871656680266336*^9, 3.871656683113514*^9}, {
   3.8716567799153357`*^9, 3.871656779997355*^9}, {3.871656837809424*^9, 
   3.871656838048584*^9}, {3.871723252255631*^9, 3.87172330618465*^9}, {
   3.871723368744816*^9, 3.8717233708461018`*^9}, {3.871723403876904*^9, 
   3.871723418638175*^9}, {3.871723452050496*^9, 3.8717234794605923`*^9}, {
   3.8717235153647947`*^9, 3.8717235273024883`*^9}, {3.871723568627376*^9, 
   3.871723699624754*^9}, {3.87172381357052*^9, 3.87172381860956*^9}, {
   3.8717240831021137`*^9, 3.871724086306926*^9}, {3.871724195147251*^9, 
   3.871724208376506*^9}, {3.8717242407584047`*^9, 3.8717242408470697`*^9}, {
   3.874653608988855*^9, 3.8746536224236097`*^9}, {3.874653819006281*^9, 
   3.874653819356104*^9}, {3.874656223776025*^9, 3.874656223815488*^9}, {
   3.874656295715208*^9, 3.874656402608629*^9}, {3.874656440349104*^9, 
   3.874656572592791*^9}, {3.874656609818873*^9, 3.8746566425194397`*^9}, {
   3.874656694092784*^9, 3.874656715524778*^9}, {3.874656798288019*^9, 
   3.874656823937088*^9}, {3.87465744488347*^9, 3.874657647000815*^9}, {
   3.874657680949976*^9, 3.874657699336505*^9}, {3.874657753773608*^9, 
   3.87465776298275*^9}, {3.874657813208305*^9, 3.874657923795067*^9}, {
   3.874657964970948*^9, 3.874658264161584*^9}, {3.874658399472246*^9, 
   3.874658485464324*^9}, {3.874658586322054*^9, 3.874658588207885*^9}, {
   3.874658642058033*^9, 3.8746586458466167`*^9}, {3.874658977019911*^9, 
   3.87465902586021*^9}, {3.874659614617816*^9, 3.874659638108917*^9}, 
   3.874660100685183*^9, {3.874660136960651*^9, 3.874660156376313*^9}, {
   3.874660202046351*^9, 3.8746602060779448`*^9}, 3.874660244337487*^9, {
   3.8746602754633923`*^9, 3.8746602788038387`*^9}, {3.874660315009788*^9, 
   3.8746603384975033`*^9}, {3.8746603806623983`*^9, 3.874660382697329*^9}, {
   3.874660416512389*^9, 3.8746604174496593`*^9}, {3.874660556333646*^9, 
   3.8746605564050903`*^9}, 3.874660623379468*^9, {3.874660884075548*^9, 
   3.874660909588764*^9}, {3.874660988103013*^9, 3.874661000250812*^9}, {
   3.874661041981708*^9, 3.874661169784615*^9}, {3.8746612384757843`*^9, 
   3.874661252354594*^9}, {3.874662731533606*^9, 3.8746627401137333`*^9}, {
   3.874662806785102*^9, 3.874662887616138*^9}, 3.874663180131909*^9, {
   3.874665270157522*^9, 3.874665272029331*^9}, {3.874665403702319*^9, 
   3.874665408940789*^9}, 3.874665578924182*^9, {3.874666239096244*^9, 
   3.874666288557488*^9}, 3.874666368869742*^9, {3.874666594436098*^9, 
   3.874666620114587*^9}, 3.874666680040916*^9, {3.8746667332104053`*^9, 
   3.874666752817154*^9}, {3.874667041021675*^9, 3.874667077197432*^9}, {
   3.8746671141401997`*^9, 3.874667127565909*^9}, 3.874667167474328*^9, {
   3.87466747142339*^9, 3.874667485330379*^9}, {3.874667641858041*^9, 
   3.874667676770928*^9}, {3.874667717478533*^9, 3.874667724371612*^9}, {
   3.8746682714630013`*^9, 3.8746682750540037`*^9}, {3.874668372769786*^9, 
   3.8746685685595016`*^9}, {3.874668602144834*^9, 3.87466864005254*^9}, {
   3.874668693622449*^9, 3.874668706467822*^9}, {3.874668762492908*^9, 
   3.87466885218329*^9}, {3.874668981511828*^9, 3.874668981595723*^9}, {
   3.874669014306201*^9, 3.874669014439859*^9}, {3.874669112451709*^9, 
   3.874669112952528*^9}, {3.874669454523696*^9, 3.874669464163872*^9}, {
   3.874669657488752*^9, 3.874669746562257*^9}, {3.874669825166937*^9, 
   3.874669828163134*^9}, {3.874669904013851*^9, 3.874669939821473*^9}, {
   3.8746700296128283`*^9, 3.874670052359025*^9}, 3.8746701664569798`*^9, 
   3.874670636226892*^9, 3.8746707767442427`*^9, 3.874671956379221*^9, {
   3.874673288923458*^9, 3.874673296729814*^9}, {3.874673396165552*^9, 
   3.874673408501792*^9}, {3.8746734502657137`*^9, 3.874673462446018*^9}, {
   3.874673504866097*^9, 3.874673526260214*^9}, {3.874735753114903*^9, 
   3.874735782107926*^9}, {3.874735823668582*^9, 3.87473582616887*^9}, {
   3.874736459568882*^9, 3.8747365875873938`*^9}, {3.874737032472642*^9, 
   3.874737051369328*^9}, {3.8747371119433823`*^9, 3.874737213795184*^9}, {
   3.874737275702345*^9, 3.874737312174202*^9}, {3.874737359224092*^9, 
   3.8747373604727907`*^9}, {3.8747374710582523`*^9, 3.874737471063385*^9}, {
   3.8747376579251633`*^9, 3.874737663490814*^9}, {3.874737703554388*^9, 
   3.874737705938857*^9}, {3.874738089342677*^9, 3.874738091428052*^9}, {
   3.874738932112636*^9, 3.874739007544132*^9}, {3.874739075737096*^9, 
   3.8747390886377296`*^9}, {3.874739128633902*^9, 3.874739129784589*^9}, {
   3.874749847336335*^9, 3.874749854507165*^9}, {3.874750838157857*^9, 
   3.874750842486703*^9}, {3.874751847416658*^9, 3.874751847754833*^9}, {
   3.874751985153384*^9, 3.874752008612981*^9}, {3.874752182547913*^9, 
   3.874752243726248*^9}, {3.874752311673863*^9, 3.874752312757959*^9}, {
   3.8747529814931707`*^9, 3.8747530406973143`*^9}, 3.875341626542416*^9, {
   3.875341699591031*^9, 3.87534172168688*^9}, {3.8753417993137493`*^9, 
   3.875341865020362*^9}, {3.8753418975518436`*^9, 3.875342000614449*^9}, {
   3.8753420525683603`*^9, 3.8753420644998217`*^9}, {3.875342099874331*^9, 
   3.87534215910135*^9}, {3.8753431171506357`*^9, 3.875343217399624*^9}, {
   3.8753432475936623`*^9, 3.875343273155046*^9}, {3.875347712668627*^9, 
   3.875347740316169*^9}, 3.875349121972147*^9, {3.8759510099079533`*^9, 
   3.875951018202527*^9}, {3.875951069918803*^9, 3.8759513559348803`*^9}, {
   3.875951388151434*^9, 3.87595141234654*^9}, {3.875951742316605*^9, 
   3.875951767523027*^9}, {3.875951837275421*^9, 3.875951847520054*^9}, {
   3.875952337768826*^9, 3.875952362571204*^9}, {3.875952404048428*^9, 
   3.8759524355474243`*^9}, 3.8759525569815598`*^9, {3.875952634017743*^9, 
   3.875952638104514*^9}, {3.875953093193665*^9, 3.875953114958054*^9}, 
   3.875953211603435*^9, 3.875953401825643*^9, 3.87595361321632*^9, {
   3.875953689465814*^9, 3.875953696481566*^9}, {3.875954503504472*^9, 
   3.8759545039614563`*^9}, {3.876048992963522*^9, 3.8760490342983103`*^9}, {
   3.876049065388258*^9, 3.876049132224235*^9}, {3.8760494304352913`*^9, 
   3.876049431547501*^9}, 3.876049598992975*^9, {3.876049876353279*^9, 
   3.8760498981672087`*^9}, 3.876050684011739*^9, 3.8763214172930317`*^9, 
   3.877707173577853*^9, {3.877707967906206*^9, 3.877708009953315*^9}, 
   3.8777095512521353`*^9, 3.877709607210454*^9, {3.8777116718709393`*^9, 
   3.877711674746943*^9}, 3.8777119110820627`*^9, {3.877713585576981*^9, 
   3.8777135855870533`*^9}, 3.877713661428392*^9, 3.8777168140591383`*^9, 
   3.8777168513593283`*^9, {3.877716911730893*^9, 3.8777169710359488`*^9}, {
   3.877717702467999*^9, 3.8777177077415447`*^9}, 3.8777178228513727`*^9, {
   3.877729205754862*^9, 3.8777292093050222`*^9}, {3.879247840649946*^9, 
   3.8792478425056973`*^9}, {3.879832211380385*^9, 3.879832262634707*^9}, 
   3.882689731800407*^9, {3.882689829224126*^9, 3.882689907098084*^9}, {
   3.882693150001164*^9, 3.8826931507284203`*^9}, {3.882696567188299*^9, 
   3.8826966081255713`*^9}, 3.882696649905014*^9, {3.882696720612082*^9, 
   3.882696744081327*^9}},ExpressionUUID->"3193ca42-fe74-47a7-8b4e-\
46189b5aecb5"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.877717711320874*^9, 3.8777177123895597`*^9}, 
   3.877717863342614*^9},
 CellLabel->"In[30]:=",ExpressionUUID->"829ef0b0-3a8f-46ca-9ceb-f3f10149cc3b"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"R0", "=", "50"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"20", " ", "experts"}], ",", " ", 
     RowBox[{"dmax", "=", 
      RowBox[{"4", " ", "unit", " ", "steps"}]}], ",", " ", 
     RowBox[{
      RowBox[{"==", ">", " ", "<", "rtot", ">"}], " ", "=", " ", 
      RowBox[{"100.", " ", "Here", " ", "using", " ", "half", " ", 
       RowBox[{"that", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"UpdateBelievein\[Alpha]Affinity", "[", "exp_", "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "rewards", ",", "maxreward", ",", "avgrewards", ",", "Largerewards", 
         ",", "r0", ",", "rjtotal", ",", "leadingexpert", ",", 
         RowBox[{"changebelief", "=", 
          RowBox[{"{", "}"}]}], ",", "beliefin\[Alpha]TEMP", ",", "it", ",", 
         RowBox[{"x", "=", "1"}], ",", 
         RowBox[{"y", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rewards", "=", 
         RowBox[{"CREWARD", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "All", ",", 
            RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"maxreward", "=", 
         RowBox[{"Max", "[", "rewards", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"avgrewards", "=", 
         RowBox[{"Mean", "[", "rewards", "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"rjtotal", "=", 
         RowBox[{"Plus", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"exp", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"INDEX", "[", "\"\<r\>\"", "]"}]}], "]"}], "]"}], "[", 
            
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"x", "=", 
         RowBox[{"1", "/", "2"}]}], ";", 
        RowBox[{"y", "=", 
         RowBox[{"1", "/", "2"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"OLD", " ", "and", " ", "new"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Largerewards", "=", 
         RowBox[{
          RowBox[{"x", " ", "*", " ", "avgrewards"}], "+", 
          RowBox[{"y", "*", "maxreward"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Largerewards", "!=", "0"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"r0", "=", "R0"}], ";", 
           RowBox[{"(*", "new", "*)"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"r0", "=", "0.0"}], ";"}], 
            RowBox[{"(*", "OLD", "*)"}], "*)"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"leadingexpert", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"rewards", ",", "maxreward"}], "]"}], "//", 
              "Flatten"}], "//", 
             RowBox[{
              RowBox[{"Part", "[", 
               RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"RandomSeed", "[", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"changebelief", "=", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"TrueQ", "[", "\[IndentingNewLine]", 
               RowBox[{"!", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Random", "[", "]"}], "<", 
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", " ", 
                    RowBox[{"affinity", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], 
                    RowBox[{"(", 
                    FractionBox["rjtotal", 
                    RowBox[{"rjtotal", "+", "r0"}]], ")"}], 
                    RowBox[{"(", 
                    FractionBox[
                    RowBox[{"Largerewards", "-", 
                    RowBox[{"rewards", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], 
                    RowBox[{"Largerewards", " "}]], ")"}]}], "]"}]}], ")"}]}],
                "   ", "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
              ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"beliefin\[Alpha]", "//", "Length"}]}], "}"}]}], 
             "]"}]}], ";", 
           RowBox[{"(*", "new", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"changebelief", "=", 
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"TrueQ", "[", "\[IndentingNewLine]", 
                 RowBox[{"!", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Random", "[", "]"}], "<", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", " ", 
                    RowBox[{"affinity", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], 
                    RowBox[{"(", 
                    FractionBox[
                    RowBox[{"Largerewards", "-", 
                    RowBox[{"rewards", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], 
                    RowBox[{"Largerewards", " "}]], ")"}]}], "]"}]}], ")"}]}],
                  "   ", "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
                ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"beliefin\[Alpha]", "//", "Length"}]}], "}"}]}], 
               "]"}]}], ";"}], 
            RowBox[{"(*", "OLD", "*)"}], "*)"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"beliefin\[Alpha]", "=", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Which", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"changebelief", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"beliefin\[Alpha]", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "+", 
                 RowBox[{"dSTEPSIZE", " ", "*", " ", 
                  RowBox[{"Sign", "[", "  ", 
                   RowBox[{
                    RowBox[{"beliefin\[Alpha]", "[", 
                    RowBox[{"[", "leadingexpert", "]"}], "]"}], "-", 
                    RowBox[{"beliefin\[Alpha]", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "  ", "]"}]}]}], ",", 
                "\[IndentingNewLine]", "True", ",", 
                RowBox[{"beliefin\[Alpha]", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "\[IndentingNewLine]", 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"beliefin\[Alpha]", "//", "Length"}]}], "}"}]}], 
             "\[IndentingNewLine]", "]"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<skipping question \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"CREWARD", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "All"}], "]"}], "]"}], "//", 
               "Transpose"}], "//", "Length"}], "]"}], "<>", 
            "\"\<with 0 cumulative <rewards> and rewards_max\>\""}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"\"\<****skipping question \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"CREWARD", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "All"}], "]"}], "]"}], "//", 
                "Transpose"}], "//", "Length"}], "]"}], "<>", 
             "\"\<with 0 cumulative <rewards> and rewards_max. Largereawards= \
 \>\""}], ",", "Largerewards", ",", "\"\<,  crew=\>\"", ",", 
            RowBox[{"CREWARD", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "All", ",", 
               RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.87024601336097*^9, 3.8702460269838047`*^9}, 
   3.870247562398513*^9, {3.870247901290688*^9, 3.870247913545789*^9}, {
   3.870248171112443*^9, 3.8702481805348454`*^9}, {3.870248393626191*^9, 
   3.8702484198548927`*^9}, {3.870249617559556*^9, 3.870249619120874*^9}, {
   3.870249891315257*^9, 3.8702499010453577`*^9}, {3.87024993698578*^9, 
   3.870249939191617*^9}, {3.8702506005986147`*^9, 3.8702507616549807`*^9}, {
   3.870250798743535*^9, 3.8702508045200787`*^9}, {3.870250891437058*^9, 
   3.870251027231915*^9}, {3.87025108250043*^9, 3.8702512212537107`*^9}, {
   3.8702513015979652`*^9, 3.870251336611343*^9}, {3.8702513693895407`*^9, 
   3.8702513869135017`*^9}, {3.8702515131913853`*^9, 
   3.8702515134078693`*^9}, {3.870251648614447*^9, 3.8702516874558353`*^9}, {
   3.870251720617352*^9, 3.8702517311062937`*^9}, {3.870251770035828*^9, 
   3.870251814306525*^9}, {3.870251850451576*^9, 3.870251861056651*^9}, {
   3.8702518930491457`*^9, 3.8702518991355*^9}, {3.870251946430917*^9, 
   3.870252018531983*^9}, {3.870252084932032*^9, 3.870252094300758*^9}, {
   3.870252555472765*^9, 3.8702525779917316`*^9}, {3.870252707123612*^9, 
   3.8702527379141912`*^9}, 3.870255799997542*^9, {3.87154036875607*^9, 
   3.871540416023946*^9}, {3.871540517014429*^9, 3.87154063506811*^9}, {
   3.87154071257174*^9, 3.8715407963416643`*^9}, {3.871540862834383*^9, 
   3.8715409126358547`*^9}, {3.8715410114674377`*^9, 3.871541020238207*^9}, 
   3.871541063284964*^9, {3.8715413046748962`*^9, 3.871541308832623*^9}, {
   3.871541543171513*^9, 3.87154154458173*^9}, {3.871541612962653*^9, 
   3.871541675846324*^9}, {3.871542679093449*^9, 3.8715427133999643`*^9}, {
   3.8715427800836763`*^9, 3.8715428192208242`*^9}, {3.871542850834771*^9, 
   3.871542870510728*^9}, {3.871544067233506*^9, 3.871544105809017*^9}, {
   3.8715441387924128`*^9, 3.871544224865347*^9}, {3.8715442624598007`*^9, 
   3.8715442635591497`*^9}, {3.871544321834899*^9, 3.871544324848575*^9}, 
   3.871544403438064*^9, {3.8715444677263412`*^9, 3.871544481004189*^9}, {
   3.871544527891453*^9, 3.871544580101633*^9}, {3.871544628012183*^9, 
   3.8715446483241177`*^9}, 3.8715517316934023`*^9, {3.8715522886629047`*^9, 
   3.871552288872658*^9}, {3.871552334403838*^9, 3.8715523346289062`*^9}, {
   3.8715528021646833`*^9, 3.87155280228822*^9}, {3.871552978852976*^9, 
   3.871552978913268*^9}, {3.871553016671008*^9, 3.871553018817437*^9}, 
   3.871553095793416*^9, {3.87155344044904*^9, 3.8715534935511303`*^9}, {
   3.87155352658245*^9, 3.8715535329892282`*^9}, {3.871553579343412*^9, 
   3.871553581313673*^9}, {3.871553958458755*^9, 3.8715539601506977`*^9}, {
   3.871558828086731*^9, 3.871558833848982*^9}, {3.871558906187265*^9, 
   3.871558987682918*^9}, 3.871559316760728*^9, {3.871559699941874*^9, 
   3.87155972602384*^9}, {3.871559759032323*^9, 3.871559764897707*^9}, {
   3.871559936681774*^9, 3.8715599530424633`*^9}, {3.871565073485072*^9, 
   3.871565100636739*^9}, {3.871565130853056*^9, 3.871565145649899*^9}, {
   3.871565529030569*^9, 3.8715655292252417`*^9}, {3.871565773157311*^9, 
   3.871565795180543*^9}, {3.8715661046802597`*^9, 3.87156618194703*^9}, {
   3.871574703968054*^9, 3.871574708693071*^9}, {3.8715757688688374`*^9, 
   3.8715757791461077`*^9}, {3.87157711188148*^9, 3.871577118781273*^9}, {
   3.871578716803144*^9, 3.8715787176352158`*^9}, {3.871579499556983*^9, 
   3.871579510977072*^9}, {3.871579593597062*^9, 3.871579612561151*^9}, {
   3.8715796447265863`*^9, 3.871579663109097*^9}, {3.8715797400827703`*^9, 
   3.87157985138531*^9}, {3.871579978237791*^9, 3.871579984805667*^9}, {
   3.871580718939529*^9, 3.871580725219192*^9}, {3.871581815307456*^9, 
   3.871581821065613*^9}, {3.871581925139412*^9, 3.871581941963879*^9}, {
   3.871656418980259*^9, 3.871656419524384*^9}, 3.871656449666934*^9, {
   3.871656534210606*^9, 3.871656552996997*^9}, {3.871656628255406*^9, 
   3.871656637796645*^9}, {3.871656680266336*^9, 3.871656683113514*^9}, {
   3.8716567799153357`*^9, 3.871656779997355*^9}, {3.871656837809424*^9, 
   3.871656838048584*^9}, {3.871723252255631*^9, 3.87172330618465*^9}, {
   3.871723368744816*^9, 3.8717233708461018`*^9}, {3.871723403876904*^9, 
   3.871723418638175*^9}, {3.871723452050496*^9, 3.8717234794605923`*^9}, {
   3.8717235153647947`*^9, 3.8717235273024883`*^9}, {3.871723568627376*^9, 
   3.871723699624754*^9}, {3.87172381357052*^9, 3.87172381860956*^9}, {
   3.8717240831021137`*^9, 3.871724086306926*^9}, {3.871724195147251*^9, 
   3.871724208376506*^9}, {3.8717242407584047`*^9, 3.8717242408470697`*^9}, {
   3.874653608988855*^9, 3.8746536224236097`*^9}, {3.874653819006281*^9, 
   3.874653819356104*^9}, {3.874656223776025*^9, 3.874656223815488*^9}, {
   3.874656295715208*^9, 3.874656402608629*^9}, {3.874656440349104*^9, 
   3.874656572592791*^9}, {3.874656609818873*^9, 3.8746566425194397`*^9}, {
   3.874656694092784*^9, 3.874656715524778*^9}, {3.874656798288019*^9, 
   3.874656823937088*^9}, {3.87465744488347*^9, 3.874657647000815*^9}, {
   3.874657680949976*^9, 3.874657699336505*^9}, {3.874657753773608*^9, 
   3.87465776298275*^9}, {3.874657813208305*^9, 3.874657923795067*^9}, {
   3.874657964970948*^9, 3.874658264161584*^9}, {3.874658399472246*^9, 
   3.874658485464324*^9}, {3.874658586322054*^9, 3.874658588207885*^9}, {
   3.874658642058033*^9, 3.8746586458466167`*^9}, {3.874658977019911*^9, 
   3.87465902586021*^9}, {3.874659614617816*^9, 3.874659638108917*^9}, 
   3.874660100685183*^9, {3.874660136960651*^9, 3.874660156376313*^9}, {
   3.874660202046351*^9, 3.8746602060779448`*^9}, 3.874660244337487*^9, {
   3.8746602754633923`*^9, 3.8746602788038387`*^9}, {3.874660315009788*^9, 
   3.8746603384975033`*^9}, {3.8746603806623983`*^9, 3.874660382697329*^9}, {
   3.874660416512389*^9, 3.8746604174496593`*^9}, {3.874660556333646*^9, 
   3.8746605564050903`*^9}, 3.874660623379468*^9, {3.874660884075548*^9, 
   3.874660909588764*^9}, {3.874660988103013*^9, 3.874661000250812*^9}, {
   3.874661041981708*^9, 3.874661169784615*^9}, {3.8746612384757843`*^9, 
   3.874661252354594*^9}, {3.874662731533606*^9, 3.8746627401137333`*^9}, {
   3.874662806785102*^9, 3.874662887616138*^9}, 3.874663180131909*^9, {
   3.874665270157522*^9, 3.874665272029331*^9}, {3.874665403702319*^9, 
   3.874665408940789*^9}, 3.874665578924182*^9, {3.874666239096244*^9, 
   3.874666288557488*^9}, 3.874666368869742*^9, {3.874666594436098*^9, 
   3.874666620114587*^9}, 3.874666680040916*^9, {3.8746667332104053`*^9, 
   3.874666752817154*^9}, {3.874667041021675*^9, 3.874667077197432*^9}, {
   3.8746671141401997`*^9, 3.874667127565909*^9}, 3.874667167474328*^9, {
   3.87466747142339*^9, 3.874667485330379*^9}, {3.874667641858041*^9, 
   3.874667676770928*^9}, {3.874667717478533*^9, 3.874667724371612*^9}, {
   3.8746682714630013`*^9, 3.8746682750540037`*^9}, {3.874668372769786*^9, 
   3.8746685685595016`*^9}, {3.874668602144834*^9, 3.87466864005254*^9}, {
   3.874668693622449*^9, 3.874668706467822*^9}, {3.874668762492908*^9, 
   3.87466885218329*^9}, {3.874668981511828*^9, 3.874668981595723*^9}, {
   3.874669014306201*^9, 3.874669014439859*^9}, {3.874669112451709*^9, 
   3.874669112952528*^9}, {3.874669454523696*^9, 3.874669464163872*^9}, {
   3.874669657488752*^9, 3.874669746562257*^9}, {3.874669825166937*^9, 
   3.874669828163134*^9}, {3.874669904013851*^9, 3.874669939821473*^9}, {
   3.8746700296128283`*^9, 3.874670052359025*^9}, 3.8746701664569798`*^9, 
   3.874670636226892*^9, 3.8746707767442427`*^9, 3.874671956379221*^9, {
   3.874673288923458*^9, 3.874673296729814*^9}, {3.874673396165552*^9, 
   3.874673408501792*^9}, {3.8746734502657137`*^9, 3.874673462446018*^9}, {
   3.874673504866097*^9, 3.874673526260214*^9}, {3.874735753114903*^9, 
   3.874735782107926*^9}, {3.874735823668582*^9, 3.87473582616887*^9}, {
   3.874736459568882*^9, 3.8747365875873938`*^9}, {3.874737032472642*^9, 
   3.874737051369328*^9}, {3.8747371119433823`*^9, 3.874737213795184*^9}, {
   3.874737275702345*^9, 3.874737312174202*^9}, {3.874737359224092*^9, 
   3.8747373604727907`*^9}, {3.8747374710582523`*^9, 3.874737471063385*^9}, {
   3.8747376579251633`*^9, 3.874737663490814*^9}, {3.874737703554388*^9, 
   3.874737705938857*^9}, {3.874738089342677*^9, 3.874738091428052*^9}, {
   3.874738932112636*^9, 3.874739007544132*^9}, {3.874739075737096*^9, 
   3.8747390886377296`*^9}, {3.874739128633902*^9, 3.874739129784589*^9}, {
   3.874749847336335*^9, 3.874749854507165*^9}, {3.874750838157857*^9, 
   3.874750842486703*^9}, {3.874751847416658*^9, 3.874751847754833*^9}, {
   3.874751985153384*^9, 3.874752008612981*^9}, {3.874752182547913*^9, 
   3.874752243726248*^9}, {3.874752311673863*^9, 3.874752312757959*^9}, {
   3.8747529814931707`*^9, 3.8747530406973143`*^9}, 3.875341626542416*^9, {
   3.875341699591031*^9, 3.87534172168688*^9}, {3.8753417993137493`*^9, 
   3.875341865020362*^9}, {3.8753418975518436`*^9, 3.875342000614449*^9}, {
   3.8753420525683603`*^9, 3.8753420644998217`*^9}, {3.875342099874331*^9, 
   3.87534215910135*^9}, {3.8753431171506357`*^9, 3.875343217399624*^9}, {
   3.8753432475936623`*^9, 3.875343273155046*^9}, {3.875347712668627*^9, 
   3.875347740316169*^9}, 3.875349121972147*^9, {3.8759510099079533`*^9, 
   3.875951018202527*^9}, {3.875951069918803*^9, 3.8759513559348803`*^9}, {
   3.875951388151434*^9, 3.87595141234654*^9}, {3.875951742316605*^9, 
   3.875951767523027*^9}, {3.875951837275421*^9, 3.875951847520054*^9}, {
   3.875952337768826*^9, 3.875952362571204*^9}, {3.875952404048428*^9, 
   3.8759524355474243`*^9}, 3.8759525569815598`*^9, {3.875952634017743*^9, 
   3.875952638104514*^9}, {3.875953093193665*^9, 3.875953114958054*^9}, 
   3.875953211603435*^9, 3.875953401825643*^9, 3.87595361321632*^9, {
   3.875953689465814*^9, 3.875953696481566*^9}, {3.875954503504472*^9, 
   3.8759545039614563`*^9}, {3.876048992963522*^9, 3.8760490342983103`*^9}, {
   3.876049065388258*^9, 3.876049132224235*^9}, {3.8760494304352913`*^9, 
   3.876049431547501*^9}, 3.876049598992975*^9, {3.876049876353279*^9, 
   3.8760498981672087`*^9}, 3.876050684011739*^9, 3.8763214172930317`*^9, 
   3.877707173577853*^9, {3.877707967906206*^9, 3.877708009953315*^9}, 
   3.8777095512521353`*^9, 3.877709607210454*^9, {3.8777116718709393`*^9, 
   3.877711674746943*^9}, 3.8777119110820627`*^9, {3.877713585576981*^9, 
   3.8777135855870533`*^9}, 3.877713661428392*^9, 3.8777168140591383`*^9, 
   3.8777168513593283`*^9, {3.877716911730893*^9, 3.8777169710359488`*^9}, {
   3.877717702467999*^9, 3.8777177077415447`*^9}, {3.877729227293017*^9, 
   3.877729232765358*^9}, {3.8792461487558002`*^9, 3.879246161166744*^9}, {
   3.879246268001686*^9, 3.879246293747506*^9}, {3.879669818038969*^9, 
   3.8796698205679007`*^9}, {3.8796698624827433`*^9, 
   3.8796699827687683`*^9}, {3.879670125851737*^9, 3.879670131911517*^9}, {
   3.8796702946260023`*^9, 3.879670313828949*^9}, {3.879672523421009*^9, 
   3.879672564080902*^9}, {3.879709992552915*^9, 3.879710036052498*^9}, {
   3.879710276956546*^9, 3.8797102910367537`*^9}, {3.879754204801117*^9, 
   3.87975423249751*^9}, {3.8798322997453423`*^9, 3.879832330149971*^9}, {
   3.879840636925078*^9, 3.879840664629468*^9}, {3.882620744684886*^9, 
   3.882620755725706*^9}, {3.882690018791378*^9, 3.8826900357971697`*^9}, {
   3.882690066397315*^9, 3.8826900668251143`*^9}, 3.8826927159153852`*^9, 
   3.882694122198237*^9, {3.882694407919903*^9, 3.8826944472351017`*^9}, {
   3.88269925694635*^9, 3.882699266062427*^9}, {3.882699618320743*^9, 
   3.882699620416415*^9}, {3.882699888309668*^9, 3.88269988857648*^9}, {
   3.882701497281444*^9, 3.882701497598106*^9}, {3.882702485096212*^9, 
   3.882702498239285*^9}, {3.882702604715864*^9, 3.8827026224979897`*^9}, 
   3.8827026958806963`*^9, 3.882702933387808*^9, {3.8827066605579853`*^9, 
   3.882706662938231*^9}, {3.8832105544253407`*^9, 3.8832105549633503`*^9}, {
   3.883212510120181*^9, 3.883212521186707*^9}, {3.883213303211731*^9, 
   3.8832133121846027`*^9}, {3.8832147213978577`*^9, 3.883214729388206*^9}, {
   3.8832148431468267`*^9, 3.8832148504208193`*^9}, {3.883298031349935*^9, 
   3.883298149739708*^9}, {3.883298789428101*^9, 3.883298789458645*^9}, 
   3.883388817885695*^9, 3.883483173712366*^9, {3.8834834264014797`*^9, 
   3.8834834464922867`*^9}, {3.88600624599599*^9, 3.8860062875525217`*^9}, {
   3.886006485881567*^9, 3.886006525565942*^9}, {3.8860067270947533`*^9, 
   3.8860067414189262`*^9}, {3.8860092228449717`*^9, 
   3.8860094051381807`*^9}, {3.886009739420285*^9, 3.886009802811915*^9}, {
   3.886009840341243*^9, 3.8860098478744583`*^9}, {3.886009905701599*^9, 
   3.8860099402695913`*^9}, {3.886009978472945*^9, 3.886009981322957*^9}, {
   3.886010768430869*^9, 3.886010786081127*^9}, 3.8860110347529297`*^9, {
   3.886011117644155*^9, 3.8860111361955967`*^9}, {3.886011294408272*^9, 
   3.88601130639944*^9}, {3.88601142222149*^9, 3.886011423914942*^9}, {
   3.88605911597519*^9, 3.886059137030896*^9}, {3.8860592252416058`*^9, 
   3.886059241901204*^9}, {3.886060331051552*^9, 3.886060333146006*^9}, 
   3.886060377994752*^9},ExpressionUUID->"ff0c0264-eaae-4fcd-a93e-\
86e6424e4096"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"UpdateBelievein\[Alpha]", "[", "exp_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RandomWalk", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"UpdateBelievein\[Alpha]Affinity", "[", "exp", "]"}], ";"}]}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"AppendTo", "[", 
       RowBox[{"BeliefCurrent", ",", "beliefin\[Alpha]"}], "]"}], ";"}], 
     "*)"}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.87024601336097*^9, 3.8702460269838047`*^9}, 
   3.870247562398513*^9, {3.870247901290688*^9, 3.870247913545789*^9}, {
   3.870248171112443*^9, 3.8702481805348454`*^9}, {3.870248393626191*^9, 
   3.8702484198548927`*^9}, {3.870249617559556*^9, 3.870249619120874*^9}, {
   3.870249891315257*^9, 3.8702499010453577`*^9}, {3.87024993698578*^9, 
   3.870249939191617*^9}, {3.8702506005986147`*^9, 3.8702507616549807`*^9}, {
   3.870250798743535*^9, 3.8702508045200787`*^9}, {3.870250891437058*^9, 
   3.870251027231915*^9}, {3.87025108250043*^9, 3.8702512212537107`*^9}, {
   3.8702513015979652`*^9, 3.870251336611343*^9}, {3.8702513693895407`*^9, 
   3.8702513869135017`*^9}, {3.8702515131913853`*^9, 
   3.8702515134078693`*^9}, {3.870251648614447*^9, 3.8702516874558353`*^9}, {
   3.870251720617352*^9, 3.8702517311062937`*^9}, {3.870251770035828*^9, 
   3.870251814306525*^9}, {3.870251850451576*^9, 3.870251861056651*^9}, {
   3.8702518930491457`*^9, 3.8702518991355*^9}, {3.870251946430917*^9, 
   3.870252018531983*^9}, {3.870252084932032*^9, 3.870252094300758*^9}, {
   3.870252555472765*^9, 3.8702525779917316`*^9}, {3.870252707123612*^9, 
   3.8702527379141912`*^9}, 3.870255799997542*^9, {3.87154036875607*^9, 
   3.871540416023946*^9}, {3.871540517014429*^9, 3.87154063506811*^9}, {
   3.87154071257174*^9, 3.8715407963416643`*^9}, {3.871540862834383*^9, 
   3.8715409126358547`*^9}, {3.8715410114674377`*^9, 3.871541020238207*^9}, 
   3.871541063284964*^9, {3.8715413046748962`*^9, 3.871541308832623*^9}, {
   3.871541543171513*^9, 3.87154154458173*^9}, {3.871541612962653*^9, 
   3.871541675846324*^9}, {3.871542679093449*^9, 3.8715427133999643`*^9}, {
   3.8715427800836763`*^9, 3.8715428192208242`*^9}, {3.871542850834771*^9, 
   3.871542870510728*^9}, {3.871544067233506*^9, 3.871544105809017*^9}, {
   3.8715441387924128`*^9, 3.871544224865347*^9}, {3.8715442624598007`*^9, 
   3.8715442635591497`*^9}, {3.871544321834899*^9, 3.871544324848575*^9}, 
   3.871544403438064*^9, {3.8715444677263412`*^9, 3.871544481004189*^9}, {
   3.871544527891453*^9, 3.871544580101633*^9}, {3.871544628012183*^9, 
   3.8715446483241177`*^9}, 3.8715517316934023`*^9, {3.8715522886629047`*^9, 
   3.871552288872658*^9}, {3.871552334403838*^9, 3.8715523346289062`*^9}, {
   3.8715528021646833`*^9, 3.87155280228822*^9}, {3.871552978852976*^9, 
   3.871552978913268*^9}, {3.871553016671008*^9, 3.871553018817437*^9}, 
   3.871553095793416*^9, {3.87155344044904*^9, 3.8715534935511303`*^9}, {
   3.87155352658245*^9, 3.8715535329892282`*^9}, {3.871553579343412*^9, 
   3.871553581313673*^9}, {3.871553958458755*^9, 3.8715539601506977`*^9}, {
   3.871558828086731*^9, 3.871558833848982*^9}, {3.871558906187265*^9, 
   3.871558987682918*^9}, 3.871559316760728*^9, {3.871559699941874*^9, 
   3.87155972602384*^9}, {3.871559759032323*^9, 3.871559764897707*^9}, {
   3.871559936681774*^9, 3.8715599530424633`*^9}, {3.871565073485072*^9, 
   3.871565100636739*^9}, {3.871565130853056*^9, 3.871565145649899*^9}, {
   3.871565529030569*^9, 3.8715655292252417`*^9}, {3.871565773157311*^9, 
   3.871565795180543*^9}, {3.8715661046802597`*^9, 3.87156618194703*^9}, {
   3.871574703968054*^9, 3.871574708693071*^9}, {3.8715757688688374`*^9, 
   3.8715757791461077`*^9}, {3.87157711188148*^9, 3.871577118781273*^9}, {
   3.871578716803144*^9, 3.8715787176352158`*^9}, {3.871579499556983*^9, 
   3.871579510977072*^9}, {3.871579593597062*^9, 3.871579612561151*^9}, {
   3.8715796447265863`*^9, 3.871579663109097*^9}, {3.8715797400827703`*^9, 
   3.87157985138531*^9}, {3.871579978237791*^9, 3.871579984805667*^9}, {
   3.871580718939529*^9, 3.871580725219192*^9}, {3.871581815307456*^9, 
   3.871581821065613*^9}, {3.871581925139412*^9, 3.871581941963879*^9}, {
   3.871656418980259*^9, 3.871656419524384*^9}, 3.871656449666934*^9, {
   3.871656534210606*^9, 3.871656552996997*^9}, {3.871656628255406*^9, 
   3.871656637796645*^9}, {3.871656680266336*^9, 3.871656683113514*^9}, {
   3.8716567799153357`*^9, 3.871656779997355*^9}, {3.871656837809424*^9, 
   3.871656838048584*^9}, {3.871723252255631*^9, 3.87172330618465*^9}, {
   3.871723368744816*^9, 3.8717233708461018`*^9}, {3.871723403876904*^9, 
   3.871723418638175*^9}, {3.871723452050496*^9, 3.8717234794605923`*^9}, {
   3.8717235153647947`*^9, 3.8717235273024883`*^9}, {3.871723568627376*^9, 
   3.871723699624754*^9}, {3.87172381357052*^9, 3.87172381860956*^9}, {
   3.8717240831021137`*^9, 3.871724086306926*^9}, {3.871724195147251*^9, 
   3.871724208376506*^9}, {3.8717242407584047`*^9, 3.8717242408470697`*^9}, {
   3.874653608988855*^9, 3.8746536224236097`*^9}, {3.874653819006281*^9, 
   3.874653819356104*^9}, {3.874656223776025*^9, 3.874656223815488*^9}, {
   3.874656295715208*^9, 3.874656402608629*^9}, {3.874656440349104*^9, 
   3.874656572592791*^9}, {3.874656609818873*^9, 3.8746566425194397`*^9}, {
   3.874656694092784*^9, 3.874656715524778*^9}, {3.874656798288019*^9, 
   3.874656823937088*^9}, {3.87465744488347*^9, 3.874657647000815*^9}, {
   3.874657680949976*^9, 3.874657699336505*^9}, {3.874657753773608*^9, 
   3.87465776298275*^9}, {3.874657813208305*^9, 3.874657923795067*^9}, {
   3.874657964970948*^9, 3.874658264161584*^9}, {3.874658399472246*^9, 
   3.874658485464324*^9}, {3.874658586322054*^9, 3.874658588207885*^9}, {
   3.874658642058033*^9, 3.8746586458466167`*^9}, {3.874658977019911*^9, 
   3.87465902586021*^9}, {3.874659614617816*^9, 3.874659638108917*^9}, 
   3.874660100685183*^9, {3.874660136960651*^9, 3.874660156376313*^9}, {
   3.874660202046351*^9, 3.8746602060779448`*^9}, 3.874660244337487*^9, {
   3.8746602754633923`*^9, 3.8746602788038387`*^9}, {3.874660315009788*^9, 
   3.8746603384975033`*^9}, {3.8746603806623983`*^9, 3.874660382697329*^9}, {
   3.874660416512389*^9, 3.8746604174496593`*^9}, {3.874660556333646*^9, 
   3.8746605564050903`*^9}, 3.874660623379468*^9, {3.874660884075548*^9, 
   3.874660909588764*^9}, {3.874660988103013*^9, 3.874661000250812*^9}, {
   3.874661041981708*^9, 3.874661169784615*^9}, {3.8746612384757843`*^9, 
   3.874661252354594*^9}, {3.874662731533606*^9, 3.8746627401137333`*^9}, {
   3.874662806785102*^9, 3.874662887616138*^9}, 3.874663180131909*^9, {
   3.874665270157522*^9, 3.874665272029331*^9}, {3.874665403702319*^9, 
   3.874665408940789*^9}, 3.874665578924182*^9, {3.874666239096244*^9, 
   3.874666288557488*^9}, 3.874666368869742*^9, {3.874666594436098*^9, 
   3.874666620114587*^9}, 3.874666680040916*^9, {3.8746667332104053`*^9, 
   3.874666752817154*^9}, {3.874667041021675*^9, 3.874667077197432*^9}, {
   3.8746671141401997`*^9, 3.874667127565909*^9}, 3.874667167474328*^9, {
   3.87466747142339*^9, 3.874667485330379*^9}, {3.874667641858041*^9, 
   3.874667676770928*^9}, {3.874667717478533*^9, 3.874667724371612*^9}, {
   3.8746682714630013`*^9, 3.8746682750540037`*^9}, {3.874668372769786*^9, 
   3.8746685685595016`*^9}, {3.874668602144834*^9, 3.87466864005254*^9}, {
   3.874668693622449*^9, 3.874668706467822*^9}, {3.874668762492908*^9, 
   3.87466885218329*^9}, {3.874668981511828*^9, 3.874668981595723*^9}, {
   3.874669014306201*^9, 3.874669014439859*^9}, {3.874669112451709*^9, 
   3.874669112952528*^9}, {3.874669454523696*^9, 3.874669464163872*^9}, {
   3.874669657488752*^9, 3.874669746562257*^9}, {3.874669825166937*^9, 
   3.874669828163134*^9}, {3.874669904013851*^9, 3.874669939821473*^9}, {
   3.8746700296128283`*^9, 3.874670052359025*^9}, 3.8746701664569798`*^9, 
   3.874670636226892*^9, 3.8746707767442427`*^9, 3.874671956379221*^9, {
   3.874673288923458*^9, 3.874673296729814*^9}, {3.874673396165552*^9, 
   3.874673408501792*^9}, {3.8746734502657137`*^9, 3.874673462446018*^9}, {
   3.874673504866097*^9, 3.874673526260214*^9}, {3.874735753114903*^9, 
   3.874735782107926*^9}, {3.874735823668582*^9, 3.87473582616887*^9}, {
   3.874736459568882*^9, 3.8747365875873938`*^9}, {3.874737032472642*^9, 
   3.874737051369328*^9}, {3.8747371119433823`*^9, 3.874737213795184*^9}, {
   3.874737275702345*^9, 3.874737312174202*^9}, {3.874737359224092*^9, 
   3.8747373604727907`*^9}, {3.8747374710582523`*^9, 3.874737471063385*^9}, {
   3.8747376579251633`*^9, 3.874737663490814*^9}, {3.874737703554388*^9, 
   3.874737705938857*^9}, {3.874738089342677*^9, 3.874738091428052*^9}, {
   3.874738932112636*^9, 3.874739007544132*^9}, {3.874739075737096*^9, 
   3.8747390886377296`*^9}, {3.874739128633902*^9, 3.874739129784589*^9}, {
   3.874749847336335*^9, 3.874749854507165*^9}, {3.874750838157857*^9, 
   3.874750842486703*^9}, {3.874751847416658*^9, 3.874751847754833*^9}, {
   3.874751985153384*^9, 3.874752008612981*^9}, {3.874752182547913*^9, 
   3.874752243726248*^9}, {3.874752311673863*^9, 3.874752312757959*^9}, {
   3.8747529814931707`*^9, 3.8747530406973143`*^9}, 3.875341626542416*^9, {
   3.875341699591031*^9, 3.87534172168688*^9}, {3.8753417993137493`*^9, 
   3.875341865020362*^9}, {3.8753418975518436`*^9, 3.875342000614449*^9}, {
   3.8753420525683603`*^9, 3.8753420644998217`*^9}, {3.875342099874331*^9, 
   3.87534215910135*^9}, {3.8753431171506357`*^9, 3.875343217399624*^9}, {
   3.8753432475936623`*^9, 3.875343273155046*^9}, {3.875347712668627*^9, 
   3.875347740316169*^9}, 3.875349121972147*^9, {3.8759510099079533`*^9, 
   3.875951018202527*^9}, {3.875951069918803*^9, 3.8759513559348803`*^9}, {
   3.875951388151434*^9, 3.87595141234654*^9}, {3.875951742316605*^9, 
   3.875951767523027*^9}, {3.875951837275421*^9, 3.875951847520054*^9}, {
   3.875952337768826*^9, 3.875952362571204*^9}, {3.875952404048428*^9, 
   3.8759524355474243`*^9}, 3.8759525569815598`*^9, {3.875952634017743*^9, 
   3.875952638104514*^9}, {3.875953093193665*^9, 3.875953114958054*^9}, 
   3.875953211603435*^9, 3.875953401825643*^9, 3.87595361321632*^9, {
   3.875953689465814*^9, 3.875953696481566*^9}, {3.875954503504472*^9, 
   3.8759545039614563`*^9}, {3.876048992963522*^9, 3.8760490342983103`*^9}, {
   3.876049065388258*^9, 3.876049132224235*^9}, {3.8760494304352913`*^9, 
   3.876049431547501*^9}, 3.876049598992975*^9, {3.876049876353279*^9, 
   3.8760498981672087`*^9}, 3.876050684011739*^9, 3.8763214172930317`*^9, 
   3.877707173577853*^9, {3.877707967906206*^9, 3.877708009953315*^9}, 
   3.8777095512521353`*^9, 3.877709607210454*^9, {3.8777116718709393`*^9, 
   3.877711674746943*^9}, 3.8777119110820627`*^9, {3.877713585576981*^9, 
   3.8777135855870533`*^9}, 3.877713661428392*^9, 3.8777168140591383`*^9, 
   3.8777168513593283`*^9, {3.877716911730893*^9, 3.8777169710359488`*^9}, {
   3.87771705883745*^9, 3.877717130212316*^9}, {3.877717162042264*^9, 
   3.877717214382263*^9}, {3.877717254305348*^9, 3.877717255305934*^9}, {
   3.87771748269345*^9, 3.877717490351633*^9}, 3.8777307056523733`*^9, {
   3.879670163287694*^9, 3.879670168101136*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"7d7431b0-3943-49e9-ae5f-95c89c7c0eb2"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PrintBelievein\[Alpha]", "[", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"names", "=", 
         RowBox[{"PLOTLEGENDS", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", 
            RowBox[{"1", ";;", "npredictors"}]}], "]"}], "]"}]}], ",", 
        "output"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"output", "=", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"names", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\<->\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"beliefin\[Alpha]", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "<>", "\"\<\\n\>\""}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "npredictors"}], "}"}]}], "]"}], "//",
          "StringJoin"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<------ Current belief in theory \[Alpha] ---------\>\"", ",", 
          "Red", ",", "Large"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<after \>\"", ",", "Bold", ",", "Large"}], "]"}], ",", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"BeliefCurrent", "//", "Length"}], ",", "Bold", ",", 
           "Large", ",", "Blue"}], "]"}], ",", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\< questions.\>\"", ",", "Bold", ",", "Large"}], "]"}]}],
         "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Style", "[", 
         RowBox[{"output", ",", "Blue", ",", "Large"}], "]"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.87024601336097*^9, 3.8702460269838047`*^9}, 
   3.870247562398513*^9, {3.870247901290688*^9, 3.870247913545789*^9}, {
   3.870248171112443*^9, 3.8702481805348454`*^9}, {3.870248393626191*^9, 
   3.8702484198548927`*^9}, {3.870249617559556*^9, 3.870249619120874*^9}, {
   3.870249891315257*^9, 3.8702499010453577`*^9}, {3.87024993698578*^9, 
   3.870249939191617*^9}, {3.8702506005986147`*^9, 3.8702507616549807`*^9}, {
   3.870250798743535*^9, 3.8702508045200787`*^9}, {3.870250891437058*^9, 
   3.870251027231915*^9}, {3.87025108250043*^9, 3.8702512212537107`*^9}, {
   3.8702513015979652`*^9, 3.870251336611343*^9}, {3.8702513693895407`*^9, 
   3.8702513869135017`*^9}, {3.8702515131913853`*^9, 
   3.8702515134078693`*^9}, {3.870251648614447*^9, 3.8702516874558353`*^9}, {
   3.870251720617352*^9, 3.8702517311062937`*^9}, {3.870251770035828*^9, 
   3.870251814306525*^9}, {3.870251850451576*^9, 3.870251861056651*^9}, {
   3.8702518930491457`*^9, 3.8702518991355*^9}, {3.870251946430917*^9, 
   3.870252018531983*^9}, {3.870252084932032*^9, 3.870252094300758*^9}, {
   3.870252555472765*^9, 3.8702525779917316`*^9}, {3.870252707123612*^9, 
   3.8702527379141912`*^9}, 3.870255799997542*^9, {3.87154036875607*^9, 
   3.871540416023946*^9}, {3.871540517014429*^9, 3.87154063506811*^9}, {
   3.87154071257174*^9, 3.8715407963416643`*^9}, {3.871540862834383*^9, 
   3.8715409126358547`*^9}, {3.8715410114674377`*^9, 3.871541020238207*^9}, 
   3.871541063284964*^9, {3.8715413046748962`*^9, 3.871541308832623*^9}, {
   3.871541543171513*^9, 3.87154154458173*^9}, {3.871541612962653*^9, 
   3.871541675846324*^9}, {3.871542679093449*^9, 3.8715427133999643`*^9}, {
   3.8715427800836763`*^9, 3.8715428192208242`*^9}, {3.871542850834771*^9, 
   3.871542870510728*^9}, {3.871544067233506*^9, 3.871544105809017*^9}, {
   3.8715441387924128`*^9, 3.871544224865347*^9}, {3.8715442624598007`*^9, 
   3.8715442635591497`*^9}, {3.871544321834899*^9, 3.871544324848575*^9}, 
   3.871544403438064*^9, {3.8715444677263412`*^9, 3.871544481004189*^9}, {
   3.871544527891453*^9, 3.871544580101633*^9}, {3.871544628012183*^9, 
   3.8715446483241177`*^9}, 3.8715517316934023`*^9, {3.8715522886629047`*^9, 
   3.871552288872658*^9}, {3.871552334403838*^9, 3.8715523346289062`*^9}, {
   3.8715528021646833`*^9, 3.87155280228822*^9}, {3.871552978852976*^9, 
   3.871552978913268*^9}, {3.871553016671008*^9, 3.871553018817437*^9}, 
   3.871553095793416*^9, {3.87155344044904*^9, 3.8715534935511303`*^9}, {
   3.87155352658245*^9, 3.8715535329892282`*^9}, {3.871553579343412*^9, 
   3.871553581313673*^9}, {3.871553958458755*^9, 3.8715539601506977`*^9}, {
   3.871558828086731*^9, 3.871558833848982*^9}, {3.871558906187265*^9, 
   3.871558987682918*^9}, 3.871559316760728*^9, {3.871559699941874*^9, 
   3.87155972602384*^9}, {3.871559759032323*^9, 3.871559764897707*^9}, {
   3.871559936681774*^9, 3.8715599530424633`*^9}, {3.871565073485072*^9, 
   3.871565100636739*^9}, {3.871565130853056*^9, 3.871565145649899*^9}, {
   3.871565529030569*^9, 3.8715655292252417`*^9}, {3.871565773157311*^9, 
   3.871565795180543*^9}, {3.8715661046802597`*^9, 3.87156618194703*^9}, {
   3.871574703968054*^9, 3.871574708693071*^9}, {3.8715757688688374`*^9, 
   3.8715757791461077`*^9}, {3.87157711188148*^9, 3.871577118781273*^9}, {
   3.871578716803144*^9, 3.8715787176352158`*^9}, {3.871579499556983*^9, 
   3.871579510977072*^9}, {3.871579593597062*^9, 3.871579612561151*^9}, {
   3.8715796447265863`*^9, 3.871579663109097*^9}, {3.8715797400827703`*^9, 
   3.87157985138531*^9}, {3.871579978237791*^9, 3.871579984805667*^9}, {
   3.871580718939529*^9, 3.871580725219192*^9}, {3.871581815307456*^9, 
   3.871581821065613*^9}, {3.871581925139412*^9, 3.871581941963879*^9}, {
   3.871656418980259*^9, 3.871656419524384*^9}, 3.871656449666934*^9, {
   3.871656534210606*^9, 3.871656552996997*^9}, {3.871656628255406*^9, 
   3.871656637796645*^9}, {3.871656680266336*^9, 3.871656683113514*^9}, {
   3.8716567799153357`*^9, 3.871656779997355*^9}, {3.871656837809424*^9, 
   3.871656838048584*^9}, {3.871723252255631*^9, 3.87172330618465*^9}, {
   3.871723368744816*^9, 3.8717233708461018`*^9}, {3.871723403876904*^9, 
   3.871723418638175*^9}, {3.871723452050496*^9, 3.8717234794605923`*^9}, {
   3.8717235153647947`*^9, 3.8717235273024883`*^9}, {3.871723568627376*^9, 
   3.871723699624754*^9}, {3.87172381357052*^9, 3.87172381860956*^9}, {
   3.8717240831021137`*^9, 3.871724086306926*^9}, {3.871724195147251*^9, 
   3.871724208376506*^9}, {3.8717242407584047`*^9, 3.8717242408470697`*^9}, {
   3.874653608988855*^9, 3.8746536224236097`*^9}, {3.874653819006281*^9, 
   3.874653819356104*^9}, {3.874656223776025*^9, 3.874656223815488*^9}, {
   3.874656295715208*^9, 3.874656402608629*^9}, {3.874656440349104*^9, 
   3.874656572592791*^9}, {3.874656609818873*^9, 3.8746566425194397`*^9}, {
   3.874656694092784*^9, 3.874656715524778*^9}, {3.874656798288019*^9, 
   3.874656823937088*^9}, {3.87465744488347*^9, 3.874657647000815*^9}, {
   3.874657680949976*^9, 3.874657699336505*^9}, {3.874657753773608*^9, 
   3.87465776298275*^9}, {3.874657813208305*^9, 3.874657923795067*^9}, {
   3.874657964970948*^9, 3.874658264161584*^9}, {3.874658399472246*^9, 
   3.874658485464324*^9}, {3.874658586322054*^9, 3.874658588207885*^9}, {
   3.874658642058033*^9, 3.8746586458466167`*^9}, {3.874658977019911*^9, 
   3.87465902586021*^9}, {3.874659614617816*^9, 3.874659638108917*^9}, 
   3.874660100685183*^9, {3.874660136960651*^9, 3.874660156376313*^9}, {
   3.874660202046351*^9, 3.8746602060779448`*^9}, 3.874660244337487*^9, {
   3.8746602754633923`*^9, 3.8746602788038387`*^9}, {3.874660315009788*^9, 
   3.8746603384975033`*^9}, {3.8746603806623983`*^9, 3.874660382697329*^9}, {
   3.874660416512389*^9, 3.8746604174496593`*^9}, {3.874660556333646*^9, 
   3.8746605564050903`*^9}, 3.874660623379468*^9, {3.874660884075548*^9, 
   3.874660909588764*^9}, {3.874660988103013*^9, 3.874661000250812*^9}, {
   3.874661041981708*^9, 3.874661169784615*^9}, {3.8746612384757843`*^9, 
   3.874661252354594*^9}, {3.874662731533606*^9, 3.8746627401137333`*^9}, {
   3.874662806785102*^9, 3.874662887616138*^9}, 3.874663180131909*^9, {
   3.874665270157522*^9, 3.874665272029331*^9}, {3.874665403702319*^9, 
   3.874665408940789*^9}, 3.874665578924182*^9, {3.874666239096244*^9, 
   3.874666288557488*^9}, 3.874666368869742*^9, {3.874666594436098*^9, 
   3.874666620114587*^9}, 3.874666680040916*^9, {3.8746667332104053`*^9, 
   3.874666752817154*^9}, {3.874667041021675*^9, 3.874667077197432*^9}, {
   3.8746671141401997`*^9, 3.874667127565909*^9}, 3.874667167474328*^9, {
   3.87466747142339*^9, 3.874667485330379*^9}, {3.874667641858041*^9, 
   3.874667676770928*^9}, {3.874667717478533*^9, 3.874667724371612*^9}, {
   3.8746682714630013`*^9, 3.8746682750540037`*^9}, {3.874668372769786*^9, 
   3.8746685685595016`*^9}, {3.874668602144834*^9, 3.87466864005254*^9}, {
   3.874668693622449*^9, 3.874668706467822*^9}, {3.874668762492908*^9, 
   3.87466885218329*^9}, {3.874668981511828*^9, 3.874668981595723*^9}, {
   3.874669014306201*^9, 3.874669014439859*^9}, {3.874669112451709*^9, 
   3.874669112952528*^9}, {3.874669454523696*^9, 3.874669464163872*^9}, {
   3.874669657488752*^9, 3.874669746562257*^9}, {3.874669825166937*^9, 
   3.874669828163134*^9}, {3.874669904013851*^9, 3.874669939821473*^9}, {
   3.8746700296128283`*^9, 3.874670052359025*^9}, 3.8746701664569798`*^9, 
   3.874670636226892*^9, 3.8746707767442427`*^9, 3.874671956379221*^9, {
   3.874673288923458*^9, 3.874673296729814*^9}, {3.874673396165552*^9, 
   3.874673408501792*^9}, {3.8746734502657137`*^9, 3.874673462446018*^9}, {
   3.874673504866097*^9, 3.874673526260214*^9}, {3.874735753114903*^9, 
   3.874735782107926*^9}, {3.874735823668582*^9, 3.87473582616887*^9}, {
   3.874736459568882*^9, 3.8747365875873938`*^9}, {3.874737032472642*^9, 
   3.874737051369328*^9}, {3.8747371119433823`*^9, 3.874737213795184*^9}, {
   3.874737275702345*^9, 3.874737312174202*^9}, {3.874737359224092*^9, 
   3.8747373604727907`*^9}, {3.8747374710582523`*^9, 3.874737471063385*^9}, {
   3.8747376579251633`*^9, 3.874737663490814*^9}, {3.874737703554388*^9, 
   3.874737705938857*^9}, {3.874738089342677*^9, 3.874738091428052*^9}, {
   3.874738932112636*^9, 3.874739007544132*^9}, {3.874739075737096*^9, 
   3.8747390886377296`*^9}, {3.874739128633902*^9, 3.874739129784589*^9}, {
   3.874749847336335*^9, 3.874749854507165*^9}, {3.874750838157857*^9, 
   3.874750842486703*^9}, {3.874751847416658*^9, 3.874751847754833*^9}, {
   3.874751985153384*^9, 3.874752008612981*^9}, {3.874752182547913*^9, 
   3.874752243726248*^9}, {3.874752311673863*^9, 3.874752312757959*^9}, {
   3.8747529814931707`*^9, 3.8747530406973143`*^9}, 3.875341626542416*^9, {
   3.875341699591031*^9, 3.87534172168688*^9}, {3.8753417993137493`*^9, 
   3.875341865020362*^9}, {3.8753418975518436`*^9, 3.875342000614449*^9}, {
   3.8753420525683603`*^9, 3.8753420644998217`*^9}, {3.875342099874331*^9, 
   3.87534215910135*^9}, {3.8753431171506357`*^9, 3.875343217399624*^9}, {
   3.8753432475936623`*^9, 3.875343273155046*^9}, {3.875347712668627*^9, 
   3.875347740316169*^9}, 3.875349121972147*^9, {3.8759510099079533`*^9, 
   3.875951018202527*^9}, {3.875951069918803*^9, 3.8759513559348803`*^9}, {
   3.875951388151434*^9, 3.87595141234654*^9}, {3.875951742316605*^9, 
   3.875951767523027*^9}, {3.875951837275421*^9, 3.875951847520054*^9}, {
   3.875952337768826*^9, 3.875952362571204*^9}, {3.875952404048428*^9, 
   3.8759524355474243`*^9}, 3.8759525569815598`*^9, {3.875952634017743*^9, 
   3.875952638104514*^9}, {3.875953093193665*^9, 3.875953114958054*^9}, 
   3.875953211603435*^9, 3.875953401825643*^9, 3.87595361321632*^9, {
   3.875953689465814*^9, 3.875953696481566*^9}, {3.875954503504472*^9, 
   3.8759545039614563`*^9}, {3.876048992963522*^9, 3.8760490342983103`*^9}, {
   3.876049065388258*^9, 3.876049132224235*^9}, {3.8760494304352913`*^9, 
   3.876049431547501*^9}, 3.876049598992975*^9, {3.876049876353279*^9, 
   3.8760498981672087`*^9}, 3.876050684011739*^9, 3.8763214172930317`*^9, 
   3.877707173577853*^9, {3.877707967906206*^9, 3.877708009953315*^9}, 
   3.8777095512521353`*^9, 3.877709607210454*^9, {3.8777116718709393`*^9, 
   3.877711674746943*^9}, 3.8777119110820627`*^9, {3.877713585576981*^9, 
   3.8777135855870533`*^9}, 3.877713661428392*^9, 3.8777168140591383`*^9, 
   3.8777168513593283`*^9, {3.877716911730893*^9, 3.8777169710359488`*^9}, 
   3.8777305005449867`*^9},
 CellLabel->"In[33]:=",ExpressionUUID->"251f863e-df69-44e8-ac98-04d2079ab0ba"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FORECASTMAX", "=", "0.99"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UserPredict", "[", 
   RowBox[{"exp_", ",", "newquestion_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"forecasts", "=", 
       RowBox[{"{", "}"}]}], ",", "tags", ",", 
      RowBox[{"forecasts2", "=", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tags", "=", 
      RowBox[{"PredictivePower", "//", "Keys"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"BeliefCurrent", ",", "beliefin\[Alpha]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"exp", "//", "Length"}], ")"}], "\[GreaterEqual]", " ", 
        "2"}], ",", 
       RowBox[{
        RowBox[{"UpdateBelievein\[Alpha]", "[", "exp", "]"}], ";"}], ",", 
       "\[IndentingNewLine]", "True", ",", "Nothing"}], "\[IndentingNewLine]",
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"forecasts", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Random", "[", "]"}], "//", 
         RowBox[{
          RowBox[{
           RowBox[{"PredictivePower", "[", "i", "]"}], "[", 
           RowBox[{"#", ",", 
            RowBox[{"newquestion", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "tags"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"(*", "new", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"forecasts", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0.001", ",", "0.999"}], "}"}], "]"}], "//", 
           RowBox[{
            RowBox[{
             RowBox[{"PredictivePower", "[", "i", "]"}], "[", 
             RowBox[{"#", ",", 
              RowBox[{"newquestion", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "tags"}], "}"}]}], "]"}]}], ";"}], 
      RowBox[{"(*", "OLD", "*)"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"forecasts2", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"1", "-", "FORECASTMAX"}], "<=", "#", "<=", 
           "FORECASTMAX"}], ",", "#", ",", 
          RowBox[{
           RowBox[{"1", "-", "FORECASTMAX"}], ">", "#"}], ",", 
          RowBox[{"1", "-", "FORECASTMAX"}], ",", 
          RowBox[{"#", ">", "FORECASTMAX"}], ",", "FORECASTMAX"}], "]"}], 
        "&"}], "/@", "forecasts"}]}], ";", 
     RowBox[{"(*", "new", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "forecasts2"}]}], 
   RowBox[{"(*", "new", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "forecasts", 
    RowBox[{"(*", "OLD", "*)"}], "*)"}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.87024601336097*^9, 3.8702460269838047`*^9}, 
   3.870247562398513*^9, {3.870247901290688*^9, 3.870247913545789*^9}, {
   3.870248171112443*^9, 3.8702481805348454`*^9}, {3.870248393626191*^9, 
   3.8702484198548927`*^9}, {3.870249617559556*^9, 3.870249619120874*^9}, {
   3.870249891315257*^9, 3.8702499010453577`*^9}, {3.87024993698578*^9, 
   3.870249939191617*^9}, {3.8702506005986147`*^9, 3.8702507616549807`*^9}, {
   3.870250798743535*^9, 3.8702508045200787`*^9}, {3.870250891437058*^9, 
   3.870251027231915*^9}, {3.87025108250043*^9, 3.8702512212537107`*^9}, {
   3.8702513015979652`*^9, 3.870251336611343*^9}, {3.8702513693895407`*^9, 
   3.8702513869135017`*^9}, {3.8702515131913853`*^9, 
   3.8702515134078693`*^9}, {3.870251648614447*^9, 3.8702516874558353`*^9}, {
   3.870251720617352*^9, 3.8702517311062937`*^9}, {3.870251770035828*^9, 
   3.870251814306525*^9}, {3.870251850451576*^9, 3.870251861056651*^9}, {
   3.8702518930491457`*^9, 3.8702518991355*^9}, {3.870251946430917*^9, 
   3.870252018531983*^9}, {3.870252084932032*^9, 3.870252094300758*^9}, {
   3.870252555472765*^9, 3.8702525779917316`*^9}, {3.870252707123612*^9, 
   3.8702527379141912`*^9}, 3.870255799997542*^9, {3.87154036875607*^9, 
   3.871540416023946*^9}, {3.871540517014429*^9, 3.87154063506811*^9}, {
   3.87154071257174*^9, 3.8715407963416643`*^9}, {3.871540862834383*^9, 
   3.8715409126358547`*^9}, {3.8715410114674377`*^9, 3.871541020238207*^9}, 
   3.871541063284964*^9, {3.8715413046748962`*^9, 3.871541308832623*^9}, {
   3.871541543171513*^9, 3.87154154458173*^9}, {3.871541612962653*^9, 
   3.871541675846324*^9}, {3.871542679093449*^9, 3.8715427133999643`*^9}, {
   3.8715427800836763`*^9, 3.8715428192208242`*^9}, {3.871542850834771*^9, 
   3.871542870510728*^9}, {3.871544067233506*^9, 3.871544105809017*^9}, {
   3.8715441387924128`*^9, 3.871544224865347*^9}, {3.8715442624598007`*^9, 
   3.8715442635591497`*^9}, {3.871544321834899*^9, 3.871544324848575*^9}, 
   3.871544403438064*^9, {3.8715444677263412`*^9, 3.871544481004189*^9}, {
   3.871544527891453*^9, 3.871544580101633*^9}, {3.871544628012183*^9, 
   3.8715446483241177`*^9}, 3.8715517316934023`*^9, {3.8715522886629047`*^9, 
   3.871552288872658*^9}, {3.871552334403838*^9, 3.8715523346289062`*^9}, {
   3.8715528021646833`*^9, 3.87155280228822*^9}, {3.871552978852976*^9, 
   3.871552978913268*^9}, {3.871553016671008*^9, 3.871553018817437*^9}, 
   3.871553095793416*^9, {3.87155344044904*^9, 3.8715534935511303`*^9}, {
   3.87155352658245*^9, 3.8715535329892282`*^9}, {3.871553579343412*^9, 
   3.871553581313673*^9}, {3.871553958458755*^9, 3.8715539601506977`*^9}, {
   3.871558828086731*^9, 3.871558833848982*^9}, {3.871558906187265*^9, 
   3.871558987682918*^9}, 3.871559316760728*^9, {3.871559699941874*^9, 
   3.87155972602384*^9}, {3.871559759032323*^9, 3.871559764897707*^9}, {
   3.871559936681774*^9, 3.8715599530424633`*^9}, {3.871565073485072*^9, 
   3.871565100636739*^9}, {3.871565130853056*^9, 3.871565145649899*^9}, {
   3.871565529030569*^9, 3.8715655292252417`*^9}, {3.871565773157311*^9, 
   3.871565795180543*^9}, {3.8715661046802597`*^9, 3.87156618194703*^9}, {
   3.871574703968054*^9, 3.871574708693071*^9}, {3.8715757688688374`*^9, 
   3.8715757791461077`*^9}, {3.87157711188148*^9, 3.871577118781273*^9}, {
   3.871578716803144*^9, 3.8715787176352158`*^9}, {3.871579499556983*^9, 
   3.871579510977072*^9}, {3.871579593597062*^9, 3.871579612561151*^9}, {
   3.8715796447265863`*^9, 3.871579663109097*^9}, {3.8715797400827703`*^9, 
   3.87157985138531*^9}, {3.871579978237791*^9, 3.871579984805667*^9}, {
   3.871580718939529*^9, 3.871580725219192*^9}, {3.871581815307456*^9, 
   3.871581821065613*^9}, {3.871581925139412*^9, 3.871581941963879*^9}, {
   3.871656418980259*^9, 3.871656419524384*^9}, 3.871656449666934*^9, {
   3.871656534210606*^9, 3.871656552996997*^9}, {3.871656628255406*^9, 
   3.871656637796645*^9}, {3.871656680266336*^9, 3.871656683113514*^9}, {
   3.8716567799153357`*^9, 3.871656779997355*^9}, {3.871656837809424*^9, 
   3.871656838048584*^9}, {3.871723252255631*^9, 3.87172330618465*^9}, {
   3.871723368744816*^9, 3.8717233708461018`*^9}, {3.871723403876904*^9, 
   3.871723418638175*^9}, {3.871723452050496*^9, 3.8717234794605923`*^9}, {
   3.8717235153647947`*^9, 3.8717235273024883`*^9}, {3.871723568627376*^9, 
   3.871723699624754*^9}, {3.87172381357052*^9, 3.87172381860956*^9}, {
   3.8717240831021137`*^9, 3.871724086306926*^9}, {3.871724195147251*^9, 
   3.871724208376506*^9}, {3.8717242407584047`*^9, 3.8717242408470697`*^9}, {
   3.874653608988855*^9, 3.8746536224236097`*^9}, {3.874653819006281*^9, 
   3.874653819356104*^9}, {3.874656223776025*^9, 3.874656223815488*^9}, {
   3.874656295715208*^9, 3.874656402608629*^9}, {3.874656440349104*^9, 
   3.874656572592791*^9}, {3.874656609818873*^9, 3.8746566425194397`*^9}, {
   3.874656694092784*^9, 3.874656715524778*^9}, {3.874656798288019*^9, 
   3.874656823937088*^9}, {3.87465744488347*^9, 3.874657647000815*^9}, {
   3.874657680949976*^9, 3.874657699336505*^9}, {3.874657753773608*^9, 
   3.87465776298275*^9}, {3.874657813208305*^9, 3.874657923795067*^9}, {
   3.874657964970948*^9, 3.874658264161584*^9}, {3.874658399472246*^9, 
   3.874658485464324*^9}, {3.874658586322054*^9, 3.874658588207885*^9}, {
   3.874658642058033*^9, 3.8746586458466167`*^9}, {3.874658977019911*^9, 
   3.87465902586021*^9}, {3.874659614617816*^9, 3.874659638108917*^9}, 
   3.874660100685183*^9, {3.874660136960651*^9, 3.874660156376313*^9}, {
   3.874660202046351*^9, 3.8746602060779448`*^9}, 3.874660244337487*^9, {
   3.8746602754633923`*^9, 3.8746602788038387`*^9}, {3.874660315009788*^9, 
   3.8746603384975033`*^9}, {3.8746603806623983`*^9, 3.874660382697329*^9}, {
   3.874660416512389*^9, 3.8746604174496593`*^9}, {3.874660556333646*^9, 
   3.8746605564050903`*^9}, 3.874660623379468*^9, {3.874660884075548*^9, 
   3.874660909588764*^9}, {3.874660988103013*^9, 3.874661000250812*^9}, {
   3.874661041981708*^9, 3.874661169784615*^9}, {3.8746612384757843`*^9, 
   3.874661252354594*^9}, {3.874662731533606*^9, 3.8746627401137333`*^9}, {
   3.874662806785102*^9, 3.874662887616138*^9}, 3.874663180131909*^9, {
   3.874665270157522*^9, 3.874665272029331*^9}, {3.874665403702319*^9, 
   3.874665408940789*^9}, 3.874665578924182*^9, {3.874666239096244*^9, 
   3.874666288557488*^9}, 3.874666368869742*^9, {3.874666594436098*^9, 
   3.874666620114587*^9}, 3.874666680040916*^9, {3.8746667332104053`*^9, 
   3.874666752817154*^9}, {3.874667041021675*^9, 3.874667077197432*^9}, {
   3.8746671141401997`*^9, 3.874667127565909*^9}, 3.874667167474328*^9, {
   3.87466747142339*^9, 3.874667485330379*^9}, {3.874667641858041*^9, 
   3.874667676770928*^9}, {3.874667717478533*^9, 3.874667724371612*^9}, {
   3.8746682714630013`*^9, 3.8746682750540037`*^9}, {3.874668372769786*^9, 
   3.8746685685595016`*^9}, {3.874668602144834*^9, 3.87466864005254*^9}, {
   3.874668693622449*^9, 3.874668706467822*^9}, {3.874668762492908*^9, 
   3.87466885218329*^9}, {3.874668981511828*^9, 3.874668981595723*^9}, {
   3.874669014306201*^9, 3.874669014439859*^9}, {3.874669112451709*^9, 
   3.874669112952528*^9}, {3.874669454523696*^9, 3.874669464163872*^9}, {
   3.874669657488752*^9, 3.874669746562257*^9}, {3.874669825166937*^9, 
   3.874669828163134*^9}, {3.874669904013851*^9, 3.874669939821473*^9}, {
   3.8746700296128283`*^9, 3.874670052359025*^9}, 3.8746701664569798`*^9, 
   3.874670636226892*^9, 3.8746707767442427`*^9, 3.874671956379221*^9, {
   3.874673288923458*^9, 3.874673296729814*^9}, {3.874673396165552*^9, 
   3.874673408501792*^9}, {3.8746734502657137`*^9, 3.874673462446018*^9}, {
   3.874673504866097*^9, 3.874673526260214*^9}, {3.874735753114903*^9, 
   3.874735782107926*^9}, {3.874735823668582*^9, 3.87473582616887*^9}, {
   3.874736459568882*^9, 3.8747365875873938`*^9}, {3.874737032472642*^9, 
   3.874737051369328*^9}, {3.8747371119433823`*^9, 3.874737213795184*^9}, {
   3.874737275702345*^9, 3.874737312174202*^9}, {3.874737359224092*^9, 
   3.8747373604727907`*^9}, {3.8747374710582523`*^9, 3.874737471063385*^9}, {
   3.8747376579251633`*^9, 3.874737663490814*^9}, {3.874737703554388*^9, 
   3.874737705938857*^9}, {3.874738089342677*^9, 3.874738091428052*^9}, {
   3.874738932112636*^9, 3.874739007544132*^9}, {3.874739075737096*^9, 
   3.8747390886377296`*^9}, {3.874739128633902*^9, 3.874739129784589*^9}, {
   3.874749847336335*^9, 3.874749854507165*^9}, {3.874750838157857*^9, 
   3.874750842486703*^9}, {3.874751847416658*^9, 3.874751847754833*^9}, {
   3.874751985153384*^9, 3.874752008612981*^9}, {3.874752182547913*^9, 
   3.874752243726248*^9}, {3.874752311673863*^9, 3.874752312757959*^9}, {
   3.8747529814931707`*^9, 3.8747530406973143`*^9}, 3.875341626542416*^9, {
   3.875341699591031*^9, 3.87534172168688*^9}, {3.8753417993137493`*^9, 
   3.875341865020362*^9}, {3.8753418975518436`*^9, 3.875342000614449*^9}, {
   3.8753420525683603`*^9, 3.8753420644998217`*^9}, {3.875342099874331*^9, 
   3.87534215910135*^9}, {3.8753431171506357`*^9, 3.875343217399624*^9}, {
   3.8753432475936623`*^9, 3.875343273155046*^9}, {3.875347712668627*^9, 
   3.875347740316169*^9}, 3.875349121972147*^9, {3.8759510099079533`*^9, 
   3.875951018202527*^9}, {3.875951069918803*^9, 3.8759513559348803`*^9}, {
   3.875951388151434*^9, 3.87595141234654*^9}, {3.875951742316605*^9, 
   3.875951767523027*^9}, {3.875951837275421*^9, 3.875951847520054*^9}, {
   3.875952337768826*^9, 3.875952362571204*^9}, {3.875952404048428*^9, 
   3.8759524355474243`*^9}, 3.8759525569815598`*^9, {3.875952634017743*^9, 
   3.875952638104514*^9}, {3.875953093193665*^9, 3.875953114958054*^9}, 
   3.875953211603435*^9, 3.875953401825643*^9, 3.87595361321632*^9, {
   3.875953689465814*^9, 3.875953696481566*^9}, {3.875954503504472*^9, 
   3.8759545039614563`*^9}, {3.876048992963522*^9, 3.8760490342983103`*^9}, {
   3.876049065388258*^9, 3.876049132224235*^9}, {3.8760494304352913`*^9, 
   3.876049431547501*^9}, 3.876049598992975*^9, {3.876049876353279*^9, 
   3.8760498981672087`*^9}, 3.876050684011739*^9, 3.8763214172930317`*^9, 
   3.877707173577853*^9, {3.877707967906206*^9, 3.877708009953315*^9}, 
   3.8777095512521353`*^9, 3.877709607210454*^9, {3.8777116718709393`*^9, 
   3.877711674746943*^9}, 3.8777119110820627`*^9, {3.877713585576981*^9, 
   3.8777135855870533`*^9}, 3.877713661428392*^9, 3.877714287771336*^9, {
   3.877730235978594*^9, 3.877730274780349*^9}, 3.877730398108778*^9, {
   3.8777306467661877`*^9, 3.87773065356369*^9}, {3.879670190741762*^9, 
   3.879670194952084*^9}, {3.879754256314948*^9, 3.879754258234378*^9}, {
   3.879754380650921*^9, 3.879754383805138*^9}, {3.879755400210741*^9, 
   3.879755402095975*^9}, {3.879758706332238*^9, 3.879758774684429*^9}, {
   3.8797588089585114`*^9, 3.87975882520544*^9}, {3.879758879832106*^9, 
   3.879758974630299*^9}, 3.8797590723278646`*^9, {3.8797591470168953`*^9, 
   3.879759147922597*^9}, {3.879759198635778*^9, 3.8797592008737917`*^9}, {
   3.879759276856395*^9, 3.879759354926118*^9}, {3.879759387928873*^9, 
   3.879759389322953*^9}, {3.879759544257242*^9, 3.879759544570413*^9}, 
   3.879759587230294*^9, {3.879759671804105*^9, 3.8797596718913507`*^9}, {
   3.879759707670293*^9, 3.879759708495603*^9}, 3.8797608404537*^9, 
   3.879836296966724*^9, 3.882614963843577*^9, {3.882615073720481*^9, 
   3.882615075974276*^9}, {3.88261526896632*^9, 3.882615270685153*^9}, {
   3.882615360760378*^9, 3.882615360880846*^9}, {3.8826155645427513`*^9, 
   3.8826155932836237`*^9}, 3.882620077643671*^9, {3.8826201641371107`*^9, 
   3.882620167478445*^9}, {3.882620254829965*^9, 3.882620255005536*^9}, {
   3.882620466803364*^9, 3.882620466946521*^9}, {3.8826207206598673`*^9, 
   3.882620720754483*^9}, {3.882620799500969*^9, 3.882620822749226*^9}, {
   3.882621185388591*^9, 3.88262118686714*^9}, 3.8826918148410273`*^9, {
   3.882691854042074*^9, 3.8826918861916447`*^9}, {3.882691946287784*^9, 
   3.8826920190611277`*^9}, {3.8826920916933737`*^9, 
   3.8826920977945347`*^9}, {3.882695566703842*^9, 
   3.88269559007533*^9}},ExpressionUUID->"967b86cd-b8c9-4b66-822d-\
04dbefa01f75"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", "resolutions", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"B0", "=", "0.7"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"UserResolve", "[", 
     RowBox[{"exp_", ",", "newquestion_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "objectiveSij", ",", "objectiveSjavg", ",", "b0", ",", "resolutions", 
        ",", "wj", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"objectiveSij", "=", 
        RowBox[{"ObjectiveSurprisal", "[", "newquestion", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"objectiveSjavg", "=", 
        RowBox[{"Mean", "[", "objectiveSij", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"wj", "=", 
        RowBox[{"newquestion", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"b0", "=", "B0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"RandomSeed", "[", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"resolutions", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Random", "[", "]"}], "<", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"bias", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "*", 
               RowBox[{"(", 
                FractionBox[
                 RowBox[{"objectiveSij", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], 
                 RowBox[{"objectiveSjavg", " ", "+", "b0"}]], ")"}]}], 
              "]"}]}], " ", ",", " ", "wj", ",", "\[IndentingNewLine]", 
            "True", ",", 
            RowBox[{"-", "wj"}]}], "\[IndentingNewLine]", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{
             RowBox[{"newquestion", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "//", "Length"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}]}]}], 
     RowBox[{"(*", "new", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"resolutions", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Random", "[", "]"}], "<", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"bias", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "*", 
              RowBox[{"(", 
               RowBox[{
                FractionBox[
                 RowBox[{"objectiveSij", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], 
                 RowBox[{"objectiveSjavg", " "}]], "-", "1"}], ")"}]}], 
             "]"}]}], " ", ",", " ", "wj", ",", "\[IndentingNewLine]", "True",
            ",", 
           RowBox[{"-", "wj"}]}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
            RowBox[{"newquestion", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "//", "Length"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], 
      RowBox[{"(*", "OLD", "*)"}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InitSimulationRewardDriven", "[", 
     RowBox[{
     "INITbeliefin\[Alpha]_List", ",", "INITaffinity_List", ",", 
      "INITbias_List", ",", "INITrandomwalkh_List"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", "variables", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Clear", "[", "\"\<npredictors*\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"npredictorsUSER", "=", 
        RowBox[{"INITbeliefin\[Alpha]", "//", "Length"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"beliefin\[Alpha]", "=", "INITbeliefin\[Alpha]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"affinity", "=", "INITaffinity"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"bias", "=", "INITbias"}], ";", "\[IndentingNewLine]", 
       RowBox[{"randomwalkh", "=", "INITrandomwalkh"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"BiasValues", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"AffinityValues", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"BeliefCurrent", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"BELIEF", "=", 
          RowBox[{"{", "}"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"ProbabilityPlus", "=", "0.5"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Init", "[", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Unprotect", "[", "BELIEF", "]"}], ";", 
       RowBox[{"BELIEF", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"Protect", "[", "BELIEF", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", "constant", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Unprotect", "/@", "ConstNamesSimRewardDriven"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PredictivePower", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"\"\<\\\"E\>\"", "<>", 
             RowBox[{"ToString", "[", "i", "]"}], "<>", 
             "\"\<\\\"\[Rule](predictivepower[#1,#2,beliefin\[Alpha][[\>\"", "<>", 
             RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<]]]&)\>\""}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "npredictors"}], "}"}]}], "]"}], "//",
           "ToExpression"}], "//", 
         RowBox[{"Apply", "[", "Association", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Protect", "/@", "ConstNamesSimRewardDriven"}], ";"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InitExperimentRewardDriven", "[", 
     RowBox[{
     "INITbeliefin\[Alpha]_List", ",", "INITaffinity_List", ",", 
      "INITbias_List", ",", "INITrandomwalkh_List"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", "variables", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"beliefin\[Alpha]", "=", "INITbeliefin\[Alpha]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"affinity", "=", "INITaffinity"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"bias", "=", "INITbias"}], ";", "\[IndentingNewLine]", 
       RowBox[{"randomwalkh", "=", "INITrandomwalkh"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"BeliefCurrent", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"CONSECUTIVETRUECOUNT", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"PREVIOUSTRUE", "=", "False"}], ";"}]}], "\[IndentingNewLine]",
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"StoreBeliefCurrent", "[", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"index", "=", 
        RowBox[{"EXPERIMENT", "//", "Length"}]}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Unprotect", "[", "BELIEF", "]"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"AppendTo", "[", 
        RowBox[{"BELIEF", ",", "BeliefCurrent"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"BELIEF", "[", 
           RowBox[{"[", "index", "]"}], "]"}], "=", "BeliefCurrent"}], ";"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Protect", "[", "BELIEF", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"condition", " ", "to", " ", "stop", " ", "simulation", " ", 
     RowBox[{"(", "jogh", ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CONSECUTIVETRUECOUNT", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"PREVIOUSTRUE", "=", "False"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NSTABLE", "=", "4"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"baseline", " ", "value"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RTHRESHOLD", "=", "4.04"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"20", " ", "players"}], " ", ",", " ", 
     RowBox[{"dmax", "=", "4"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"unit", " ", "steps", " ", "gives"}], " ", "<", "rtot", ">"}], 
      " ", "=", " ", 
      RowBox[{
       RowBox[{"2.02", ".", " ", "Here"}], " ", "using", " ", "double"}]}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"UserStop", "[", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"condition1", ",", "difflengthCsurprisal", ",", 
        RowBox[{"wastedquestion", "=", "False"}], ",", "out"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "check", " ", "first", " ", "if", " ", "this", " ", "is", " ", "a", 
         " ", "\"\<wasted\>\"", " ", 
         RowBox[{"question", ":", " ", "q"}]}], "=", 
        RowBox[{"0", " ", "=", 
         RowBox[{
          RowBox[{">", " ", "s"}], "=", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "...", ",", "0"}], "}"}], 
           "=", 
           RowBox[{
            RowBox[{">", " ", "r"}], "=", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "...", ",", "0"}], 
             "}"}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"wastedquestion", "=", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"CSURPRISAL", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], "//", 
             "Length"}], ")"}], "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"And", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"TrueQ", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"CSURPRISAL", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "All", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], "//", 
                 "DeleteDuplicates"}], "//", "Length"}], ")"}], "\[Equal]", 
              "1"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"TrueQ", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"CSURPRISAL", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "All", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], "//", 
                 "DeleteDuplicates"}], "//", 
                RowBox[{
                 RowBox[{"Part", "[", 
                  RowBox[{"#", ",", "1"}], "]"}], "&"}]}], ")"}], "\[Equal]", 
              "0"}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
          "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
          RowBox[{"And", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"TrueQ", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"CSURPRISAL", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "All", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], "-", 
                  RowBox[{"CSURPRISAL", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "All", ",", 
                    RowBox[{"-", "2"}]}], "]"}], "]"}]}], "//", 
                 "DeleteDuplicates"}], "//", "Length"}], ")"}], "\[Equal]", 
              "1"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"TrueQ", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"CSURPRISAL", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "All", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], "-", 
                  RowBox[{"CSURPRISAL", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "All", ",", 
                    RowBox[{"-", "2"}]}], "]"}], "]"}]}], "//", 
                 "DeleteDuplicates"}], "//", 
                RowBox[{
                 RowBox[{"Part", "[", 
                  RowBox[{"#", ",", "1"}], "]"}], "&"}]}], ")"}], "\[Equal]", 
              "0"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<crewards length=\>\"", ",", 
           RowBox[{
            RowBox[{"CREWARD", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], "//", 
            "Length"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<csurprisal length=\>\"", ",", 
           RowBox[{
            RowBox[{"CSURPRISAL", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], "//", 
            "Length"}]}], "]"}], ";"}], "\[IndentingNewLine]", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"condition1", "=", 
        RowBox[{"And", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"CREWARD", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], "]"}], ">=", 
           "NSTABLE"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"CREWARD", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "All", ",", 
                 RowBox[{"-", "1"}]}], "]"}], "]"}], "-", 
              RowBox[{"CREWARD", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "All", ",", 
                 RowBox[{"-", "2"}]}], "]"}], "]"}]}], "//", 
             RowBox[{"Apply", "[", "Plus", "]"}]}], ")"}], "<", 
           "RTHRESHOLD"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"TrueQ", "[", "wastedquestion", "]"}], ",", "Nothing", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"CONSECUTIVETRUECOUNT", "<", "NSTABLE"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"TrueQ", "[", "condition1", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"CONSECUTIVETRUECOUNT", "=", "0"}], ";", 
              RowBox[{"PREVIOUSTRUE", "=", "False"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"!", "PREVIOUSTRUE"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"CONSECUTIVETRUECOUNT", "=", "1"}], ";", 
                RowBox[{"PREVIOUSTRUE", "=", "True"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"CONSECUTIVETRUECOUNT", "++"}]}], 
              "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
           ",", "\[IndentingNewLine]", "Nothing"}], "\[IndentingNewLine]", 
          "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"out", "=", 
        RowBox[{"And", "[", 
         RowBox[{"condition1", ",", 
          RowBox[{"CONSECUTIVETRUECOUNT", ">=", "NSTABLE"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<out=\>\"", ",", "out"}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "out"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"condition", " ", "to", " ", "stop", " ", "simulation", " ", 
     RowBox[{"(", "TR", ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"rTHRESHOLD", "=", 
      RowBox[{
       RowBox[{"1", "/", "50"}], "*", "npredictors"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nSTABLE", "=", "10"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"UserStop", "[", "]"}], ":=", 
      RowBox[{"And", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"REWARD", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "All", ",", 
              RowBox[{"-", "1"}]}], "]"}], "]"}], "//", "StandardDeviation"}],
           ")"}], "<", "0.3"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"AREWARD", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], "//", "Length"}], 
          ")"}], ">", "10"}]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"load", " ", "user", " ", "function", " ", "into", " ", "EQLab"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{"SetUserFunctions", "[", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.87024601336097*^9, 3.8702460269838047`*^9}, 
   3.870247562398513*^9, {3.870247901290688*^9, 3.870247913545789*^9}, {
   3.870248171112443*^9, 3.8702481805348454`*^9}, {3.870248393626191*^9, 
   3.8702484198548927`*^9}, {3.870249617559556*^9, 3.870249619120874*^9}, {
   3.870249891315257*^9, 3.8702499010453577`*^9}, {3.87024993698578*^9, 
   3.870249939191617*^9}, {3.8702506005986147`*^9, 3.8702507616549807`*^9}, {
   3.870250798743535*^9, 3.8702508045200787`*^9}, {3.870250891437058*^9, 
   3.870251027231915*^9}, {3.87025108250043*^9, 3.8702512212537107`*^9}, {
   3.8702513015979652`*^9, 3.870251336611343*^9}, {3.8702513693895407`*^9, 
   3.8702513869135017`*^9}, {3.8702515131913853`*^9, 
   3.8702515134078693`*^9}, {3.870251648614447*^9, 3.8702516874558353`*^9}, {
   3.870251720617352*^9, 3.8702517311062937`*^9}, {3.870251770035828*^9, 
   3.870251814306525*^9}, {3.870251850451576*^9, 3.870251861056651*^9}, {
   3.8702518930491457`*^9, 3.8702518991355*^9}, {3.870251946430917*^9, 
   3.870252018531983*^9}, {3.870252084932032*^9, 3.870252094300758*^9}, {
   3.870252555472765*^9, 3.8702525779917316`*^9}, {3.870252707123612*^9, 
   3.8702527379141912`*^9}, 3.870255799997542*^9, {3.87154036875607*^9, 
   3.871540416023946*^9}, {3.871540517014429*^9, 3.87154063506811*^9}, {
   3.87154071257174*^9, 3.8715407963416643`*^9}, {3.871540862834383*^9, 
   3.8715409126358547`*^9}, {3.8715410114674377`*^9, 3.871541020238207*^9}, 
   3.871541063284964*^9, {3.8715413046748962`*^9, 3.871541308832623*^9}, {
   3.871541543171513*^9, 3.87154154458173*^9}, {3.871541612962653*^9, 
   3.871541675846324*^9}, {3.871542679093449*^9, 3.8715427133999643`*^9}, {
   3.8715427800836763`*^9, 3.8715428192208242`*^9}, {3.871542850834771*^9, 
   3.871542870510728*^9}, {3.871544067233506*^9, 3.871544105809017*^9}, {
   3.8715441387924128`*^9, 3.871544224865347*^9}, {3.8715442624598007`*^9, 
   3.8715442635591497`*^9}, {3.871544321834899*^9, 3.871544324848575*^9}, 
   3.871544403438064*^9, {3.8715444677263412`*^9, 3.871544481004189*^9}, {
   3.871544527891453*^9, 3.871544580101633*^9}, {3.871544628012183*^9, 
   3.8715446483241177`*^9}, 3.8715517316934023`*^9, {3.8715522886629047`*^9, 
   3.871552288872658*^9}, {3.871552334403838*^9, 3.8715523346289062`*^9}, {
   3.8715528021646833`*^9, 3.87155280228822*^9}, {3.871552978852976*^9, 
   3.871552978913268*^9}, {3.871553016671008*^9, 3.871553018817437*^9}, 
   3.871553095793416*^9, {3.87155344044904*^9, 3.8715534935511303`*^9}, {
   3.87155352658245*^9, 3.8715535329892282`*^9}, {3.871553579343412*^9, 
   3.871553581313673*^9}, {3.871553958458755*^9, 3.8715539601506977`*^9}, {
   3.871558828086731*^9, 3.871558833848982*^9}, {3.871558906187265*^9, 
   3.871558987682918*^9}, 3.871559316760728*^9, {3.871559699941874*^9, 
   3.87155972602384*^9}, {3.871559759032323*^9, 3.871559764897707*^9}, {
   3.871559936681774*^9, 3.8715599530424633`*^9}, {3.871565073485072*^9, 
   3.871565100636739*^9}, {3.871565130853056*^9, 3.871565145649899*^9}, {
   3.871565529030569*^9, 3.8715655292252417`*^9}, {3.871565773157311*^9, 
   3.871565795180543*^9}, {3.8715661046802597`*^9, 3.87156618194703*^9}, {
   3.871574703968054*^9, 3.871574708693071*^9}, {3.8715757688688374`*^9, 
   3.8715757791461077`*^9}, {3.87157711188148*^9, 3.871577118781273*^9}, {
   3.871578716803144*^9, 3.8715787176352158`*^9}, {3.871579499556983*^9, 
   3.871579510977072*^9}, {3.871579593597062*^9, 3.871579612561151*^9}, {
   3.8715796447265863`*^9, 3.871579663109097*^9}, {3.8715797400827703`*^9, 
   3.87157985138531*^9}, {3.871579978237791*^9, 3.871579984805667*^9}, {
   3.871580718939529*^9, 3.871580725219192*^9}, {3.871581815307456*^9, 
   3.871581821065613*^9}, {3.871581925139412*^9, 3.871581941963879*^9}, {
   3.871656418980259*^9, 3.871656419524384*^9}, 3.871656449666934*^9, {
   3.871656534210606*^9, 3.871656552996997*^9}, {3.871656628255406*^9, 
   3.871656637796645*^9}, {3.871656680266336*^9, 3.871656683113514*^9}, {
   3.8716567799153357`*^9, 3.871656779997355*^9}, {3.871656837809424*^9, 
   3.871656838048584*^9}, {3.871723252255631*^9, 3.87172330618465*^9}, {
   3.871723368744816*^9, 3.8717233708461018`*^9}, {3.871723403876904*^9, 
   3.871723418638175*^9}, {3.871723452050496*^9, 3.8717234794605923`*^9}, {
   3.8717235153647947`*^9, 3.8717235273024883`*^9}, {3.871723568627376*^9, 
   3.871723699624754*^9}, {3.87172381357052*^9, 3.87172381860956*^9}, {
   3.8717240831021137`*^9, 3.871724086306926*^9}, {3.871724195147251*^9, 
   3.871724208376506*^9}, {3.8717242407584047`*^9, 3.8717242408470697`*^9}, {
   3.874653608988855*^9, 3.8746536224236097`*^9}, {3.874653819006281*^9, 
   3.874653819356104*^9}, {3.874656223776025*^9, 3.874656223815488*^9}, {
   3.874656295715208*^9, 3.874656402608629*^9}, {3.874656440349104*^9, 
   3.874656572592791*^9}, {3.874656609818873*^9, 3.8746566425194397`*^9}, {
   3.874656694092784*^9, 3.874656715524778*^9}, {3.874656798288019*^9, 
   3.874656823937088*^9}, {3.87465744488347*^9, 3.874657647000815*^9}, {
   3.874657680949976*^9, 3.874657699336505*^9}, {3.874657753773608*^9, 
   3.87465776298275*^9}, {3.874657813208305*^9, 3.874657923795067*^9}, {
   3.874657964970948*^9, 3.874658264161584*^9}, {3.874658399472246*^9, 
   3.874658485464324*^9}, {3.874658586322054*^9, 3.874658588207885*^9}, {
   3.874658642058033*^9, 3.8746586458466167`*^9}, {3.874658977019911*^9, 
   3.87465902586021*^9}, {3.874659614617816*^9, 3.874659638108917*^9}, 
   3.874660100685183*^9, {3.874660136960651*^9, 3.874660156376313*^9}, {
   3.874660202046351*^9, 3.8746602060779448`*^9}, 3.874660244337487*^9, {
   3.8746602754633923`*^9, 3.8746602788038387`*^9}, {3.874660315009788*^9, 
   3.8746603384975033`*^9}, {3.8746603806623983`*^9, 3.874660382697329*^9}, {
   3.874660416512389*^9, 3.8746604174496593`*^9}, {3.874660556333646*^9, 
   3.8746605564050903`*^9}, 3.874660623379468*^9, {3.874660884075548*^9, 
   3.874660909588764*^9}, {3.874660988103013*^9, 3.874661000250812*^9}, {
   3.874661041981708*^9, 3.874661169784615*^9}, {3.8746612384757843`*^9, 
   3.874661252354594*^9}, {3.874662731533606*^9, 3.8746627401137333`*^9}, {
   3.874662806785102*^9, 3.874662887616138*^9}, 3.874663180131909*^9, {
   3.874665270157522*^9, 3.874665272029331*^9}, {3.874665403702319*^9, 
   3.874665408940789*^9}, 3.874665578924182*^9, {3.874666239096244*^9, 
   3.874666288557488*^9}, 3.874666368869742*^9, {3.874666594436098*^9, 
   3.874666620114587*^9}, 3.874666680040916*^9, {3.8746667332104053`*^9, 
   3.874666752817154*^9}, {3.874667041021675*^9, 3.874667077197432*^9}, {
   3.8746671141401997`*^9, 3.874667127565909*^9}, 3.874667167474328*^9, {
   3.87466747142339*^9, 3.874667485330379*^9}, {3.874667641858041*^9, 
   3.874667676770928*^9}, {3.874667717478533*^9, 3.874667724371612*^9}, {
   3.8746682714630013`*^9, 3.8746682750540037`*^9}, {3.874668372769786*^9, 
   3.8746685685595016`*^9}, {3.874668602144834*^9, 3.87466864005254*^9}, {
   3.874668693622449*^9, 3.874668706467822*^9}, {3.874668762492908*^9, 
   3.87466885218329*^9}, {3.874668981511828*^9, 3.874668981595723*^9}, {
   3.874669014306201*^9, 3.874669014439859*^9}, {3.874669112451709*^9, 
   3.874669112952528*^9}, {3.874669454523696*^9, 3.874669464163872*^9}, {
   3.874669657488752*^9, 3.874669746562257*^9}, {3.874669825166937*^9, 
   3.874669828163134*^9}, {3.874669904013851*^9, 3.874669939821473*^9}, {
   3.8746700296128283`*^9, 3.874670052359025*^9}, 3.8746701664569798`*^9, 
   3.874670636226892*^9, 3.8746707767442427`*^9, 3.874671956379221*^9, {
   3.874673288923458*^9, 3.874673296729814*^9}, {3.874673396165552*^9, 
   3.874673408501792*^9}, {3.8746734502657137`*^9, 3.874673462446018*^9}, {
   3.874673504866097*^9, 3.874673526260214*^9}, {3.874735753114903*^9, 
   3.874735782107926*^9}, {3.874735823668582*^9, 3.87473582616887*^9}, {
   3.874736459568882*^9, 3.8747365875873938`*^9}, {3.874737032472642*^9, 
   3.874737051369328*^9}, {3.8747371119433823`*^9, 3.874737213795184*^9}, {
   3.874737275702345*^9, 3.874737312174202*^9}, {3.874737359224092*^9, 
   3.8747373604727907`*^9}, {3.8747374710582523`*^9, 3.874737471063385*^9}, {
   3.8747376579251633`*^9, 3.874737663490814*^9}, {3.874737703554388*^9, 
   3.874737705938857*^9}, {3.874738089342677*^9, 3.874738091428052*^9}, {
   3.874738932112636*^9, 3.874739007544132*^9}, {3.874739075737096*^9, 
   3.8747390886377296`*^9}, {3.874739128633902*^9, 3.874739129784589*^9}, {
   3.874749847336335*^9, 3.874749854507165*^9}, {3.874750838157857*^9, 
   3.874750842486703*^9}, {3.874751847416658*^9, 3.874751847754833*^9}, {
   3.874751985153384*^9, 3.874752008612981*^9}, {3.874752182547913*^9, 
   3.874752243726248*^9}, {3.874752311673863*^9, 3.874752312757959*^9}, {
   3.8747529814931707`*^9, 3.8747530406973143`*^9}, 3.875341626542416*^9, {
   3.875341699591031*^9, 3.87534172168688*^9}, {3.8753417993137493`*^9, 
   3.875341865020362*^9}, {3.8753418975518436`*^9, 3.875342000614449*^9}, {
   3.8753420525683603`*^9, 3.8753420644998217`*^9}, {3.875342099874331*^9, 
   3.87534215910135*^9}, {3.8753431171506357`*^9, 3.875343217399624*^9}, {
   3.8753432475936623`*^9, 3.875343273155046*^9}, {3.875347712668627*^9, 
   3.875347740316169*^9}, 3.875349121972147*^9, {3.8759510099079533`*^9, 
   3.875951018202527*^9}, {3.875951069918803*^9, 3.8759513559348803`*^9}, {
   3.875951388151434*^9, 3.87595141234654*^9}, {3.875951742316605*^9, 
   3.875951767523027*^9}, {3.875951837275421*^9, 3.875951847520054*^9}, {
   3.875952337768826*^9, 3.875952362571204*^9}, {3.875952404048428*^9, 
   3.8759524355474243`*^9}, 3.8759525569815598`*^9, {3.875952634017743*^9, 
   3.875952638104514*^9}, {3.875953093193665*^9, 3.875953114958054*^9}, 
   3.875953211603435*^9, 3.875953401825643*^9, 3.87595361321632*^9, {
   3.875953689465814*^9, 3.875953696481566*^9}, {3.875954503504472*^9, 
   3.8759545039614563`*^9}, {3.876048992963522*^9, 3.8760490342983103`*^9}, {
   3.876049065388258*^9, 3.876049132224235*^9}, {3.8760494304352913`*^9, 
   3.876049431547501*^9}, 3.876049598992975*^9, {3.876049876353279*^9, 
   3.8760498981672087`*^9}, 3.876050684011739*^9, 3.8763214172930317`*^9, 
   3.877707173577853*^9, {3.877707967906206*^9, 3.877708009953315*^9}, 
   3.8777095512521353`*^9, 3.877709607210454*^9, {3.8777116718709393`*^9, 
   3.877711674746943*^9}, 3.8777119110820627`*^9, {3.877713585576981*^9, 
   3.8777135855870533`*^9}, 3.877713661428392*^9, {3.877713712699807*^9, 
   3.877713743143962*^9}, 3.877714410109806*^9, 3.8777144455556717`*^9, 
   3.877714519264783*^9, {3.877714550874243*^9, 3.877714554068783*^9}, 
   3.877726038066716*^9, {3.877726139313753*^9, 3.8777261892676764`*^9}, {
   3.8777265943993196`*^9, 3.877726638579337*^9}, {3.877729427623588*^9, 
   3.877729476168024*^9}, {3.877729567810869*^9, 3.8777295681811934`*^9}, {
   3.8778494642904263`*^9, 3.877849480505535*^9}, {3.877849527180758*^9, 
   3.877849527923233*^9}, {3.8792465878533497`*^9, 3.879246615325601*^9}, {
   3.879856808105803*^9, 3.8798568291399612`*^9}, {3.879857053650507*^9, 
   3.879857055107307*^9}, {3.879857190520465*^9, 3.879857192149302*^9}, {
   3.879857332875955*^9, 3.879857333063793*^9}, {3.879955336790863*^9, 
   3.879955342755134*^9}, {3.8799567569991417`*^9, 3.879956805725871*^9}, {
   3.8799570240178823`*^9, 3.8799570241091433`*^9}, {3.8826096201061573`*^9, 
   3.882609644525855*^9}, {3.882610451202262*^9, 3.882610471181438*^9}, {
   3.882610501692151*^9, 3.882610562122967*^9}, {3.8826143812355413`*^9, 
   3.882614400650381*^9}, {3.882614727077866*^9, 3.8826147271751966`*^9}, {
   3.88261480501403*^9, 3.882614806300705*^9}, {3.882614871283778*^9, 
   3.882614871396676*^9}, {3.8826153938660393`*^9, 3.8826153940080633`*^9}, {
   3.88261568305774*^9, 3.882615809697629*^9}, {3.8826158402355337`*^9, 
   3.882615843635993*^9}, {3.882615876060672*^9, 3.882615883361589*^9}, {
   3.88261591683433*^9, 3.8826159838115597`*^9}, {3.882616040823297*^9, 
   3.882616051476203*^9}, {3.8826161100875597`*^9, 3.8826161683195887`*^9}, {
   3.882616235252594*^9, 3.88261640006991*^9}, {3.882616435221856*^9, 
   3.88261654826637*^9}, {3.882616594949933*^9, 3.882616595164366*^9}, {
   3.882616739946122*^9, 3.882616778185812*^9}, {3.882616835693578*^9, 
   3.8826168593758802`*^9}, {3.882616890356389*^9, 3.8826169540119743`*^9}, {
   3.88261702869969*^9, 3.882617064122209*^9}, {3.882617123699482*^9, 
   3.88261734139579*^9}, {3.88261740568717*^9, 3.882617416205956*^9}, {
   3.882617485029641*^9, 3.8826174890838203`*^9}, {3.8826177476858*^9, 
   3.882617770428314*^9}, 3.8826178014936543`*^9, {3.882617850201161*^9, 
   3.882617850274419*^9}, {3.882617911204999*^9, 3.88261791131625*^9}, {
   3.882617958415133*^9, 3.8826179585718718`*^9}, {3.88261799698458*^9, 
   3.8826179976009808`*^9}, {3.8826190110782537`*^9, 
   3.8826190111656103`*^9}, {3.882619249004209*^9, 3.882619249086095*^9}, {
   3.882619606312772*^9, 3.882619683705379*^9}, {3.882619747129775*^9, 
   3.8826197473491163`*^9}, {3.882620063137289*^9, 3.882620063306303*^9}, {
   3.8826883241476183`*^9, 3.882688332953506*^9}, {3.882692221931665*^9, 
   3.882692275269392*^9}, {3.8832108312754097`*^9, 3.883210873377829*^9}, {
   3.883210995638772*^9, 3.883211012914125*^9}, {3.8832110534412193`*^9, 
   3.883211124444619*^9}, 3.883211352960536*^9, {3.883211482634589*^9, 
   3.883211485059091*^9}, {3.88321200984965*^9, 3.883212010511224*^9}, {
   3.883212060359151*^9, 3.8832120604283113`*^9}, {3.8832130082324877`*^9, 
   3.883213041847488*^9}, {3.883213103847702*^9, 3.883213104163436*^9}, {
   3.883213157043016*^9, 3.883213166363603*^9}, {3.8834831990983973`*^9, 
   3.883483280098542*^9}, {3.8834833687794857`*^9, 3.8834834039147577`*^9}, {
   3.885736399157963*^9, 3.885736418171042*^9}, {3.885737167559976*^9, 
   3.8857371806117773`*^9}, {3.885737560588243*^9, 3.885737562554274*^9}, {
   3.886059747728159*^9, 3.8860600244820433`*^9}, {3.886060104489607*^9, 
   3.8860602011155777`*^9}, {3.8860608978740273`*^9, 
   3.8860609237313633`*^9}, {3.886060974792241*^9, 3.886061008688533*^9}, {
   3.886061147599218*^9, 3.886061148913014*^9}, {3.8860611966457767`*^9, 
   3.886061516284534*^9}, {3.886061555376752*^9, 3.886061598502548*^9}, {
   3.886061637984673*^9, 3.8860616400858088`*^9}, {3.886061868820178*^9, 
   3.886061894173957*^9}, {3.88606194035625*^9, 3.886061943555983*^9}, {
   3.886062017239677*^9, 
   3.886062017705537*^9}},ExpressionUUID->"6926aef0-4b80-4c32-8e36-\
48d910fb830b"],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8799570086529827`*^9, 
  3.879957026840761*^9}},ExpressionUUID->"1cdff51a-6c4c-440c-83f0-\
57a8a9f19b5b"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.8799570067264853`*^9, 3.8799570214654627`*^9}},
 CellLabel->
  "Out[1123]=",ExpressionUUID->"b56fc836-61b4-43a8-b7d6-b39b237d68c8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["SUPERARRAYNAME"], "Input",
 CellLabel->"In[87]:=",ExpressionUUID->"dd3bc08c-f28a-4a73-bb14-1dd19ce694bc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"EXPERIMENT\"\>", ",", "\<\"PLOTS\"\>", 
   ",", "\<\"CSURPRISAL\"\>", ",", "\<\"CREWARD\"\>", 
   ",", "\<\"ASURPRISAL\"\>", ",", "\<\"AREWARD\"\>", ",", "\<\"BELIEF\"\>"}],
   "}"}]], "Output",
 CellChangeTimes->{3.88261058668146*^9},
 CellLabel->"Out[87]=",ExpressionUUID->"dee52f69-f71f-4e1a-a506-4ce5b41268b5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ival", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"EXPERIMENT", "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", "ival", ",", 
    RowBox[{"INDEX", "[", "\"\<m\>\"", "]"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"EXPERIMENT", "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", "ival", ",", 
    RowBox[{"INDEX", "[", "\"\<p\>\"", "]"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"EXPERIMENT", "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", "ival", ",", 
    RowBox[{"INDEX", "[", "\"\<r\>\"", "]"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"BELIEF", "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", "ival"}], "]"}], "]"}], "\[IndentingNewLine]"}], "Input",\

 CellChangeTimes->{{3.882610625009128*^9, 3.88261067359488*^9}, {
  3.882610712764982*^9, 3.88261071870045*^9}, {3.882610758387905*^9, 
  3.8826107630938053`*^9}, {3.8826108755621443`*^9, 3.882610882308893*^9}, {
  3.882610978746673*^9, 3.882610980600884*^9}, {3.882611032849881*^9, 
  3.882611170989682*^9}, {3.882611204366899*^9, 3.882611208452227*^9}},
 CellLabel->
  "In[162]:=",ExpressionUUID->"c8246128-d980-4761-b265-a3f2bd1ef3f7"],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 CellChangeTimes->{{3.882610629534677*^9, 3.8826106748760977`*^9}, {
   3.882610713487808*^9, 3.882610719065433*^9}, 3.8826107634475946`*^9, {
   3.882610875978503*^9, 3.882610882566684*^9}, 3.8826109809301987`*^9, {
   3.882611035272332*^9, 3.882611108094159*^9}, {3.8826111612934523`*^9, 
   3.882611171405436*^9}, 3.882611209249188*^9},
 CellLabel->
  "Out[163]=",ExpressionUUID->"7065119a-1c88-40c9-b90d-adb20b2e7c7e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.7645200605495891`", ",", "0.99`", ",", "0.9241028078377012`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.882610629534677*^9, 3.8826106748760977`*^9}, {
   3.882610713487808*^9, 3.882610719065433*^9}, 3.8826107634475946`*^9, {
   3.882610875978503*^9, 3.882610882566684*^9}, 3.8826109809301987`*^9, {
   3.882611035272332*^9, 3.882611108094159*^9}, {3.8826111612934523`*^9, 
   3.882611171405436*^9}, 3.882611209251169*^9},
 CellLabel->
  "Out[164]=",ExpressionUUID->"d0b0473b-2e68-4638-bd5d-6c7c32828ab7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4.850956752671572`", ",", 
   RowBox[{"-", "0.20505713144090099`"}], ",", "3.0388079557431005`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.882610629534677*^9, 3.8826106748760977`*^9}, {
   3.882610713487808*^9, 3.882610719065433*^9}, 3.8826107634475946`*^9, {
   3.882610875978503*^9, 3.882610882566684*^9}, 3.8826109809301987`*^9, {
   3.882611035272332*^9, 3.882611108094159*^9}, {3.8826111612934523`*^9, 
   3.882611171405436*^9}, 3.882611209253443*^9},
 CellLabel->
  "Out[165]=",ExpressionUUID->"d6809932-9d06-45c7-b34c-737245dd8647"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "4"}], ",", 
   RowBox[{"-", "4"}], ",", 
   RowBox[{"-", "4"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.882610629534677*^9, 3.8826106748760977`*^9}, {
   3.882610713487808*^9, 3.882610719065433*^9}, 3.8826107634475946`*^9, {
   3.882610875978503*^9, 3.882610882566684*^9}, 3.8826109809301987`*^9, {
   3.882611035272332*^9, 3.882611108094159*^9}, {3.8826111612934523`*^9, 
   3.882611171405436*^9}, 3.882611209255699*^9},
 CellLabel->
  "Out[166]=",ExpressionUUID->"0b7cecd4-6128-47a6-8d23-a5ab517658fa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8826108029962254`*^9, 3.882610818675461*^9}, {
   3.882610873675193*^9, 3.882610937111106*^9}, {3.882610983469589*^9, 
   3.88261098510749*^9}, {3.8826110365890083`*^9, 3.882611072755197*^9}, 
   3.882611156281283*^9},ExpressionUUID->"f6a50fad-51f8-44ba-b3ab-\
e9c24b8975a1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.882610807288385*^9, 3.882610819136957*^9}, {
   3.882610873990082*^9, 3.882610937557061*^9}, 3.88261098644928*^9, {
   3.882611025099839*^9, 3.8826110730879507`*^9}},
 CellLabel->
  "Out[147]=",ExpressionUUID->"ad2be2ea-bbef-4e48-8b1c-d280abba3b24"]
}, Open  ]],

Cell[BoxData["3"], "Input",
 CellChangeTimes->{
  3.8826107175525217`*^9},ExpressionUUID->"c9cf3080-4216-4899-978d-\
8f1ee3d687c3"],

Cell[CellGroupData[{

Cell[BoxData["INDEX"], "Input",
 CellChangeTimes->{{3.882610653271352*^9, 3.882610658446952*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"b37eebaf-9818-4f36-bf03-f2daa04c17f9"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"forecast\"\>", "\[Rule]", "1"}], ",", 
   RowBox[{"\<\"measurement\"\>", "\[Rule]", "2"}], ",", 
   RowBox[{"\<\"resolution\"\>", "\[Rule]", "3"}], ",", 
   RowBox[{"\<\"outcome\"\>", "\[Rule]", "4"}], ",", 
   RowBox[{"\<\"surprisal\"\>", "\[Rule]", "5"}], ",", 
   RowBox[{"\<\"reward\"\>", "\[Rule]", "6"}], ",", 
   RowBox[{"\<\"p\"\>", "\[Rule]", "1"}], ",", 
   RowBox[{"\<\"m\"\>", "\[Rule]", "2"}], ",", 
   RowBox[{"\<\"v\"\>", "\[Rule]", "3"}], ",", 
   RowBox[{"\<\"q\"\>", "\[Rule]", "4"}], ",", 
   RowBox[{"\<\"s\"\>", "\[Rule]", "5"}], ",", 
   RowBox[{"\<\"r\"\>", "\[Rule]", "6"}]}], "\[RightAssociation]"}]], "Output",\

 CellChangeTimes->{{3.882610654944051*^9, 3.8826106588802137`*^9}},
 CellLabel->"Out[94]=",ExpressionUUID->"194bf650-97d6-4eca-9383-d79ea663a0a0"]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1154, 610},
WindowMargins->{{4, Automatic}, {Automatic, 4}},
FrontEndVersion->"12.2 for Mac OS X x86 (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"62ab826e-b6de-4751-aa58-e9a9f6b3e2b3"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 10086, 140, 89, "Input",ExpressionUUID->"fd22b8eb-6822-4767-a07f-beac3dc16957",
 InitializationCell->True],
Cell[10647, 162, 1968, 43, 173, "Input",ExpressionUUID->"d08e6131-19ed-4575-a884-98208b0349f4",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[12640, 209, 26771, 523, 1689, "Input",ExpressionUUID->"8821a4b3-16af-4fa8-a5c6-9aa295b2d444",
 InitializationCell->True],
Cell[39414, 734, 945, 31, 37, "Output",ExpressionUUID->"aa65b087-f01c-48b2-b229-c5def1e4df8d"]
}, Open  ]],
Cell[40374, 768, 16756, 288, 803, "Input",ExpressionUUID->"3193ca42-fe74-47a7-8b4e-46189b5aecb5",
 InitializationCell->True],
Cell[57133, 1058, 245, 4, 68, "Input",ExpressionUUID->"829ef0b0-3a8f-46ca-9ceb-f3f10149cc3b",
 InitializationCell->True],
Cell[57381, 1064, 22050, 384, 1213, "Input",ExpressionUUID->"ff0c0264-eaae-4fcd-a93e-86e6424e4096",
 InitializationCell->True],
Cell[79434, 1450, 11478, 164, 173, "Input",ExpressionUUID->"7d7431b0-3943-49e9-ae5f-95c89c7c0eb2",
 InitializationCell->True],
Cell[90915, 1616, 12625, 195, 236, "Input",ExpressionUUID->"251f863e-df69-44e8-ac98-04d2079ab0ba",
 InitializationCell->True],
Cell[103543, 1813, 15279, 247, 404, "Input",ExpressionUUID->"967b86cd-b8c9-4b66-822d-04dbefa01f75",
 InitializationCell->True],
Cell[118825, 2062, 33230, 649, 2963, "Input",ExpressionUUID->"6926aef0-4b80-4c32-8e36-48d910fb830b",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[152080, 2715, 154, 3, 30, "Input",ExpressionUUID->"1cdff51a-6c4c-440c-83f0-57a8a9f19b5b"],
Cell[152237, 2720, 182, 3, 34, "Output",ExpressionUUID->"b56fc836-61b4-43a8-b7d6-b39b237d68c8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[152456, 2728, 119, 1, 30, "Input",ExpressionUUID->"dd3bc08c-f28a-4a73-bb14-1dd19ce694bc"],
Cell[152578, 2731, 358, 7, 34, "Output",ExpressionUUID->"dee52f69-f71f-4e1a-a506-4ce5b41268b5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[152973, 2743, 1153, 28, 136, "Input",ExpressionUUID->"c8246128-d980-4761-b265-a3f2bd1ef3f7"],
Cell[154129, 2773, 468, 8, 34, "Output",ExpressionUUID->"7065119a-1c88-40c9-b90d-adb20b2e7c7e"],
Cell[154600, 2783, 549, 10, 34, "Output",ExpressionUUID->"d0b0473b-2e68-4638-bd5d-6c7c32828ab7"],
Cell[155152, 2795, 582, 11, 34, "Output",ExpressionUUID->"d6809932-9d06-45c7-b34c-737245dd8647"],
Cell[155737, 2808, 563, 12, 34, "Output",ExpressionUUID->"0b7cecd4-6128-47a6-8d23-a5ab517658fa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[156337, 2825, 324, 5, 30, "Input",ExpressionUUID->"f6a50fad-51f8-44ba-b3ab-e9c24b8975a1"],
Cell[156664, 2832, 1645, 57, 56, "Output",ExpressionUUID->"ad2be2ea-bbef-4e48-8b1c-d280abba3b24"]
}, Open  ]],
Cell[158324, 2892, 131, 3, 30, "Input",ExpressionUUID->"c9cf3080-4216-4899-978d-8f1ee3d687c3"],
Cell[CellGroupData[{
Cell[158480, 2899, 176, 2, 30, "Input",ExpressionUUID->"b37eebaf-9818-4f36-bf03-f2daa04c17f9"],
Cell[158659, 2903, 858, 17, 37, "Output",ExpressionUUID->"194bf650-97d6-4eca-9383-d79ea663a0a0"]
}, Open  ]]
}
]
*)

