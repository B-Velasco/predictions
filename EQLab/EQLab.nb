(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     89601,       1940]
NotebookOptionsPosition[     86325,       1863]
NotebookOutlinePosition[     86754,       1880]
CellTagsIndexPosition[     86711,       1877]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["ExQuareum : EQLab", "Abstract",
 AutoGeneratedPackage->Automatic,
 InitializationCell->True,
 CellChangeTimes->{{3.8678264673804417`*^9, 3.8678264769535646`*^9}, {
   3.8678265090250072`*^9, 3.867826580337262*^9}, 3.867827441347404*^9, {
   3.867986997255563*^9, 3.86798703666848*^9}, {3.8679926994500847`*^9, 
   3.867992703845891*^9}},
 FontSize->24,ExpressionUUID->"3b4e6912-6fe9-4805-a105-5e1f66cac2fd"],

Cell[CellGroupData[{

Cell["Flags for internal use", "Item",
 AutoGeneratedPackage->Automatic,
 InitializationCell->True,
 CellChangeTimes->{{3.86782665299482*^9, 3.867826679658079*^9}, {
  3.867826719872582*^9, 3.867826760863641*^9}, {3.867826913164385*^9, 
  3.867826914181082*^9}, {3.867987111017407*^9, 3.867987112307576*^9}, {
  3.867989984244947*^9, 
  3.867989990707315*^9}},ExpressionUUID->"1c566f67-e7aa-4c2a-ac33-\
0a2107a5a2be"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FunctionsAreInitizialed", "=", "False"}], ";"}]], "Input",
 AutoGeneratedPackage->Automatic,
 InitializationCell->True,
 CellChangeTimes->{{3.86798999958739*^9, 3.867990032380024*^9}, 
   3.868038907682433*^9},ExpressionUUID->"d80d07b2-13de-4403-9adf-\
3f80e0395319"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Global Numerical Parameters (Default)", "Item",
 AutoGeneratedPackage->Automatic,
 InitializationCell->True,
 CellChangeTimes->{{3.86782665299482*^9, 3.867826679658079*^9}, {
  3.867826719872582*^9, 3.867826760863641*^9}, {3.867826913164385*^9, 
  3.867826914181082*^9}, {3.867987111017407*^9, 
  3.867987112307576*^9}},ExpressionUUID->"ba71628e-5d30-4e95-bc9f-\
573c7cacb52d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"npredictorsDEFAULT", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nquestionsDEFAULT", "=", "20"}], ";"}]}], "Input",
 AutoGeneratedPackage->Automatic,
 InitializationCell->True,
 CellChangeTimes->{{3.867825986444379*^9, 3.867826002095663*^9}, {
  3.86782687421478*^9, 3.8678268742850513`*^9}, {3.867986977014037*^9, 
  3.867986991150797*^9}, {3.868035016777652*^9, 3.868035021125486*^9}, {
  3.86803522076608*^9, 
  3.868035220882353*^9}},ExpressionUUID->"c6cd6752-3b2c-4794-9638-\
fa1e3281c9d5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Global  string arrays :\[LineSeparator]\tVARNAME : \t\tname of numerical \
parameters used in code. \[LineSeparator]\tSUPERARRAYNAME:\tname of  data \
structures.\
\>", "Item",
 AutoGeneratedPackage->Automatic,
 InitializationCell->True,
 CellChangeTimes->{{3.86782665299482*^9, 3.867826679658079*^9}, {
  3.867826719872582*^9, 3.867826760863641*^9}, {3.867826913164385*^9, 
  3.8678269907510843`*^9}, {3.867827108088716*^9, 3.867827348306707*^9}, {
  3.86798708206324*^9, 
  3.8679871884348803`*^9}},ExpressionUUID->"415749f6-b8be-4112-9cb7-\
98724a1e1aa2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"VARNAME", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<npredictors\>\"", ",", "\[IndentingNewLine]", "\"\<nquestions\>\""}],
     "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SUPERARRAYNAME", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<EXPERIMENT\>\"", ",", "\[IndentingNewLine]", "\"\<PLOTS\>\""}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 AutoGeneratedPackage->Automatic,
 InitializationCell->True,
 CellChangeTimes->{{3.867986911341786*^9, 3.867986956995573*^9}, {
  3.868005752813801*^9, 
  3.8680057565970993`*^9}},ExpressionUUID->"ddbdb09c-d910-4b87-bca0-\
e920b54dfeb7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Functions for initialization ", "Item",
 AutoGeneratedPackage->Automatic,
 InitializationCell->True,
 CellChangeTimes->{{3.86782665299482*^9, 3.867826679658079*^9}, {
  3.867826719872582*^9, 3.867826760863641*^9}, {3.867826913164385*^9, 
  3.867826914181082*^9}, {3.867827096234043*^9, 3.8678271014739943`*^9}, {
  3.867987341048559*^9, 
  3.8679873462065077`*^9}},ExpressionUUID->"736ea7f7-9f66-43ce-823a-\
8955e6affb6d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InitVariables", "[", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ivar", "=", "1"}], ",", 
       RowBox[{"ivarmax", "=", 
        RowBox[{"(", 
         RowBox[{"VARNAME", "//", "Length"}], ")"}]}], ",", 
       RowBox[{"userdefined", "=", "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{"var", "=", "\"\<\>\""}], ",", 
       RowBox[{"user", "=", "\"\<\>\""}], ",", 
       RowBox[{"default", "=", "\"\<\>\""}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"ivar", "=", "1"}], ",", 
       RowBox[{"ivar", "\[LessEqual]", "ivarmax"}], ",", 
       RowBox[{"ivar", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"var", "=", 
         RowBox[{"VARNAME", "[", 
          RowBox[{"[", "ivar", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"user", "=", 
         RowBox[{
          RowBox[{"VARNAME", "[", 
           RowBox[{"[", "ivar", "]"}], "]"}], "<>", "\"\<USER\>\""}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"default", "=", 
         RowBox[{
          RowBox[{"VARNAME", "[", 
           RowBox[{"[", "ivar", "]"}], "]"}], "<>", "\"\<DEFAULT\>\""}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"userdefined", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"user", "//", "ToExpression"}], "//", "NumberQ"}], ")"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Which", "[", 
          RowBox[{"userdefined", ",", 
           RowBox[{"var", "<>", "\"\<=\>\"", "<>", "user"}], ",", "True", ",", 
           RowBox[{"var", "<>", "\"\<=\>\"", "<>", "default"}]}], "]"}], "//",
          "ToExpression"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InitSuperarrays", "[", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"isuperarray", "=", "1"}], ",", 
       RowBox[{"isuperarraymax", "=", 
        RowBox[{"(", 
         RowBox[{"SUPERARRAYNAME", "//", "Length"}], ")"}]}], ",", 
       RowBox[{"userdefined", "=", "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{"superarray", "=", "\"\<\>\""}], ",", 
       RowBox[{"user", "=", "\"\<\>\""}], ",", 
       RowBox[{"default", "=", "\"\<\>\""}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"isuperarray", "=", "1"}], ",", 
       RowBox[{"isuperarray", "\[LessEqual]", "isuperarraymax"}], ",", 
       RowBox[{"isuperarray", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"superarray", "=", 
         RowBox[{"SUPERARRAYNAME", "[", 
          RowBox[{"[", "isuperarray", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"superarray", "<>", "\"\<={}\>\""}], "//", "ToExpression"}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "protect", " ", "super", " ", "arrays", " ", "from", " ", "user", 
          " ", "modification"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"SUPERARRAYNAME", "[", 
           RowBox[{"[", "isuperarray", "]"}], "]"}], "<>", 
          "\"\<//Protect\>\""}], "//", "ToExpression"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Init", "[", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"InitVariables", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"InitSuperarrays", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Init", "[", "]"}], ";"}], "\[IndentingNewLine]"}], "Input",
 AutoGeneratedPackage->Automatic,
 InitializationCell->True,
 CellChangeTimes->{{3.867823448462101*^9, 3.86782349137936*^9}, {
   3.867823640941674*^9, 3.86782375180656*^9}, {3.8678238282990093`*^9, 
   3.8678238376209517`*^9}, {3.8678238700479116`*^9, 
   3.8678239320678377`*^9}, {3.867823982347128*^9, 3.8678242187307158`*^9}, {
   3.867824249174664*^9, 3.8678243369555407`*^9}, {3.867824400151382*^9, 
   3.867824417321766*^9}, {3.867824453325432*^9, 3.867824457855608*^9}, {
   3.867824488452714*^9, 3.867824563146139*^9}, {3.867825155020002*^9, 
   3.867825159869234*^9}, {3.867825204629826*^9, 3.867825236502487*^9}, {
   3.867825819588312*^9, 3.867825851411784*^9}, {3.86782605920187*^9, 
   3.867826177544033*^9}, 3.8678262082185707`*^9, {3.8678262648717737`*^9, 
   3.8678263322582083`*^9}, {3.867826393840081*^9, 3.8678263975785646`*^9}, {
   3.8678273779314528`*^9, 3.867827378493926*^9}, 3.867828516014989*^9, {
   3.867832241263364*^9, 3.867832247246368*^9}, 3.8678323708644457`*^9, {
   3.8678328053469553`*^9, 3.8678328280836678`*^9}, 3.867832889575013*^9, 
   3.867986881238755*^9, 3.8679872114128237`*^9, {3.8679878619468946`*^9, 
   3.867988041695537*^9}, {3.8679880774220448`*^9, 3.867988120376335*^9}, {
   3.867988314105927*^9, 3.867988326616786*^9}, {3.8679897113491*^9, 
   3.867989718941382*^9}, {3.8679902981799917`*^9, 3.867990311496744*^9}, {
   3.867990349493204*^9, 3.8679904067616167`*^9}, {3.867995139798245*^9, 
   3.8679951405502167`*^9}, {3.8681846975884047`*^9, 
   3.868184746111701*^9}},ExpressionUUID->"7c537e84-6dd6-481b-9d60-\
8a46ce829e97"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Functions for basic Ex Quareum computations.", "Item",
 AutoGeneratedPackage->Automatic,
 InitializationCell->True,
 CellChangeTimes->{{3.86782665299482*^9, 3.867826679658079*^9}, {
  3.867826719872582*^9, 3.867826760863641*^9}, {3.867826913164385*^9, 
  3.867826914181082*^9}, {3.867827096234043*^9, 3.8678271014739943`*^9}, {
  3.86782794336696*^9, 3.8678279459413233`*^9}, {3.867987287971356*^9, 
  3.867987307489421*^9}},ExpressionUUID->"1454894f-1127-4a7b-a6a8-\
ab9bca049252"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Outcome", "[", "question_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"question", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "//", "Mean"}], "//", "N"}], "//", 
     "Sign"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Surprisal", "[", "question_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NumericQ", "[", 
         RowBox[{"question", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "i"}], "]"}], "]"}], "]"}], "&&", 
        RowBox[{"NumericQ", "[", 
         RowBox[{"question", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "]"}]}], ",", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"question", "[", 
           RowBox[{"[", "4", "]"}], "]"}], ">", "0"}], ",", 
         RowBox[{"-", 
          RowBox[{"Log", "[", 
           RowBox[{"question", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "i"}], "]"}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"question", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "<", "0"}], ",", 
         RowBox[{"-", 
          RowBox[{"Log", "[", 
           RowBox[{"1", "-", 
            RowBox[{"question", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "i"}], "]"}], "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"question", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}], ",", "0"}], 
        "]"}], ",", "True", ",", "I"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"question", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "//", "Length"}]}], "}"}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Reward", "[", "question_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"R", ",", "pi", ",", "si", ",", "pc", ",", 
      RowBox[{"c", "=", "1"}], ",", "q", ",", "V", ",", "smean", ",", 
      "\[CapitalDelta]s", ",", "ri", ",", "ipredictor", ",", 
      RowBox[{"r", "=", 
       RowBox[{"{", "}"}]}]}], 
     RowBox[{"(*", 
      RowBox[{"List", " ", "of", " ", "rewards"}], " ", "*)"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"smean", "=", 
      RowBox[{
       RowBox[{"question", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "//", "Mean"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalDelta]s", "=", 
      RowBox[{
       RowBox[{"question", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "//", "StandardDeviation"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"V", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"question", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "//", "Mean"}], "//", "Abs"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"R", "=", 
      RowBox[{
       RowBox[{"\[CapitalDelta]s", "*", "V"}], "//", "Abs"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pc", "=", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "smean"}], "-", 
        RowBox[{"c", "*", "\[CapitalDelta]s"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"q", "=", 
      RowBox[{"question", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"ipredictor", "=", "1"}], ",", 
       RowBox[{"ipredictor", "\[LessEqual]", "npredictors"}], ",", 
       RowBox[{"ipredictor", "++"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pi", "=", 
         RowBox[{"question", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "ipredictor"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"si", "=", 
         RowBox[{"question", "[", 
          RowBox[{"[", 
           RowBox[{"5", ",", "ipredictor"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ri", "=", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"q", ">", "0"}], ",", 
           RowBox[{"R", " ", 
            RowBox[{"Log", "[", 
             FractionBox["pi", "pc"], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"q", "<", "0"}], ",", 
           RowBox[{"R", " ", 
            RowBox[{"Log", "[", 
             FractionBox[
              RowBox[{"1", "-", "pi"}], "pc"], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"q", "\[Equal]", "0"}], ",", "0"}], "\[IndentingNewLine]", 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"update", " ", 
           RowBox[{"rj", ":", " ", 
            RowBox[{"sbig", "-", 
             RowBox[{"s", " ", "can", " ", "be", " ", "negative"}]}]}]}], ",",
           " ", 
          RowBox[{
          "so", " ", "use", " ", "a", " ", "theta", " ", "function"}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"ri", "=", 
         RowBox[{
          RowBox[{"ri", "*", 
           RowBox[{"HeavisideTheta", "[", 
            RowBox[{"smean", "+", 
             RowBox[{"c", "*", "\[CapitalDelta]s"}], "-", "si"}], "]"}]}], "//", 
          RowBox[{"ReplaceAll", "[", 
           RowBox[{
            RowBox[{"HeavisideTheta", "[", "0", "]"}], "\[Rule]", "0"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"r", ",", "ri"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "r"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 AutoGeneratedPackage->Automatic,
 InitializationCell->True,
 CellChangeTimes->{{3.867839556779538*^9, 3.86783971669942*^9}, {
   3.867839817893618*^9, 3.867839844338642*^9}, {3.8678399883343353`*^9, 
   3.867839994183217*^9}, {3.867840034598239*^9, 3.867840223594935*^9}, {
   3.8678402547230873`*^9, 3.867840362948492*^9}, {3.867840399638172*^9, 
   3.867840433574916*^9}, {3.86784050758362*^9, 3.867840524696947*^9}, {
   3.8678405557863293`*^9, 3.8678405569441023`*^9}, 3.8678405962472982`*^9, {
   3.8678406395633507`*^9, 3.867840680530445*^9}, {3.867840778482031*^9, 
   3.867840782156289*^9}, {3.867840985077559*^9, 3.867840986584888*^9}, {
   3.867841086953157*^9, 3.8678411291715813`*^9}, {3.867841210815301*^9, 
   3.867841257196693*^9}, {3.867841288757958*^9, 3.8678413135762367`*^9}, {
   3.86784135102556*^9, 3.867841414093575*^9}, {3.867841445900641*^9, 
   3.867841507714361*^9}, {3.867841546675437*^9, 3.8678415512703123`*^9}, 
   3.8678417876094227`*^9, 3.867841826084988*^9, 3.867841992365144*^9, {
   3.867842326134549*^9, 3.8678424081666813`*^9}, {3.8678424820440397`*^9, 
   3.8678425111858883`*^9}, {3.8678425573314877`*^9, 3.867842561434742*^9}, {
   3.867842600477272*^9, 3.8678426037866783`*^9}, {3.867842908948868*^9, 
   3.8678430012208223`*^9}, {3.867843120569776*^9, 3.867843121338312*^9}, {
   3.867843242491817*^9, 3.867843242748021*^9}, {3.867843302067933*^9, 
   3.867843459899021*^9}, {3.8678435137771387`*^9, 3.8678435361110573`*^9}, {
   3.8678436251002283`*^9, 3.867843626475198*^9}, {3.867843660710587*^9, 
   3.8678436744453163`*^9}, {3.867843886779848*^9, 3.867843937111661*^9}, {
   3.867843981069556*^9, 3.8678441624720583`*^9}, {3.8678442031803427`*^9, 
   3.8678443174710283`*^9}, {3.867844403432073*^9, 3.8678445873305883`*^9}, {
   3.867844952431409*^9, 3.8678450335012197`*^9}, {3.86784516677407*^9, 
   3.867845169990252*^9}, 3.867845310221945*^9, {3.867947072315124*^9, 
   3.867947103078915*^9}, {3.867947155674634*^9, 3.867947230091071*^9}, {
   3.867947266733069*^9, 3.867947468767706*^9}, {3.8679477385590487`*^9, 
   3.867947760055182*^9}, {3.867948487324896*^9, 3.86794849850454*^9}, {
   3.867948595560459*^9, 3.867948603837001*^9}, {3.8679486536342793`*^9, 
   3.8679487383003263`*^9}, 3.867948812991971*^9, {3.867948993240115*^9, 
   3.867949005483585*^9}, {3.8679490756632957`*^9, 3.8679491190736713`*^9}, {
   3.8679491721343517`*^9, 3.867949183416431*^9}, {3.8679492599345512`*^9, 
   3.86794930285607*^9}, {3.867949337874402*^9, 3.8679493557880898`*^9}, 
   3.8679493862825623`*^9, {3.8679494204413977`*^9, 3.867949440768952*^9}, {
   3.8679495051984673`*^9, 3.8679495176141977`*^9}, {3.867949568431567*^9, 
   3.867949682443696*^9}, {3.8679498497117367`*^9, 3.8679498508272*^9}, {
   3.867950031920157*^9, 3.8679501419257*^9}, {3.8679501751605883`*^9, 
   3.867950248352376*^9}, {3.867950279184771*^9, 3.8679503589949093`*^9}, {
   3.8679503966221867`*^9, 3.867950604205991*^9}, {3.8679509105831423`*^9, 
   3.867950910869914*^9}, {3.867951233341481*^9, 3.867951348045537*^9}, 
   3.8679516400126038`*^9, {3.867952130752075*^9, 3.867952312433839*^9}, {
   3.867952730534876*^9, 3.8679527307093782`*^9}, {3.8679528175021563`*^9, 
   3.867952838419829*^9}, {3.86795287552771*^9, 3.867952875752101*^9}, {
   3.8679529159284678`*^9, 3.86795304812388*^9}, {3.867953081326301*^9, 
   3.867953120626614*^9}, {3.867953190782568*^9, 3.86795319135686*^9}, {
   3.86795324634964*^9, 3.867953246996345*^9}, {3.867953345561599*^9, 
   3.867953440098195*^9}, {3.867953478583403*^9, 3.8679534942523108`*^9}, {
   3.867953562436316*^9, 3.867953570199769*^9}, {3.867960046896214*^9, 
   3.86796004703658*^9}, {3.867960290207657*^9, 3.867960290424945*^9}, 
   3.867960807752524*^9, 3.867961627283046*^9, 3.867961873607213*^9, 
   3.867961945663623*^9, 3.867962752496793*^9, 3.867963267650394*^9, {
   3.867987226727892*^9, 3.867987239341164*^9}, {3.867987314072206*^9, 
   3.8679873291130953`*^9}, {3.868076159807094*^9, 3.868076260655521*^9}, {
   3.868076301992363*^9, 3.868076571658299*^9}, {3.868076627668981*^9, 
   3.8680766957162437`*^9}, {3.8680767284530373`*^9, 
   3.8680768433617487`*^9}, {3.868076905851973*^9, 3.868076956492077*^9}, 
   3.8680773095519533`*^9, {3.868077424548505*^9, 3.868077447071012*^9}, {
   3.868077507485976*^9, 3.868077551175475*^9}, {3.868077622935583*^9, 
   3.8680776271477222`*^9}, {3.8680776734341993`*^9, 
   3.8680776925837297`*^9}, {3.8680777411673403`*^9, 
   3.8680777849992113`*^9}, {3.868077946804216*^9, 3.868077974152956*^9}, {
   3.868078207798397*^9, 3.868078212313808*^9}, {3.868078352894875*^9, 
   3.868078360322097*^9}, {3.8680785208881283`*^9, 3.8680785219447803`*^9}, {
   3.868079168878536*^9, 3.868079250666349*^9}, {3.868079288105028*^9, 
   3.868079294814838*^9}, {3.86807936582477*^9, 3.868079424334763*^9}, {
   3.868079550016354*^9, 3.8680795514719687`*^9}, {3.868079607432931*^9, 
   3.868079623337034*^9}, {3.8680803730785*^9, 3.8680803733996983`*^9}, {
   3.8681743384602957`*^9, 
   3.8681743389382544`*^9}},ExpressionUUID->"d4825404-4ccd-4c99-83e5-\
cde7dfc5207d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Basic data structures.", "Item",
 AutoGeneratedPackage->Automatic,
 InitializationCell->True,
 CellChangeTimes->{{3.86782665299482*^9, 3.867826679658079*^9}, {
   3.867826719872582*^9, 3.867826760863641*^9}, {3.867826913164385*^9, 
   3.867826914181082*^9}, {3.867827096234043*^9, 3.8678271014739943`*^9}, {
   3.86782794336696*^9, 3.8678279459413233`*^9}, {3.867987287971356*^9, 
   3.867987307489421*^9}, {3.8679876329387283`*^9, 3.867987638418292*^9}, 
   3.867987673859956*^9},ExpressionUUID->"b3046d9d-17c8-4a40-b5dc-\
2e2c469225e9"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"blankpredictorcontainer", "[", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "forecast", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"forecast", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", "npredictors"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"blankpredictorcontainer", "[", "init_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "forecast", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"forecast", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"init", ",", "npredictors"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"blankquestion", "[", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "question", ",", "\[IndentingNewLine]", "p", ",", "m", ",", "v", ",", 
        "q", ",", "s", ",", "r"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"p", "=", 
        RowBox[{"blankpredictorcontainer", "[", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"v", "=", 
        RowBox[{"blankpredictorcontainer", "[", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"q", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"s", "=", 
        RowBox[{"blankpredictorcontainer", "[", "Indeterminate", "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{"blankpredictorcontainer", "[", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"question", "=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
         "p", ",", "\[IndentingNewLine]", "m", ",", "\[IndentingNewLine]", 
          "v", ",", "\[IndentingNewLine]", "q", ",", "\[IndentingNewLine]", 
          "s", ",", "\[IndentingNewLine]", "r"}], "\[IndentingNewLine]", 
         "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "question"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"blankexperiment", "[", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "experiment", ",", "\[IndentingNewLine]", "p", ",", "m", ",", "v", ",",
         "q", ",", "s"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"experiment", "=", 
       RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 AutoGeneratedPackage->Automatic,
 InitializationCell->True,
 CellChangeTimes->{{3.867839556779538*^9, 3.86783971669942*^9}, {
   3.867839817893618*^9, 3.867839844338642*^9}, {3.8678399883343353`*^9, 
   3.867839994183217*^9}, {3.867840034598239*^9, 3.867840223594935*^9}, {
   3.8678402547230873`*^9, 3.867840362948492*^9}, {3.867840399638172*^9, 
   3.867840433574916*^9}, {3.86784050758362*^9, 3.867840524696947*^9}, {
   3.8678405557863293`*^9, 3.8678405569441023`*^9}, 3.8678405962472982`*^9, {
   3.8678406395633507`*^9, 3.867840680530445*^9}, {3.867840778482031*^9, 
   3.867840782156289*^9}, {3.867840985077559*^9, 3.867840986584888*^9}, {
   3.867841086953157*^9, 3.8678411291715813`*^9}, {3.867841210815301*^9, 
   3.867841257196693*^9}, {3.867841288757958*^9, 3.8678413135762367`*^9}, {
   3.86784135102556*^9, 3.867841414093575*^9}, {3.867841445900641*^9, 
   3.867841507714361*^9}, {3.867841546675437*^9, 3.8678415512703123`*^9}, 
   3.8678417876094227`*^9, 3.867841826084988*^9, 3.867841992365144*^9, {
   3.867842326134549*^9, 3.8678424081666813`*^9}, {3.8678424820440397`*^9, 
   3.8678425111858883`*^9}, {3.8678425573314877`*^9, 3.867842561434742*^9}, {
   3.867842600477272*^9, 3.8678426037866783`*^9}, {3.867842908948868*^9, 
   3.8678430012208223`*^9}, {3.867843120569776*^9, 3.867843121338312*^9}, {
   3.867843242491817*^9, 3.867843242748021*^9}, {3.867843302067933*^9, 
   3.867843459899021*^9}, {3.8678435137771387`*^9, 3.8678435361110573`*^9}, {
   3.8678436251002283`*^9, 3.867843626475198*^9}, {3.867843660710587*^9, 
   3.8678436744453163`*^9}, {3.867843886779848*^9, 3.867843937111661*^9}, {
   3.867843981069556*^9, 3.8678441624720583`*^9}, {3.8678442031803427`*^9, 
   3.8678443174710283`*^9}, {3.867844403432073*^9, 3.8678445873305883`*^9}, {
   3.867844952431409*^9, 3.8678450335012197`*^9}, {3.86784516677407*^9, 
   3.867845169990252*^9}, 3.867845310221945*^9, {3.867947072315124*^9, 
   3.867947103078915*^9}, {3.867947155674634*^9, 3.867947230091071*^9}, {
   3.867947266733069*^9, 3.867947468767706*^9}, {3.8679477385590487`*^9, 
   3.867947760055182*^9}, {3.867948487324896*^9, 3.86794849850454*^9}, {
   3.867948595560459*^9, 3.867948603837001*^9}, {3.8679486536342793`*^9, 
   3.8679487383003263`*^9}, 3.867948812991971*^9, {3.867948993240115*^9, 
   3.867949005483585*^9}, {3.8679490756632957`*^9, 3.8679491190736713`*^9}, {
   3.8679491721343517`*^9, 3.867949183416431*^9}, {3.8679492599345512`*^9, 
   3.86794930285607*^9}, {3.867949337874402*^9, 3.8679493557880898`*^9}, 
   3.8679493862825623`*^9, {3.8679494204413977`*^9, 3.867949440768952*^9}, {
   3.8679495051984673`*^9, 3.8679495176141977`*^9}, {3.867949568431567*^9, 
   3.867949682443696*^9}, {3.8679498497117367`*^9, 3.8679498508272*^9}, {
   3.867950031920157*^9, 3.8679501419257*^9}, {3.8679501751605883`*^9, 
   3.867950248352376*^9}, {3.867950279184771*^9, 3.8679503589949093`*^9}, {
   3.8679503966221867`*^9, 3.867950604205991*^9}, {3.8679509105831423`*^9, 
   3.867950910869914*^9}, {3.867951233341481*^9, 3.867951348045537*^9}, 
   3.8679516400126038`*^9, {3.867952130752075*^9, 3.867952312433839*^9}, {
   3.867952730534876*^9, 3.8679527307093782`*^9}, {3.8679528175021563`*^9, 
   3.867952838419829*^9}, {3.86795287552771*^9, 3.867952875752101*^9}, {
   3.8679529159284678`*^9, 3.86795304812388*^9}, {3.867953081326301*^9, 
   3.867953120626614*^9}, {3.867953190782568*^9, 3.86795319135686*^9}, {
   3.86795324634964*^9, 3.867953246996345*^9}, {3.867953345561599*^9, 
   3.867953440098195*^9}, {3.867953478583403*^9, 3.8679534942523108`*^9}, {
   3.867953562436316*^9, 3.867953570199769*^9}, {3.867960046896214*^9, 
   3.86796004703658*^9}, {3.867960290207657*^9, 3.867960290424945*^9}, 
   3.867960807752524*^9, 3.867961627283046*^9, 3.867961873607213*^9, 
   3.867961945663623*^9, 3.867962752496793*^9, 3.867963267650394*^9, {
   3.867987226727892*^9, 3.867987239341164*^9}, {3.867987314072206*^9, 
   3.8679873291130953`*^9}, {3.867987398898814*^9, 3.867987432980686*^9}, {
   3.867987465288266*^9, 3.867987560420146*^9}, {3.867987600458206*^9, 
   3.867987602542053*^9}, {3.867987646213932*^9, 3.867987651080409*^9}, 
   3.868172047423807*^9},ExpressionUUID->"34e622fe-db86-4dab-b4bd-\
2eff197d486a"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8681720409073467`*^9, 
  3.868172045163191*^9}},ExpressionUUID->"553c7cd7-c376-4839-ab5f-\
a0a87159f3cf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Functions for experiment loop", "Item",
 AutoGeneratedPackage->Automatic,
 InitializationCell->True,
 CellChangeTimes->{{3.86782665299482*^9, 3.867826679658079*^9}, {
  3.867826719872582*^9, 3.867826760863641*^9}, {3.867826913164385*^9, 
  3.867826914181082*^9}, {3.867827096234043*^9, 3.8678271014739943`*^9}, {
  3.86782794336696*^9, 3.8678279459413233`*^9}, {3.867987287971356*^9, 
  3.867987307489421*^9}, {3.8679876329387283`*^9, 3.867987638418292*^9}, {
  3.8679876868678417`*^9, 
  3.8679877304102716`*^9}},ExpressionUUID->"e7fa18bb-26fb-42e3-aad7-\
0a8294813414"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"askquestion", ",", "HoldAll"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"predict", ",", "HoldAll"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"measure", ",", "HoldAll"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"resolve", ",", "HoldAll"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"outcome", ",", "HoldAll"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"surprisal", ",", "HoldAll"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"reward", ",", "HoldAll"}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"predict", "[", 
     RowBox[{"experiment_", ",", "newquestion_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "p", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"p", "=", 
        RowBox[{"PREDICT", "[", "experiment", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"newquestion", "=", 
        RowBox[{"newquestion", "//", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"1", "\[Rule]", "p"}], "]"}]}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"measure", "[", "newquestion_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "m", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m", "=", 
        RowBox[{"MEASURE", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newquestion", "=", 
        RowBox[{"newquestion", "//", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"2", "\[Rule]", "m"}], "]"}]}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"resolve", "[", 
     RowBox[{"experiment_", ",", "newquestion_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "v", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"v", "=", 
        RowBox[{"RESOLVE", "[", 
         RowBox[{"experiment", ",", "newquestion"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"newquestion", "=", 
        RowBox[{"newquestion", "//", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"3", "\[Rule]", "v"}], "]"}]}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"outcome", "[", "newquestion_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "q", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"q", "=", 
        RowBox[{"Outcome", "[", "newquestion", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"newquestion", "=", 
        RowBox[{"newquestion", "//", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"4", "\[Rule]", "q"}], "]"}]}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"surprisal", "[", "newquestion_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "s", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", "=", 
        RowBox[{"Surprisal", "[", "newquestion", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"newquestion", "=", 
        RowBox[{"newquestion", "//", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"5", "\[Rule]", "s"}], "]"}]}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"reward", "[", "newquestion_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "r", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "=", 
        RowBox[{"Reward", "[", "newquestion", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"newquestion", "=", 
        RowBox[{"newquestion", "//", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"6", "\[Rule]", "r"}], "]"}]}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"askquestion", "[", "experiment_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newquestion", "=", 
        RowBox[{"blankquestion", "[", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"predict", "[", 
        RowBox[{"experiment", ",", "newquestion"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"measure", "[", "newquestion", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"resolve", "[", 
        RowBox[{"experiment", ",", "newquestion"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"outcome", "[", "newquestion", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"surprisal", "[", "newquestion", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"reward", "[", "newquestion", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"experiment", ",", "newquestion"}], "]"}]}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 AutoGeneratedPackage->Automatic,
 InitializationCell->True,
 CellChangeTimes->{{3.867839556779538*^9, 3.86783971669942*^9}, {
   3.867839817893618*^9, 3.867839844338642*^9}, {3.8678399883343353`*^9, 
   3.867839994183217*^9}, {3.867840034598239*^9, 3.867840223594935*^9}, {
   3.8678402547230873`*^9, 3.867840362948492*^9}, {3.867840399638172*^9, 
   3.867840433574916*^9}, {3.86784050758362*^9, 3.867840524696947*^9}, {
   3.8678405557863293`*^9, 3.8678405569441023`*^9}, 3.8678405962472982`*^9, {
   3.8678406395633507`*^9, 3.867840680530445*^9}, {3.867840778482031*^9, 
   3.867840782156289*^9}, {3.867840985077559*^9, 3.867840986584888*^9}, {
   3.867841086953157*^9, 3.8678411291715813`*^9}, {3.867841210815301*^9, 
   3.867841257196693*^9}, {3.867841288757958*^9, 3.8678413135762367`*^9}, {
   3.86784135102556*^9, 3.867841414093575*^9}, {3.867841445900641*^9, 
   3.867841507714361*^9}, {3.867841546675437*^9, 3.8678415512703123`*^9}, 
   3.8678417876094227`*^9, 3.867841826084988*^9, 3.867841992365144*^9, {
   3.867842326134549*^9, 3.8678424081666813`*^9}, {3.8678424820440397`*^9, 
   3.8678425111858883`*^9}, {3.8678425573314877`*^9, 3.867842561434742*^9}, {
   3.867842600477272*^9, 3.8678426037866783`*^9}, {3.867842908948868*^9, 
   3.8678430012208223`*^9}, {3.867843120569776*^9, 3.867843121338312*^9}, {
   3.867843242491817*^9, 3.867843242748021*^9}, {3.867843302067933*^9, 
   3.867843459899021*^9}, {3.8678435137771387`*^9, 3.8678435361110573`*^9}, {
   3.8678436251002283`*^9, 3.867843626475198*^9}, {3.867843660710587*^9, 
   3.8678436744453163`*^9}, {3.867843886779848*^9, 3.867843937111661*^9}, {
   3.867843981069556*^9, 3.8678441624720583`*^9}, {3.8678442031803427`*^9, 
   3.8678443174710283`*^9}, {3.867844403432073*^9, 3.8678445873305883`*^9}, {
   3.867844952431409*^9, 3.8678450335012197`*^9}, {3.86784516677407*^9, 
   3.867845169990252*^9}, 3.867845310221945*^9, {3.867947072315124*^9, 
   3.867947103078915*^9}, {3.867947155674634*^9, 3.867947230091071*^9}, {
   3.867947266733069*^9, 3.867947468767706*^9}, {3.8679477385590487`*^9, 
   3.867947760055182*^9}, {3.867948487324896*^9, 3.86794849850454*^9}, {
   3.867948595560459*^9, 3.867948603837001*^9}, {3.8679486536342793`*^9, 
   3.8679487383003263`*^9}, 3.867948812991971*^9, {3.867948993240115*^9, 
   3.867949005483585*^9}, {3.8679490756632957`*^9, 3.8679491190736713`*^9}, {
   3.8679491721343517`*^9, 3.867949183416431*^9}, {3.8679492599345512`*^9, 
   3.86794930285607*^9}, {3.867949337874402*^9, 3.8679493557880898`*^9}, 
   3.8679493862825623`*^9, {3.8679494204413977`*^9, 3.867949440768952*^9}, {
   3.8679495051984673`*^9, 3.8679495176141977`*^9}, {3.867949568431567*^9, 
   3.867949682443696*^9}, {3.8679498497117367`*^9, 3.8679498508272*^9}, {
   3.867950031920157*^9, 3.8679501419257*^9}, {3.8679501751605883`*^9, 
   3.867950248352376*^9}, {3.867950279184771*^9, 3.8679503589949093`*^9}, {
   3.8679503966221867`*^9, 3.867950604205991*^9}, {3.8679509105831423`*^9, 
   3.867950910869914*^9}, {3.867951233341481*^9, 3.867951348045537*^9}, 
   3.8679516400126038`*^9, {3.867952130752075*^9, 3.867952312433839*^9}, {
   3.867952730534876*^9, 3.8679527307093782`*^9}, {3.8679528175021563`*^9, 
   3.867952838419829*^9}, {3.86795287552771*^9, 3.867952875752101*^9}, {
   3.8679529159284678`*^9, 3.86795304812388*^9}, {3.867953081326301*^9, 
   3.867953120626614*^9}, {3.867953190782568*^9, 3.86795319135686*^9}, {
   3.86795324634964*^9, 3.867953246996345*^9}, {3.867953345561599*^9, 
   3.867953440098195*^9}, {3.867953478583403*^9, 3.8679534942523108`*^9}, {
   3.867953562436316*^9, 3.867953570199769*^9}, {3.867960046896214*^9, 
   3.86796004703658*^9}, {3.867960290207657*^9, 3.867960290424945*^9}, 
   3.867960807752524*^9, 3.867961627283046*^9, 3.867961873607213*^9, 
   3.867961945663623*^9, 3.867962752496793*^9, 3.867963267650394*^9, {
   3.867987226727892*^9, 3.867987239341164*^9}, {3.867987314072206*^9, 
   3.8679873291130953`*^9}, {3.867987398898814*^9, 3.867987432980686*^9}, {
   3.867987465288266*^9, 3.867987560420146*^9}, {3.867987600458206*^9, 
   3.867987602542053*^9}, {3.867987646213932*^9, 3.867987651080409*^9}, {
   3.867987761536182*^9, 3.867987766202763*^9}, {3.867989802450098*^9, 
   3.86798980307964*^9}, {3.867989849520782*^9, 3.8679898572317*^9}, 
   3.867990677328334*^9, 3.867990922494482*^9, {3.868076984923204*^9, 
   3.868077032568631*^9}, {3.868078306010187*^9, 
   3.868078315297812*^9}},ExpressionUUID->"c3e748d7-81c0-4746-beec-\
0ca6ef7db3ce"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Experiment functions: default definitions, utilities to set default of user \
defined version \
\>", "Item",
 AutoGeneratedPackage->Automatic,
 InitializationCell->True,
 CellChangeTimes->{{3.86782665299482*^9, 3.867826679658079*^9}, {
  3.867826719872582*^9, 3.867826760863641*^9}, {3.867826913164385*^9, 
  3.867826914181082*^9}, {3.867827096234043*^9, 3.8678271014739943`*^9}, {
  3.86782794336696*^9, 3.8678279459413233`*^9}, {3.867987287971356*^9, 
  3.867987307489421*^9}, {3.8679876329387283`*^9, 3.867987638418292*^9}, {
  3.8679876868678417`*^9, 3.8679877304102716`*^9}, {3.867988162744157*^9, 
  3.8679882080820293`*^9}, {3.867988723338694*^9, 3.867988772640779*^9}, {
  3.867989480373074*^9, 3.867989483939472*^9}, {3.8679951539609833`*^9, 
  3.867995227878439*^9}},ExpressionUUID->"44957540-6c80-403d-a201-\
e7d6d0e250ea"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"defaultforecastinit", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Random", "[", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "npredictors"}], "}"}]}], "]"}]}], ";", 
    RowBox[{"Protect", "[", "defaultforecastinit", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DefaultPredict", "[", "exp_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ipredictor", ",", 
        RowBox[{"n", "=", 
         RowBox[{"(", 
          RowBox[{"exp", "//", "Length"}], ")"}]}], ",", "\[Rho]new", ",", 
        RowBox[{"RHOnew", "=", 
         RowBox[{"{", "}"}]}]}], "}"}], ",", 
      RowBox[{"(*", 
       RowBox[{"internal", " ", "variables"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ipredictor", "=", "1"}], ",", 
         RowBox[{"ipredictor", "\[LessEqual]", "npredictors"}], ",", 
         RowBox[{"ipredictor", "++"}], ",", 
         RowBox[{"(*", 
          RowBox[{"loop", " ", "over", " ", "users"}], "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "to", " ", "execute", " ", "commands", " ", "that", " ", 
              "depend", " ", "on", " ", "the", " ", "question", " ", 
              RowBox[{"number", " ", "'"}], "n"}], "+", 
             RowBox[{"1", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"n", "\[Equal]", "0"}], ",", 
            RowBox[{"(*", "if", "*)"}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"\[Rho]new", "=", 
             RowBox[{"defaultforecastinit", "[", 
              RowBox[{"[", "ipredictor", "]"}], "]"}]}], ",", 
            RowBox[{"(*", "then", "*)"}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"\[Rho]new", "=", 
             RowBox[{"exp", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "1", ",", "ipredictor"}], "]"}], "]"}]}]}], 
           RowBox[{"(*", "else", "*)"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"RHOnew", ",", "\[Rho]new"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "RHOnew"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DefaultMeasure", "[", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Random", "[", "]"}], "//", 
       RowBox[{
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"#", "<", "0.4"}], ",", "1", ",", "True", ",", 
          RowBox[{"-", "1"}]}], "]"}], "&"}]}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"to", " ", "match", " ", "function", " ", "prototype"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DefaultResolve", "[", 
      RowBox[{"experiment_", ",", "question_"}], "]"}], ":=", 
     RowBox[{"DefaultResolve", "[", "question", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"actual", " ", "function"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DefaultResolve", "[", "question_", "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Random", "[", "]"}], "//", 
       RowBox[{
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"#", "<", "0.05"}], ",", 
          RowBox[{"-", 
           RowBox[{"question", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", "True", ",", 
          RowBox[{"question", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{
         RowBox[{"question", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "//", "Length"}]}], "}"}]}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetDefaultFunctions", "[", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PREDICT", "=", "DefaultPredict"}], ";", "\[IndentingNewLine]", 
       RowBox[{"MEASURE", "=", "DefaultMeasure"}], ";", "\[IndentingNewLine]", 
       RowBox[{"RESOLVE", "=", "DefaultResolve"}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"Unprotect", "[", "FunctionsAreInitizialed", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"FunctionsAreInitizialed", "=", "True"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Protect", "[", "FunctionsAreInitizialed", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetUserFunctions", "[", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"isprotected", "=", 
        RowBox[{
         RowBox[{"FunctionsAreInitizialed", "//", "Attributes"}], "//", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"#", ",", "Protected"}], "]"}], "&"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Names", "[", "\"\<Global`UserPredict\>\"", "]"}], ";"}], 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PREDICT", "=", "UserPredict"}], ";", "\[IndentingNewLine]", 
       RowBox[{"MEASURE", "=", "UserMeasure"}], ";", "\[IndentingNewLine]", 
       RowBox[{"RESOLVE", "=", "UserResolve"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Unprotect", "[", "FunctionsAreInitizialed", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"FunctionsAreInitizialed", "=", "True"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Protect", "[", "FunctionsAreInitizialed", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 AutoGeneratedPackage->Automatic,
 InitializationCell->True,
 CellChangeTimes->{{3.867951433324541*^9, 3.8679515561085577`*^9}, {
   3.8679515944701653`*^9, 3.867951609820003*^9}, {3.867951699644586*^9, 
   3.867951758234036*^9}, {3.867951799015916*^9, 3.867951900868668*^9}, {
   3.867951949382107*^9, 3.867952009279662*^9}, {3.867952366992404*^9, 
   3.8679523670919943`*^9}, {3.867952506688324*^9, 3.867952562485978*^9}, {
   3.867952667770155*^9, 3.867952698606722*^9}, {3.867957093928903*^9, 
   3.867957146233449*^9}, {3.867986608200712*^9, 3.8679866361083927`*^9}, 
   3.867986678409566*^9, {3.867986714429737*^9, 3.867986850939629*^9}, {
   3.86798863775637*^9, 3.867988672773554*^9}, {3.867988709074626*^9, 
   3.867988713749967*^9}, {3.867988823992854*^9, 3.867988858458221*^9}, {
   3.867988926492955*^9, 3.867989000620612*^9}, {3.867989031024623*^9, 
   3.86798903568857*^9}, {3.867989103473778*^9, 3.867989248158526*^9}, {
   3.867989282204591*^9, 3.8679893858598423`*^9}, {3.86798943360681*^9, 
   3.86798945435227*^9}, {3.867989558359522*^9, 3.867989625530034*^9}, {
   3.8679898891689453`*^9, 3.867989936649807*^9}, {3.867990846029047*^9, 
   3.867990872259459*^9}, {3.86799170975084*^9, 3.867991715956106*^9}, {
   3.867991831805282*^9, 3.8679918456813297`*^9}, {3.8679919052951612`*^9, 
   3.867991978207057*^9}, {3.86799220085524*^9, 3.8679922054928627`*^9}, {
   3.8679923923234873`*^9, 3.8679924107536573`*^9}, {3.867992454007176*^9, 
   3.867992454453176*^9}, {3.867992629048108*^9, 3.867992630794241*^9}, {
   3.867992664948914*^9, 3.867992679836934*^9}, {3.8679931849205313`*^9, 
   3.8679932089183273`*^9}, {3.867995251270355*^9, 3.867995364935664*^9}, {
   3.867995544110949*^9, 3.867995614008024*^9}, {3.8679960284063253`*^9, 
   3.867996053089019*^9}, 3.867996096030203*^9, {3.867996335807345*^9, 
   3.867996387359149*^9}},ExpressionUUID->"f5345bad-bae2-4e01-be18-\
d0ebe0111c25"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Internal functions for plots", "Item",
 AutoGeneratedPackage->Automatic,
 InitializationCell->True,
 CellChangeTimes->{{3.86782665299482*^9, 3.867826679658079*^9}, {
  3.867826719872582*^9, 3.867826760863641*^9}, {3.867826913164385*^9, 
  3.867826914181082*^9}, {3.867827096234043*^9, 3.8678271014739943`*^9}, {
  3.86782794336696*^9, 3.8678279459413233`*^9}, {3.867987287971356*^9, 
  3.867987307489421*^9}, {3.8679876329387283`*^9, 3.867987638418292*^9}, {
  3.8679876868678417`*^9, 3.8679877304102716`*^9}, {3.86798777037665*^9, 
  3.8679877752967453`*^9}, {3.868006136364522*^9, 
  3.868006147813599*^9}},ExpressionUUID->"b769cc7d-2f3f-4b68-8522-\
e238fd34e29a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PLOTSTYLE1", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ASPECTRATIO", "\[Rule]", 
      RowBox[{"5", "/", "8"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"IMAGESIZE", "\[Rule]", "360"}], ",", "\[IndentingNewLine]", 
     RowBox[{"IMAGEPADDING", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "20"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", "20"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PLOTRANGEPADDING", "->", 
      RowBox[{"Scaled", "[", ".1", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"PLOTMARKERS", "\[Rule]", "\"\<OpenMarkers\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PLOTRANGE", "\[Rule]", "Full"}], ",", "\[IndentingNewLine]", 
     RowBox[{"LABELSTYLE", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", "Bold", ",", "Medium"}], "]"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PLOTSTYLE2", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ASPECTRATIO", "\[Rule]", 
       RowBox[{"5", "/", "8"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"IMAGESIZE", "\[Rule]", "400"}], ",", "\[IndentingNewLine]", 
      RowBox[{"IMAGEPADDING", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "20"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", "20"}], "}"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PLOTRANGEPADDING", "->", 
       RowBox[{"Scaled", "[", ".1", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"PLOTMARKERS", "\[Rule]", "\"\<OpenMarkers\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PLOTRANGE", "\[Rule]", "Full"}], ",", "\[IndentingNewLine]", 
      RowBox[{"LABELSTYLE", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", "Bold", ",", "Medium"}], "]"}]}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pPlot", "[", "iexperiment_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"EXPERIMENT", "[", 
         RowBox[{"[", 
          RowBox[{"iexperiment", ",", "All", ",", "1"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "i"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "npredictors"}], "}"}]}], "]"}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{"ListLogLinearPlot", "[", 
        RowBox[{"#", ",", 
         RowBox[{"AspectRatio", "\[Rule]", "ASPECTRATIO"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "IMAGESIZE"}], ",", 
         RowBox[{"ImagePadding", "\[Rule]", "IMAGEPADDING"}], ",", 
         RowBox[{"PlotRangePadding", "->", "PLOTRANGEPADDING"}], ",", 
         RowBox[{"PlotMarkers", "\[Rule]", "PLOTMARKERS"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "PLOTRANGE"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<j\>\"", ",", 
            "\"\<\!\(\*SubscriptBox[\(p\), \(\(\\\ \)\(i\\\ j\)\)]\)\>\""}], 
           "}"}]}], ",", 
         RowBox[{"LabelStyle", "\[Rule]", "LABELSTYLE"}]}], "]"}], "&"}], "/.",
       "PLOTSTYLE1"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"mPlot", "[", "iexperiment_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"EXPERIMENT", "[", 
       RowBox[{"[", 
        RowBox[{"iexperiment", ",", "All", ",", "2"}], "]"}], "]"}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{"ListLogLinearPlot", "[", 
         RowBox[{"#", ",", 
          RowBox[{"AspectRatio", "\[Rule]", "ASPECTRATIO"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "IMAGESIZE"}], ",", 
          RowBox[{"ImagePadding", "\[Rule]", "IMAGEPADDING"}], ",", 
          RowBox[{"PlotRangePadding", "->", "PLOTRANGEPADDING"}], ",", 
          RowBox[{"PlotMarkers", "\[Rule]", "PLOTMARKERS"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "PLOTRANGE"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<j\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(m\), \(\(\\\ \)\(j\)\)]\)\>\""}], 
            "}"}]}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", "LABELSTYLE"}]}], "]"}], "&"}], "/.",
        "PLOTSTYLE1"}]}], ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"vPlot", "[", "iexperiment_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"EXPERIMENT", "[", 
          RowBox[{"[", 
           RowBox[{"iexperiment", ",", "All", ",", "3"}], "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "i"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "npredictors"}], "}"}]}], "]"}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{"ListLogLinearPlot", "[", 
         RowBox[{"#", ",", 
          RowBox[{"AspectRatio", "\[Rule]", "ASPECTRATIO"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "IMAGESIZE"}], ",", 
          RowBox[{"ImagePadding", "\[Rule]", "IMAGEPADDING"}], ",", 
          RowBox[{"PlotRangePadding", "->", "PLOTRANGEPADDING"}], ",", 
          RowBox[{"PlotMarkers", "\[Rule]", "PLOTMARKERS"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "PLOTRANGE"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<j\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(v\), \(\(\\\ \)\(i\\\ j\)\)]\)\>\""}], 
            "}"}]}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", "LABELSTYLE"}]}], "]"}], "&"}], "/.",
        "PLOTSTYLE1"}]}], ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"qPlot", "[", "iexperiment_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"EXPERIMENT", "[", 
       RowBox[{"[", 
        RowBox[{"iexperiment", ",", "All", ",", "4"}], "]"}], "]"}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{"ListLogLinearPlot", "[", 
         RowBox[{"#", ",", 
          RowBox[{"AspectRatio", "\[Rule]", "ASPECTRATIO"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "IMAGESIZE"}], ",", 
          RowBox[{"ImagePadding", "\[Rule]", "IMAGEPADDING"}], ",", 
          RowBox[{"PlotRangePadding", "->", "PLOTRANGEPADDING"}], ",", 
          RowBox[{"PlotMarkers", "\[Rule]", "PLOTMARKERS"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "PLOTRANGE"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<j\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(q\), \(\(\\\ \)\(j\)\)]\)\>\""}], 
            "}"}]}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", "LABELSTYLE"}]}], "]"}], "&"}], "/.",
        "PLOTSTYLE1"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sPlot", "[", "iexperiment_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"EXPERIMENT", "[", 
          RowBox[{"[", 
           RowBox[{"iexperiment", ",", "All", ",", "5"}], "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "i"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "npredictors"}], "}"}]}], "]"}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{"ListLogLinearPlot", "[", 
         RowBox[{"#", ",", 
          RowBox[{"AspectRatio", "\[Rule]", "ASPECTRATIO"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "IMAGESIZE"}], ",", 
          RowBox[{"ImagePadding", "\[Rule]", "IMAGEPADDING"}], ",", 
          RowBox[{"PlotRangePadding", "->", "PLOTRANGEPADDING"}], ",", 
          RowBox[{"PlotMarkers", "\[Rule]", "PLOTMARKERS"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "PLOTRANGE"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<j\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(s\), \(\(\\\ \)\(i\\\ j\)\)]\)\>\""}], 
            "}"}]}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", "LABELSTYLE"}]}], "]"}], "&"}], "/.",
        "PLOTSTYLE1"}]}], ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rPlot", "[", "iexperiment_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"EXPERIMENT", "[", 
          RowBox[{"[", 
           RowBox[{"iexperiment", ",", "All", ",", "6"}], "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "i"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "npredictors"}], "}"}]}], "]"}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{"ListLogLogPlot", "[", 
         RowBox[{"#", ",", 
          RowBox[{"AspectRatio", "\[Rule]", "ASPECTRATIO"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "IMAGESIZE"}], ",", 
          RowBox[{"ImagePadding", "\[Rule]", "IMAGEPADDING"}], ",", 
          RowBox[{"PlotRangePadding", "->", "PLOTRANGEPADDING"}], ",", 
          RowBox[{"PlotMarkers", "\[Rule]", "PLOTMARKERS"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "PLOTRANGE"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<j\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(r\), \(\(\\\ \)\(i\\\ j\)\)]\)\>\""}], 
            "}"}]}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", "LABELSTYLE"}]}], "]"}], "&"}], "/.",
        "PLOTSTYLE1"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sStatPlot", "[", "iexperiment_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Around", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"EXPERIMENT", "[", 
             RowBox[{"[", 
              RowBox[{"iexperiment", ",", "All", ",", "5"}], "]"}], "]"}], 
            "[", 
            RowBox[{"[", "i", "]"}], "]"}], "//", "Mean"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"EXPERIMENT", "[", 
             RowBox[{"[", 
              RowBox[{"iexperiment", ",", "All", ",", "5"}], "]"}], "]"}], 
            "[", 
            RowBox[{"[", "i", "]"}], "]"}], "//", "StandardDeviation"}]}], 
         "]"}], ")"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
          RowBox[{"EXPERIMENT", "[", 
           RowBox[{"[", 
            RowBox[{"iexperiment", ",", "All", ",", "5"}], "]"}], "]"}], "//",
           "Length"}]}], "}"}]}], "]"}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{"ListLogLinearPlot", "[", 
        RowBox[{"#", ",", 
         RowBox[{"AspectRatio", "\[Rule]", "ASPECTRATIO"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "IMAGESIZE"}], ",", 
         RowBox[{"ImagePadding", "\[Rule]", "IMAGEPADDING"}], ",", 
         RowBox[{"PlotRangePadding", "->", "PLOTRANGEPADDING"}], ",", 
         RowBox[{"PlotMarkers", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"marker1", ",", "0.016"}], "}"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Directive", "[", "Red", "]"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "PLOTRANGE"}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<j\>\"", ",", 
            "\"\<\!\(\*SubscriptBox[\(s\), \(\(\\\ \)\(j\)\)]\)\>\""}], 
           "}"}]}], ",", 
         RowBox[{"LabelStyle", "\[Rule]", "LABELSTYLE"}]}], 
        RowBox[{"(*", 
         RowBox[{",", 
          RowBox[{"Epilog", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", "Thick"}], "]"}], ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "prob"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"100", ",", "prob"}], "}"}]}], "}"}], "]"}]}], 
            "}"}]}]}], "*)"}], "]"}], "&"}], "/.", "PLOTSTYLE1"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"marker1", "=", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Blue", ",", 
      RowBox[{"Disk", "[", "]"}]}], "}"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.868003737315847*^9, 3.868003908899061*^9}, {
   3.8680042523793173`*^9, 3.868004266086935*^9}, 3.868006065082336*^9, {
   3.8680061626506853`*^9, 3.868006164835198*^9}, {3.86800667391877*^9, 
   3.868006817142919*^9}, {3.868009959502586*^9, 3.868009959645041*^9}, {
   3.8680101262945347`*^9, 3.8680101263957663`*^9}, {3.868010288316918*^9, 
   3.868010294679228*^9}, {3.868010329566607*^9, 3.868010329686008*^9}, {
   3.8680116804107437`*^9, 3.8680116807210827`*^9}, {3.868012187049424*^9, 
   3.8680121878941727`*^9}, {3.86801223046253*^9, 3.868012232617477*^9}, {
   3.868012969817749*^9, 3.868012971901722*^9}, {3.86801342977002*^9, 
   3.8680134446849937`*^9}, {3.868013510186872*^9, 3.868013511182969*^9}, {
   3.8680353858441677`*^9, 3.868035396312697*^9}, {3.86807705826959*^9, 
   3.8680770954632483`*^9}, {3.868080061431677*^9, 
   3.86808006518601*^9}},ExpressionUUID->"28f2bd49-8456-4bd7-80b7-\
11e17f18fb4b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["User level functions.", "Item",
 AutoGeneratedPackage->Automatic,
 InitializationCell->True,
 CellChangeTimes->{{3.86782665299482*^9, 3.867826679658079*^9}, {
  3.867826719872582*^9, 3.867826760863641*^9}, {3.867826913164385*^9, 
  3.867826914181082*^9}, {3.867827096234043*^9, 3.8678271014739943`*^9}, {
  3.86782794336696*^9, 3.8678279459413233`*^9}, {3.867987287971356*^9, 
  3.867987307489421*^9}, {3.8679876329387283`*^9, 3.867987638418292*^9}, {
  3.8679876868678417`*^9, 3.8679877304102716`*^9}, {3.86798777037665*^9, 
  3.8679877752967453`*^9}},ExpressionUUID->"ef02d43d-59f1-47e7-b220-\
4a3cbb4ccebd"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"RunExperiment", "[", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"experiment", "=", 
         RowBox[{"blankexperiment", "[", "]"}]}], ",", "iquestion"}], "}"}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "to", " ", "set", "  ", "default", " ", "functions", " ", "if", " ", 
        "user", " ", "has", " ", "not", " ", "define", " ", "their", " ", 
        "own"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"!", "FunctionsAreInitizialed"}], ",", "\[IndentingNewLine]", 
         RowBox[{"SetDefaultFunctions", "[", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Unprotect", "[", "FunctionsAreInitizialed", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"FunctionsAreInitizialed", "=", "True"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Protect", "[", "FunctionsAreInitizialed", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"iquestion", "=", "1"}], ",", 
         RowBox[{"iquestion", "\[LessEqual]", "nquestions"}], ",", 
         RowBox[{"iquestion", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"askquestion", "[", "experiment", "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"PLOTS", "//", "Unprotect"}], ";", "\[IndentingNewLine]", 
       RowBox[{"EXPERIMENT", "//", "Unprotect"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"PLOTS", ",", "False"}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"EXPERIMENT", ",", "experiment"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"PLOTS", "//", "Protect"}], ";", "\[IndentingNewLine]", 
       RowBox[{"EXPERIMENT", "//", "Protect"}], ";"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakePlots", "[", "iexperiment_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"plots", "=", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"length", "=", 
         RowBox[{"(", 
          RowBox[{"EXPERIMENT", "//", "Length"}], ")"}]}], ",", 
        "cantdoplot"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"cond1", "=", 
         RowBox[{"!", 
          RowBox[{"TrueQ", "[", 
           RowBox[{
            RowBox[{"length", "<", 
             RowBox[{"iexperiment", "^", "2"}]}], "//", "Sqrt"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"cond2", "=", 
         RowBox[{"(", 
          RowBox[{"length", "\[Equal]", "0"}], ")"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"cond3", "=", 
         RowBox[{"(", 
          RowBox[{"!", 
           RowBox[{"IntegerQ", "[", "iexperiment", "]"}]}], ")"}]}], ";"}], 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cantdoplot", "=", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TrueQ", "[", 
           RowBox[{
            RowBox[{"length", "<", 
             RowBox[{"iexperiment", "^", "2"}]}], "//", "Sqrt"}], "]"}], "||",
           "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{"length", "\[Equal]", "0"}], ")"}], "||", 
          "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{"!", 
            RowBox[{"IntegerQ", "[", "iexperiment", "]"}]}], ")"}]}], 
         "\[IndentingNewLine]", ")"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{"cantdoplot", ",", 
         RowBox[{"(*", "if", "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Experiment i = \>\"", ",", "iexperiment", ",", 
           "\"\< no present.\>\""}], "]"}], ",", 
         RowBox[{"(*", "then", "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"plots", "=", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pPlot", "[", "iexperiment", "]"}], ",", " ", 
               RowBox[{"mPlot", "[", "iexperiment", "]"}], ",", 
               RowBox[{"vPlot", "[", "iexperiment", "]"}]}], "}"}], ",", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"qPlot", "[", "iexperiment", "]"}], ",", 
               RowBox[{"sPlot", "[", "iexperiment", "]"}], ",", 
               RowBox[{"rPlot", "[", "iexperiment", "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Nothing", ",", 
               RowBox[{"sStatPlot", "[", "iexperiment", "]"}], ",", 
               "Nothing"}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"plots", ",", 
              RowBox[{"pPlot", "[", "iexperiment", "]"}]}], "]"}], ";", 
            RowBox[{"(*", "else", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"plots", ",", 
              RowBox[{"mPlot", "[", "iexperiment", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"plots", ",", 
              RowBox[{"vPlot", "[", "iexperiment", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"plots", ",", 
              RowBox[{"qPlot", "[", "iexperiment", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"plots", ",", 
              RowBox[{"sPlot", "[", "iexperiment", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"plots", ",", 
              RowBox[{"rPlot", "[", "iexperiment", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"plots", ",", 
              RowBox[{"sStatPlot", "[", "iexperiment", "]"}]}], "]"}], ";"}], 
           "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"length", "=", 
             RowBox[{"(", 
              RowBox[{"PLOTS", "//", "Length"}], ")"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"While", "[", 
             RowBox[{
              RowBox[{"length", "<", "iexperiment"}], ",", "  ", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"PLOTS", ",", "0"}], "]"}], "  ", ";", 
               RowBox[{"length", "++"}]}]}], "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"PLOTS", "//", "Unprotect"}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"PLOTS", "[", 
            RowBox[{"[", "iexperiment", "]"}], "]"}], "=", "plots"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"PLOTS", "//", "Protect"}], ";"}]}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MakePlots", "[", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"length", "=", 
        RowBox[{"EXPERIMENT", "//", "Length"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"length", ">", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"MakePlots", "[", "length", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "\"\<No experiment to plot.\>\"", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ShowPlots", "[", "iexperiment_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"length", "=", 
         RowBox[{"PLOTS", "//", "Length"}]}], ",", 
        RowBox[{"indexissue", "=", "False"}], ",", 
        RowBox[{"notpresent", "=", "False"}], ",", "cantshowplot", ",", 
        "grid"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"indexissue", "=", "\[IndentingNewLine]", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TrueQ", "[", 
           RowBox[{"length", "<", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"iexperiment", "^", "2"}], "//", "Sqrt"}], ")"}]}], 
           "]"}], "||", "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{"length", "\[Equal]", "0"}], ")"}], "||", 
          "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{"!", 
            RowBox[{"IntegerQ", "[", "iexperiment", "]"}]}], ")"}]}], 
         "\[IndentingNewLine]", ")"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"notpresent", "=", 
        RowBox[{"Which", "[", 
         RowBox[{"indexissue", ",", "indexissue", ",", "True", ",", 
          RowBox[{"TrueQ", "[", 
           RowBox[{"!", 
            RowBox[{"PLOTS", "[", 
             RowBox[{"[", "iexperiment", "]"}], "]"}]}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"notpresent", ",", 
         RowBox[{"MakePlots", "[", "iexperiment", "]"}], ",", "Nothing"}], 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{"indexissue", ",", 
         RowBox[{"(*", "if", "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Plots i = \>\"", ",", "iexperiment", ",", 
            "\"\< not present.\>\""}], "]"}], ";", 
          RowBox[{"(*", "then", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"grid", "=", "0"}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"grid", "=", 
          RowBox[{"Grid", "[", 
           RowBox[{
            RowBox[{"PLOTS", "[", 
             RowBox[{"[", "iexperiment", "]"}], "]"}], ",", 
            RowBox[{"Spacings", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"2", ",", "3"}], "}"}]}]}], "]"}]}]}], 
        RowBox[{"(*", "else", "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"grid", "=", 
          RowBox[{"Grid", "[", 
           RowBox[{"(*", "else", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"PLOTS", "[", 
                 RowBox[{"[", 
                  RowBox[{"iexperiment", ",", "1"}], "]"}], "]"}], ",", " ", 
                RowBox[{"PLOTS", "[", 
                 RowBox[{"[", 
                  RowBox[{"iexperiment", ",", "2"}], "]"}], "]"}], ",", 
                RowBox[{"PLOTS", "[", 
                 RowBox[{"[", 
                  RowBox[{"iexperiment", ",", "3"}], "]"}], "]"}]}], "}"}], 
              ",", " ", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"PLOTS", "[", 
                 RowBox[{"[", 
                  RowBox[{"iexperiment", ",", "4"}], "]"}], "]"}], ",", 
                RowBox[{"PLOTS", "[", 
                 RowBox[{"[", 
                  RowBox[{"iexperiment", ",", "5"}], "]"}], "]"}], ",", 
                RowBox[{"PLOTS", "[", 
                 RowBox[{"[", 
                  RowBox[{"iexperiment", ",", "6"}], "]"}], "]"}]}], "}"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"Nothing", ",", 
                RowBox[{"PLOTS", "[", 
                 RowBox[{"[", 
                  RowBox[{"iexperiment", ",", "7"}], "]"}], "]"}], ",", 
                "Nothing"}], "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Spacings", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"2", ",", "3"}], "}"}]}]}], "\[IndentingNewLine]", 
           "]"}]}], "*)"}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "grid"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ShowPlots", "[", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"length", "=", 
         RowBox[{"PLOTS", "//", "Length"}]}], ",", "grid"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"length", ">", "0"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{"grid", "=", 
          RowBox[{"ShowPlots", "[", "length", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<No plots to show.\>\"", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"grid", "=", "0"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "grid"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 AutoGeneratedPackage->Automatic,
 InitializationCell->True,
 CellChangeTimes->{{3.867839556779538*^9, 3.86783971669942*^9}, {
   3.867839817893618*^9, 3.867839844338642*^9}, {3.8678399883343353`*^9, 
   3.867839994183217*^9}, {3.867840034598239*^9, 3.867840223594935*^9}, {
   3.8678402547230873`*^9, 3.867840362948492*^9}, {3.867840399638172*^9, 
   3.867840433574916*^9}, {3.86784050758362*^9, 3.867840524696947*^9}, {
   3.8678405557863293`*^9, 3.8678405569441023`*^9}, 3.8678405962472982`*^9, {
   3.8678406395633507`*^9, 3.867840680530445*^9}, {3.867840778482031*^9, 
   3.867840782156289*^9}, {3.867840985077559*^9, 3.867840986584888*^9}, {
   3.867841086953157*^9, 3.8678411291715813`*^9}, {3.867841210815301*^9, 
   3.867841257196693*^9}, {3.867841288757958*^9, 3.8678413135762367`*^9}, {
   3.86784135102556*^9, 3.867841414093575*^9}, {3.867841445900641*^9, 
   3.867841507714361*^9}, {3.867841546675437*^9, 3.8678415512703123`*^9}, 
   3.8678417876094227`*^9, 3.867841826084988*^9, 3.867841992365144*^9, {
   3.867842326134549*^9, 3.8678424081666813`*^9}, {3.8678424820440397`*^9, 
   3.8678425111858883`*^9}, {3.8678425573314877`*^9, 3.867842561434742*^9}, {
   3.867842600477272*^9, 3.8678426037866783`*^9}, {3.867842908948868*^9, 
   3.8678430012208223`*^9}, {3.867843120569776*^9, 3.867843121338312*^9}, {
   3.867843242491817*^9, 3.867843242748021*^9}, {3.867843302067933*^9, 
   3.867843459899021*^9}, {3.8678435137771387`*^9, 3.8678435361110573`*^9}, {
   3.8678436251002283`*^9, 3.867843626475198*^9}, {3.867843660710587*^9, 
   3.8678436744453163`*^9}, {3.867843886779848*^9, 3.867843937111661*^9}, {
   3.867843981069556*^9, 3.8678441624720583`*^9}, {3.8678442031803427`*^9, 
   3.8678443174710283`*^9}, {3.867844403432073*^9, 3.8678445873305883`*^9}, {
   3.867844952431409*^9, 3.8678450335012197`*^9}, {3.86784516677407*^9, 
   3.867845169990252*^9}, 3.867845310221945*^9, {3.867947072315124*^9, 
   3.867947103078915*^9}, {3.867947155674634*^9, 3.867947230091071*^9}, {
   3.867947266733069*^9, 3.867947468767706*^9}, {3.8679477385590487`*^9, 
   3.867947760055182*^9}, {3.867948487324896*^9, 3.86794849850454*^9}, {
   3.867948595560459*^9, 3.867948603837001*^9}, {3.8679486536342793`*^9, 
   3.8679487383003263`*^9}, 3.867948812991971*^9, {3.867948993240115*^9, 
   3.867949005483585*^9}, {3.8679490756632957`*^9, 3.8679491190736713`*^9}, {
   3.8679491721343517`*^9, 3.867949183416431*^9}, {3.8679492599345512`*^9, 
   3.86794930285607*^9}, {3.867949337874402*^9, 3.8679493557880898`*^9}, 
   3.8679493862825623`*^9, {3.8679494204413977`*^9, 3.867949440768952*^9}, {
   3.8679495051984673`*^9, 3.8679495176141977`*^9}, {3.867949568431567*^9, 
   3.867949682443696*^9}, {3.8679498497117367`*^9, 3.8679498508272*^9}, {
   3.867950031920157*^9, 3.8679501419257*^9}, {3.8679501751605883`*^9, 
   3.867950248352376*^9}, {3.867950279184771*^9, 3.8679503589949093`*^9}, {
   3.8679503966221867`*^9, 3.867950604205991*^9}, {3.8679509105831423`*^9, 
   3.867950910869914*^9}, {3.867951233341481*^9, 3.867951348045537*^9}, 
   3.8679516400126038`*^9, {3.867952130752075*^9, 3.867952312433839*^9}, {
   3.867952730534876*^9, 3.8679527307093782`*^9}, {3.8679528175021563`*^9, 
   3.867952838419829*^9}, {3.86795287552771*^9, 3.867952875752101*^9}, {
   3.8679529159284678`*^9, 3.86795304812388*^9}, {3.867953081326301*^9, 
   3.867953120626614*^9}, {3.867953190782568*^9, 3.86795319135686*^9}, {
   3.86795324634964*^9, 3.867953246996345*^9}, {3.867953345561599*^9, 
   3.867953440098195*^9}, {3.867953478583403*^9, 3.8679534942523108`*^9}, {
   3.867953562436316*^9, 3.867953570199769*^9}, {3.867960046896214*^9, 
   3.86796004703658*^9}, {3.867960290207657*^9, 3.867960290424945*^9}, 
   3.867960807752524*^9, 3.867961627283046*^9, 3.867961873607213*^9, 
   3.867961945663623*^9, 3.867962752496793*^9, 3.867963267650394*^9, {
   3.867987226727892*^9, 3.867987239341164*^9}, {3.867987314072206*^9, 
   3.8679873291130953`*^9}, {3.867987398898814*^9, 3.867987432980686*^9}, {
   3.867987465288266*^9, 3.867987560420146*^9}, {3.867987600458206*^9, 
   3.867987602542053*^9}, {3.867987646213932*^9, 3.867987651080409*^9}, {
   3.867987761536182*^9, 3.867987782780158*^9}, {3.867990050194366*^9, 
   3.8679900977526617`*^9}, {3.867990136698234*^9, 3.867990167736931*^9}, {
   3.867990201159289*^9, 3.867990220809126*^9}, {3.8679904400193367`*^9, 
   3.8679904586495237`*^9}, {3.8679968073947697`*^9, 3.867996815166724*^9}, {
   3.868006167357058*^9, 3.868006252576714*^9}, {3.868006383839273*^9, 
   3.868006386370035*^9}, {3.868006483855555*^9, 3.868006517841785*^9}, {
   3.868010214558299*^9, 3.868010221470664*^9}, {3.8680120951423903`*^9, 
   3.868012095457453*^9}, {3.868013292450026*^9, 3.868013302444119*^9}, {
   3.868077148866173*^9, 3.868077201476819*^9}, {3.868177042247003*^9, 
   3.8681770937268133`*^9}, {3.868177161044841*^9, 3.86817731909826*^9}, {
   3.868177363150455*^9, 3.868177372372237*^9}, {3.86817743137528*^9, 
   3.868177448705737*^9}, {3.868177697673209*^9, 3.8681778258647614`*^9}, {
   3.868178153549965*^9, 3.8681781537934637`*^9}, {3.868178440430188*^9, 
   3.868178479939273*^9}, {3.868178525913862*^9, 3.868178541075962*^9}, {
   3.8681786104867773`*^9, 3.868178611132959*^9}, {3.868178661127083*^9, 
   3.868178696907682*^9}, {3.868178776700363*^9, 3.868178778464739*^9}, {
   3.8681788141557217`*^9, 3.868178929448605*^9}, {3.868179021274122*^9, 
   3.868179090737752*^9}, 3.8681795930782337`*^9, 3.868179642235042*^9, {
   3.868180210771839*^9, 3.868180211229206*^9}, {3.868180259014296*^9, 
   3.868180273821391*^9}, {3.8681804508843403`*^9, 3.86818051044244*^9}, {
   3.8681805534487553`*^9, 3.868180585744131*^9}, 3.868180633582514*^9, {
   3.868180733833581*^9, 3.8681807856888638`*^9}, {3.868180858099498*^9, 
   3.868180887828772*^9}, {3.868180946152787*^9, 3.8681809471159554`*^9}, {
   3.868180984551711*^9, 3.868180992465754*^9}, 3.86818102685882*^9, {
   3.8681811107451143`*^9, 3.868181139786384*^9}, {3.8681812431994*^9, 
   3.868181247144384*^9}, {3.868181279547284*^9, 3.8681812862215767`*^9}, {
   3.868181431268688*^9, 3.868181489480438*^9}, {3.868181579095106*^9, 
   3.868181600001113*^9}, {3.868181913144827*^9, 3.8681819316487513`*^9}, {
   3.8681820724474916`*^9, 3.868182082871159*^9}, {3.868182166030642*^9, 
   3.8681822200889072`*^9}, {3.8681822542034607`*^9, 3.868182352837035*^9}, {
   3.8681824479627132`*^9, 3.8681825487033873`*^9}, {3.8681825839191637`*^9, 
   3.868182689658163*^9}, {3.868182926112784*^9, 3.868182946806343*^9}, {
   3.868183121493683*^9, 3.8681832348988132`*^9}, {3.868183300038451*^9, 
   3.868183301826619*^9}, {3.86818345792122*^9, 3.868183554815579*^9}, {
   3.868183759390683*^9, 3.868183782374711*^9}, {3.868183860689087*^9, 
   3.868183960697641*^9}, {3.868183993506629*^9, 3.8681840445668583`*^9}, {
   3.868184119512968*^9, 3.8681841197260523`*^9}, {3.868184778803073*^9, 
   3.868184864790771*^9}},ExpressionUUID->"66ee4e56-fd6a-454e-a12d-\
58ec728c9386"]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1184, 610},
WindowMargins->{{4, Automatic}, {Automatic, 4}},
FrontEndVersion->"12.2 for Mac OS X x86 (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"5f28cd29-0163-4a6f-821f-5a6d0b614ba0"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 413, 7, 73, "Abstract",ExpressionUUID->"3b4e6912-6fe9-4805-a105-5e1f66cac2fd",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[996, 31, 417, 8, 32, "Item",ExpressionUUID->"1c566f67-e7aa-4c2a-ac33-0a2107a5a2be",
 InitializationCell->True],
Cell[1416, 41, 302, 7, 46, "Input",ExpressionUUID->"d80d07b2-13de-4403-9adf-3f80e0395319",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[1755, 53, 383, 7, 32, "Item",ExpressionUUID->"ba71628e-5d30-4e95-bc9f-573c7cacb52d",
 InitializationCell->True],
Cell[2141, 62, 551, 12, 68, "Input",ExpressionUUID->"c6cd6752-3b2c-4794-9638-fa1e3281c9d5",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[2729, 79, 568, 12, 74, "Item",ExpressionUUID->"415749f6-b8be-4112-9cb7-98724a1e1aa2",
 InitializationCell->True],
Cell[3300, 93, 714, 18, 194, "Input",ExpressionUUID->"ddbdb09c-d910-4b87-bca0-e920b54dfeb7",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[4051, 116, 428, 8, 32, "Item",ExpressionUUID->"736ea7f7-9f66-43ce-823a-8955e6affb6d",
 InitializationCell->True],
Cell[4482, 126, 5713, 124, 719, "Input",ExpressionUUID->"7c537e84-6dd6-481b-9d60-8a46ce829e97",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[10232, 255, 488, 8, 32, "Item",ExpressionUUID->"1454894f-1127-4a7b-a6a8-ab9bca049252",
 InitializationCell->True],
Cell[10723, 265, 11041, 228, 954, "Input",ExpressionUUID->"d4825404-4ccd-4c99-83e5-cde7dfc5207d",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[21801, 498, 544, 9, 32, "Item",ExpressionUUID->"b3046d9d-17c8-4a40-b5dc-2e2c469225e9",
 InitializationCell->True],
Cell[22348, 509, 7075, 124, 887, "Input",ExpressionUUID->"34e622fe-db86-4dab-b4bd-2eff197d486a",
 InitializationCell->True],
Cell[29426, 635, 154, 3, 30, "Input",ExpressionUUID->"553c7cd7-c376-4839-ab5f-a0a87159f3cf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29617, 643, 577, 10, 32, "Item",ExpressionUUID->"e7fa18bb-26fb-42e3-aad7-0a8294813414",
 InitializationCell->True],
Cell[30197, 655, 10288, 208, 1286, "Input",ExpressionUUID->"c3e748d7-81c0-4746-beec-0ca6ef7db3ce",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[40522, 868, 844, 15, 32, "Item",ExpressionUUID->"44957540-6c80-403d-a201-e7d6d0e250ea",
 InitializationCell->True],
Cell[41369, 885, 8561, 184, 1370, "Input",ExpressionUUID->"f5345bad-bae2-4e01-be18-d0ebe0111c25",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[49967, 1074, 672, 11, 32, "Item",ExpressionUUID->"b769cc7d-2f3f-4b68-8522-e238fd34e29a",
 InitializationCell->True],
Cell[50642, 1087, 13775, 333, 1426, "Input",ExpressionUUID->"28f2bd49-8456-4bd7-80b7-11e17f18fb4b",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[64454, 1425, 616, 10, 32, "Item",ExpressionUUID->"ef02d43d-59f1-47e7-b220-4a3cbb4ccebd",
 InitializationCell->True],
Cell[65073, 1437, 21236, 423, 2714, "Input",ExpressionUUID->"66ee4e56-fd6a-454e-a12d-58ec728c9386",
 InitializationCell->True]
}, Open  ]]
}
]
*)

